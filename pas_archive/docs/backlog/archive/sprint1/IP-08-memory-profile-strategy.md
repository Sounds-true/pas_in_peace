# IP-08: Memory Architecture, User Profile & Strategy Engine

## –°–º—ã—Å–ª –∏ —Ü–µ–ª—å –∑–∞–¥–∞—á–∏

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –ø–∞–º—è—Ç–∏, –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–≥–æ –¥–≤–∏–∂–∫–∞ –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–µ—Ä–∞–ø–µ–≤—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—É—Ç–∏ –æ—Ç—á—É–∂–¥–∞–µ–º–æ–≥–æ —Ä–æ–¥–∏—Ç–µ–ª—è. –¶–µ–ª—å - —Å–æ–∑–¥–∞—Ç—å multi-layered memory architecture (profile store, episodic memory, semantic memory), strategy engine –¥–ª—è adaptive interventions (JITAI-based), goal tracking system –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é letter writing –≤ emotional state graph. –†–µ–∑—É–ª—å—Ç–∞—Ç - —á–∞—Ç-–±–æ—Ç —Å –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç—å—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ, –µ–≥–æ —Ä–µ–±–µ–Ω–∫–µ, —Ü–µ–ª—è—Ö —Ç–µ—Ä–∞–ø–∏–∏, –∏—Å—Ç–æ—Ä–∏–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π; —Å–∏—Å—Ç–µ–º–∞ —Å–ø–æ—Å–æ–±–Ω–∞—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ –≤—ã–±–∏—Ä–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ (–ø–∏—Å—å–º–æ vs –¥–µ–π—Å—Ç–≤–∏–µ vs –æ–∂–∏–¥–∞–Ω–∏–µ) –Ω–∞ –æ—Å–Ω–æ–≤–µ readiness assessment, –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–µ–Ω—Ü–∏–∏ —É—á–∏—Ç—ã–≤–∞—é—â–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤—Å–µ–π –∏—Å—Ç–æ—Ä–∏–∏ –æ—Ç–Ω–æ—à–µ–Ω–∏–π —Ä–æ–¥–∏—Ç–µ–ª—è —Å —Ä–µ–±–µ–Ω–∫–æ–º.

## –û–±—ä–µ–º —Ä–∞–±–æ—Ç

### –ß—Ç–æ –≤—Ö–æ–¥–∏—Ç –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é

- **User Profile Store**: —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ, —Ä–µ–±–µ–Ω–∫–µ, —Å–µ–º—å–µ
- **Episodic Memory**: —Ö—Ä–æ–Ω–∏–∫–∞ —Å–æ–±—ã—Ç–∏–π, conversations, milestones —Å temporal ordering
- **Semantic Memory**: –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã, insights, learnings –∏–∑ episodic memory
- **Memory Integration —Å KAG**: —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ memory nodes –≤ knowledge graph
- **Strategy Engine**: rule-based + ML –º–µ—Ö–∞–Ω–∏–∑–º –≤—ã–±–æ—Ä–∞ —Ç–µ—Ä–∞–ø–µ–≤—Ç–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
- **User Readiness Assessment**: –æ—Ü–µ–Ω–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Ä–æ–¥–∏—Ç–µ–ª—è –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –¥–µ–π—Å—Ç–≤–∏—è–º
- **Goal Tracking System**: user-defined goals —Å weekly progress monitoring
- **Letter Writing Integration –≤ Graph**: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ WRITE_LETTER_* states –≤ graph.yaml
- **JITAI (Just-In-Time Adaptive Interventions)**: –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–µ–Ω—Ü–∏–∏ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –º–æ–º–µ–Ω—Ç
- **Trauma-Aware Dialogue Policies**: —É—á–µ—Ç —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ –≤ graph transitions
- **Progress Metrics Dashboard**: –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **Memory Consolidation**: periodic background process –¥–ª—è semantic extraction

### –ß—Ç–æ –Ω–µ –≤—Ö–æ–¥–∏—Ç

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ goals (—Ç–æ–ª—å–∫–æ user-defined —á–µ—Ä–µ–∑ –¥–∏–∞–ª–æ–≥)
- Predictive analytics –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å—Ö–æ–¥–æ–≤ (–æ—Å—Ç–∞–≤–ª—è–µ–º –¥–ª—è –±—É–¥—É—â–µ–≥–æ)
- Integration —Å –≤–Ω–µ—à–Ω–∏–º–∏ CRM —Å–∏—Å—Ç–µ–º–∞–º–∏
- –ë–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ (voice/face recognition –¥–ª—è —ç–º–æ—Ü–∏–π)
- Social network graph —Ä–µ–±–µ–Ω–∫–∞ (—Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω–æ –¥–ª—è MVP)
- Automated goal achievement detection (—Ç—Ä–µ–±—É–µ—Ç human validation)

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

```
src/
‚îú‚îÄ‚îÄ memory/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ profile_store.py              # User/Child/Family profiles
‚îÇ   ‚îú‚îÄ‚îÄ episodic_memory.py            # Chronological event log
‚îÇ   ‚îú‚îÄ‚îÄ semantic_memory.py            # Extracted patterns/insights
‚îÇ   ‚îú‚îÄ‚îÄ memory_consolidation.py       # Background semantic extraction
‚îÇ   ‚îú‚îÄ‚îÄ memory_retrieval.py           # Context-aware memory queries
‚îÇ   ‚îî‚îÄ‚îÄ models/
‚îÇ       ‚îú‚îÄ‚îÄ user_profile.py           # Pydantic models
‚îÇ       ‚îú‚îÄ‚îÄ episode.py                # Event/conversation models
‚îÇ       ‚îî‚îÄ‚îÄ semantic_unit.py          # Insight/pattern models
‚îú‚îÄ‚îÄ strategy/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ strategy_engine.py            # Main strategy selector
‚îÇ   ‚îú‚îÄ‚îÄ readiness_assessor.py         # User readiness evaluation
‚îÇ   ‚îú‚îÄ‚îÄ jitai_engine.py               # Just-In-Time interventions
‚îÇ   ‚îú‚îÄ‚îÄ strategy_policies/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ letter_writing_policy.py  # –ö–æ–≥–¥–∞ –ø—Ä–µ–¥–ª–∞–≥–∞—Ç—å –ø–∏—Å—å–º–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ action_policy.py          # –ö–æ–≥–¥–∞ push –∫ –¥–µ–π—Å—Ç–≤–∏—è–º
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ waiting_policy.py         # –ö–æ–≥–¥–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å –æ–∂–∏–¥–∞–Ω–∏–µ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ escalation_policy.py      # –ö–æ–≥–¥–∞ —ç—Å–∫–∞–ª–∏—Ä–æ–≤–∞—Ç—å (—é—Ä–∏—Å—Ç, —à–∫–æ–ª–∞)
‚îÇ   ‚îî‚îÄ‚îÄ triz_resolver.py              # TRIZ-based contradiction resolution
‚îú‚îÄ‚îÄ goals/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ goal_tracker.py               # Goal CRUD + tracking
‚îÇ   ‚îú‚îÄ‚îÄ progress_monitor.py           # Weekly progress checks
‚îÇ   ‚îú‚îÄ‚îÄ milestone_detector.py         # Auto-detect milestones
‚îÇ   ‚îî‚îÄ‚îÄ goal_templates.yaml           # Pre-defined goal templates
‚îú‚îÄ‚îÄ graph_extensions/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ letter_states.py              # WRITE_LETTER_* state definitions
‚îÇ   ‚îú‚îÄ‚îÄ graph_yaml_generator.py       # Dynamic graph.yaml extension
‚îÇ   ‚îî‚îÄ‚îÄ trauma_aware_transitions.py   # Trauma-aware transition logic
‚îú‚îÄ‚îÄ integration/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ kag_memory_connector.py       # KAG <-> Memory integration
‚îÇ   ‚îú‚îÄ‚îÄ besser_memory_bridge.py       # BESSER session <-> Profile
‚îÇ   ‚îî‚îÄ‚îÄ state_machine_memory_sync.py  # Sync state —Å memory updates
‚îî‚îÄ‚îÄ config/
    ‚îú‚îÄ‚îÄ memory_config.yaml            # Memory retention policies
    ‚îú‚îÄ‚îÄ strategy_config.yaml          # Strategy selection rules
    ‚îî‚îÄ‚îÄ goal_templates.yaml           # Goal library
```

### –î–∏–∞–≥—Ä–∞–º–º–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

```mermaid
flowchart TB
    subgraph User_Interaction[User Interaction Layer]
        BESSERAgent[BESSER Agent<br/>State Machine]
        GraphYAML[graph.yaml<br/>Emotional States + Letter States]
    end

    subgraph Memory_Layer[Memory Architecture]
        ProfileStore[Profile Store<br/>User/Child/Family]
        EpisodicMemory[Episodic Memory<br/>Events Timeline]
        SemanticMemory[Semantic Memory<br/>Patterns/Insights]
        MemoryConsolidation[Memory Consolidation<br/>Background Process]
    end

    subgraph Strategy_Layer[Strategy Engine]
        ReadinessAssessor[Readiness Assessor<br/>User Ready?]
        StrategyEngine[Strategy Engine<br/>Select Intervention]
        JITAIEngine[JITAI Engine<br/>Timing Optimization]
        TRIZResolver[TRIZ Resolver<br/>Contradiction Resolution]
    end

    subgraph Goal_Layer[Goal Tracking]
        GoalTracker[Goal Tracker<br/>User Goals CRUD]
        ProgressMonitor[Progress Monitor<br/>Weekly Checks]
        MilestoneDetector[Milestone Detector<br/>Auto-detect]
    end

    subgraph Knowledge_Layer[Knowledge Integration]
        KAG[KAG Graph DB<br/>from IP-01]
        VectorStore[Vector Store<br/>Embeddings]
    end

    BESSERAgent -->|Current State| StrategyEngine
    BESSERAgent -->|Session Data| ProfileStore
    BESSERAgent -->|Conversation| EpisodicMemory

    ProfileStore --> KAG
    EpisodicMemory --> KAG
    SemanticMemory --> KAG

    EpisodicMemory -->|Raw Events| MemoryConsolidation
    MemoryConsolidation -->|Extracted Insights| SemanticMemory

    StrategyEngine --> ReadinessAssessor
    StrategyEngine --> JITAIEngine
    StrategyEngine --> TRIZResolver
    ReadinessAssessor -->|Query Context| ProfileStore
    ReadinessAssessor -->|Query History| EpisodicMemory

    StrategyEngine -->|Recommend Next State| GraphYAML
    GraphYAML -->|Transition| BESSERAgent

    GoalTracker --> ProfileStore
    ProgressMonitor -->|Check Goals| GoalTracker
    ProgressMonitor -->|Query Events| EpisodicMemory
    MilestoneDetector -->|Detect| EpisodicMemory

    KAG -->|Semantic Search| StrategyEngine
```

## –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç–µ–∫–∞

- **–Ø–∑—ã–∫**: Python 3.12
- **–§—Ä–µ–π–º–≤–æ—Ä–∫**: FastAPI, BESSER Agentic Framework
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**:
  - PostgreSQL –¥–ª—è Profile Store (structured data)
  - TimescaleDB –¥–ª—è Episodic Memory (time-series events)
  - Redis –¥–ª—è session cache
- **Knowledge Graph**: KAG (OpenSPG) –∏–∑ IP-01
- **Vector Store**: ChromaDB/Qdrant –¥–ª—è semantic memory embeddings
- **Background Tasks**: Celery –¥–ª—è memory consolidation
- **State Machine**: BESSER + LangGraph –¥–ª—è graph.yaml extension
- **ML Models**: sentence-transformers –¥–ª—è semantic similarity, sklearn –¥–ª—è readiness scoring
- **–¶–µ–ª–µ–≤–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞**: Docker/Kubernetes, integration —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –º–æ–¥—É–ª—è–º–∏

## –ü–æ–ª–Ω—ã–π flow —Ä–∞–±–æ—Ç—ã —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

### 1. –û–Ω–±–æ—Ä–¥–∏–Ω–≥: –°–æ–∑–¥–∞–Ω–∏–µ User Profile

**Initial profile setup:**

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—É—Å–∫–∞–µ—Ç /start (–ø–æ—Å–ª–µ consent –≤ IP-07)
2. –ë–û–¢ –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç profile setup workflow:
   "–î–∞–≤–∞–π—Ç–µ –ø–æ–∑–Ω–∞–∫–æ–º–∏–º—Å—è. –†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ –≤–∞—à–µ–π —Å–∏—Ç—É–∞—Ü–∏–∏."
3. –ë–û–¢ –∑–∞–¥–∞–µ—Ç guided questions:
   - "–ö–∞–∫ –∑–æ–≤—É—Ç –≤–∞—à–µ–≥–æ —Ä–µ–±–µ–Ω–∫–∞?" -> [CHILD_NAME] (—Ç–æ–∫–µ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è –ø–æ IP-07)
   - "–°–∫–æ–ª—å–∫–æ –ª–µ—Ç —Ä–µ–±–µ–Ω–∫—É?" -> child_age
   - "–ö–æ–≥–¥–∞ –≤—ã –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑ –≤–∏–¥–µ–ª–∏—Å—å?" -> last_contact_date
   - "–ö–∞–∫–æ–π —Ç–∏–ø –æ—Ç–Ω–æ—à–µ–Ω–∏–π —Å–µ–π—á–∞—Å —Å –¥—Ä—É–≥–∏–º —Ä–æ–¥–∏—Ç–µ–ª–µ–º?"
     -> co_parenting_type (parallel, cooperative, high_conflict)
   - "–ß—Ç–æ –¥–ª—è –≤–∞—Å —Å–µ–π—á–∞—Å —Å–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ?" -> primary_concern
4. ProfileStore.create_profile(user_uuid, profile_data):
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å structured profile
   - Create entry –≤ KAG (User node)
   - Link User -> Child -> ExPartner nodes
5. –ë–û–¢ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç set initial goal:
   "–ö–∞–∫—É—é —Ü–µ–ª—å –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–æ—Å—Ç–∞–≤–∏—Ç—å –Ω–∞ –±–ª–∏–∂–∞–π—à–∏–π –º–µ—Å—è—Ü?"
   –ü—Ä–∏–º–µ—Ä—ã:
   - "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ö–æ—Ç—è –±—ã SMS-–∫–æ–Ω—Ç–∞–∫—Ç"
   - "–ù–∞–ø–∏—Å–∞—Ç—å –ø–∏—Å—å–º–æ —Ä–µ–±–µ–Ω–∫—É –∫ –¥–Ω—é —Ä–æ–∂–¥–µ–Ω–∏—è"
   - "–ù–µ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ –Ω–∞ –ø—Ä–æ–≤–æ–∫–∞—Ü–∏–∏"
6. GoalTracker.create_goal(user_uuid, goal_text, deadline)
7. EpisodicMemory.log_event(
     event_type="profile_created",
     details=profile_data
   )
```

**Profile Schema:**

```yaml
UserProfile:
  user_uuid: str
  created_at: datetime
  child_info:
    token: "[CHILD_NAME]"  # real name encrypted client-side
    age: int
    gender: str (optional)
    interests: List[str] (from conversations)
  family_context:
    ex_partner_token: "[EX_PARTNER_NAME]"
    co_parenting_type: str (parallel, cooperative, high_conflict, none)
    custody_arrangement: str (full_ex, shared, legal_only, none)
    last_contact_date: datetime
    contact_frequency: str (daily, weekly, monthly, none)
  user_context:
    primary_concern: str
    emotional_baseline: str (from IP-03 initial assessment)
    parenting_style: str (authoritative, permissive, uninvolved, uncertain)
    support_network: bool (has friends/family support?)
    therapy_history: bool (previous therapy?)
  trauma_markers:
    triggers: List[str] (detected over time)
    trauma_responses: List[str] (fight, flight, freeze patterns)
  preferences:
    communication_style: str (direct, gentle, structured)
    session_frequency: str (daily, few_times_week, weekly)
```

### 2. Episodic Memory: Conversation Logging

**Every interaction logged:**

```
[DURING CONVERSATION]
1. User sends message
2. BESSER Agent processes —á–µ—Ä–µ–∑ state machine
3. EpisodicMemory.log_conversation_turn(
     user_uuid,
     timestamp,
     emotional_state,  # from IP-03
     user_message_tokenized,
     bot_response,
     techniques_applied,  # from IP-04
     state_transition  # RAGE -> NVC_TRAINING
   )
4. IF significant event detected:
   - Milestone (first letter written, goal achieved)
   - Crisis (safety incident from IP-05)
   - Breakthrough (user insight)
   THEN EpisodicMemory.log_significant_event(
     event_type,
     emotional_valence,
     impact_score,
     related_goal_id
   )
5. Update ProfileStore —Å –Ω–æ–≤—ã–º–∏ learnings:
   - –ï—Å–ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω –Ω–æ–≤—ã–π trigger -> add to trauma_markers.triggers
   - –ï—Å–ª–∏ user –≤—ã—Ä–∞–∑–∏–ª new interest —Ä–µ–±–µ–Ω–∫–∞ -> add to child_info.interests
```

**Episode Schema:**

```yaml
Episode:
  episode_id: UUID
  user_uuid: str
  timestamp: datetime
  episode_type: str (conversation, event, milestone, crisis)
  emotional_state_before: str
  emotional_state_after: str
  content:
    user_message: str (tokenized)
    bot_response: str
    techniques_applied: List[str]
  metadata:
    state_transition: str (GRIEF -> WRITE_LETTER_GRIEF)
    goal_progress: dict (if related to goal)
    safety_flags: List[str] (if any)
  embeddings:
    message_embedding: Vector
    semantic_summary: str
```

### 3. Semantic Memory: Pattern Extraction

**Background consolidation process:**

```
[NIGHTLY BATCH JOB]
1. MemoryConsolidation.run_daily_consolidation(cutoff_date=yesterday):
   a. Query EpisodicMemory for last 24h episodes
   b. Group episodes –ø–æ temporal clusters
   c. Extract patterns:
      - Recurring emotional states (user —á–∞—Å—Ç–æ –≤ RAGE –ø–æ –≤–µ—á–µ—Ä–∞–º)
      - Trigger patterns (mentions "—à–∫–æ–ª–∞" -> spike –≤ anxiety)
      - Effective techniques (CBT works, NVC doesn't resonate)
      - Goal-related patterns (progress on "–ø–∏—Å—å–º–∞" —Å—Ç–∞–≥–Ω–∏—Ä—É–µ—Ç)
   d. LLM-based semantic summarization:
      prompt = """
      Episodic events –∑–∞ 24h:
      {episodes_summary}

      Extract insights:
      1. –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –≤ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏?
      2. –ö–∞–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è?
      3. –ß—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç/–Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç?
      4. –ü—Ä–æ–≥—Ä–µ—Å—Å –∫ —Ü–µ–ª—è–º?
      """
   e. Create SemanticMemory entries
2. SemanticMemory.store_insights(user_uuid, insights)
3. Update ProfileStore.preferences –Ω–∞ –æ—Å–Ω–æ–≤–µ patterns
4. IF critical pattern detected (stuck, regression):
   - Flag –¥–ª—è ClinicalOversight (IP-06)
```

**Semantic Memory Schema:**

```yaml
SemanticUnit:
  semantic_id: UUID
  user_uuid: str
  created_at: datetime
  time_window: str (daily, weekly, monthly)
  insight_type: str (pattern, learning, progress, concern)
  content:
    summary: str (human-readable insight)
    supporting_episodes: List[episode_id]
    confidence_score: float (0-1)
  actionable_recommendations:
    strategy_adjustments: List[str]
    goal_modifications: List[str]
  embeddings:
    insight_embedding: Vector
```

### 4. Strategy Engine: Intervention Selection

**Real-time strategy selection:**

```
[DURING STATE MACHINE EXECUTION]
1. BESSER Agent –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ GRIEF (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–∫–æ—Ä–±–∏—Ç –æ–± —É—Ç—Ä–∞—á–µ–Ω–Ω–æ–º –∫–æ–Ω—Ç–∞–∫—Ç–µ)
2. StrategyEngine.select_next_intervention(
     current_state="GRIEF",
     user_uuid=user_uuid
   ):
   a. Retrieve context:
      - profile = ProfileStore.get_profile(user_uuid)
      - recent_episodes = EpisodicMemory.get_recent(user_uuid, last_7_days)
      - semantic_insights = SemanticMemory.get_insights(user_uuid, last_30_days)
      - current_goals = GoalTracker.get_active_goals(user_uuid)

   b. Assess user readiness:
      readiness = ReadinessAssessor.assess(
        current_state="GRIEF",
        profile=profile,
        recent_history=recent_episodes
      )
      # Returns: {
      #   letter_writing_ready: 0.8 (high),
      #   action_taking_ready: 0.3 (low),
      #   waiting_acceptance_ready: 0.6 (medium)
      # }

   c. Apply strategy policies:
      IF readiness.letter_writing_ready > 0.7 AND profile.last_contact_date > 90_days_ago:
        recommended_strategy = "WRITE_LETTER_GRIEF"
      ELIF readiness.action_taking_ready > 0.7 AND profile.co_parenting_type != "high_conflict":
        recommended_strategy = "REACH_OUT_ACTION"
      ELSE:
        recommended_strategy = "GRIEF_PROCESSING" (stay in healing)

   d. TRIZ contradiction resolution:
      IF user expresses "—è —Ö–æ—á—É –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å" BUT readiness.action_ready < 0.5:
        # –ü—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ: –∂–µ–ª–∞–Ω–∏–µ vs –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å
        TRIZ_Principle_1_Separation_in_Time:
          - "–î–∞–≤–∞–π—Ç–µ —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ—Ä–∞–±–æ—Ç–∞–µ–º —ç–º–æ—Ü–∏–∏ (—Å–µ–≥–æ–¥–Ω—è)"
          - "–ó–∞–≤—Ç—Ä–∞ –≤–µ—Ä–Ω–µ–º—Å—è –∫ –ø–ª–∞–Ω—É –¥–µ–π—Å—Ç–≤–∏–π"
        TRIZ_Principle_13_Feedback:
          - "–ö–æ–≥–¥–∞ –≤—ã —á—É–≤—Å—Ç–≤—É–µ—Ç–µ —Å–µ–±—è –≥–æ—Ç–æ–≤—ã–º –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å, –¥–∞–π—Ç–µ –º–Ω–µ –∑–Ω–∞—Ç—å"

   e. JITAI timing optimization:
      IF time_of_day == "evening" AND semantic_insights.shows("evenings trigger sadness"):
        # –ù–µ –ø—Ä–µ–¥–ª–∞–≥–∞—Ç—å action-oriented —Å–µ–π—á–∞—Å
        defer_intervention_to_morning = True
3. Return recommended_next_state to BESSER Agent
4. Graph transition: GRIEF -> WRITE_LETTER_GRIEF
```

**Readiness Assessment Algorithm:**

```python
class ReadinessAssessor:
    def assess(self, current_state, profile, recent_history):
        # Factors –¥–ª—è letter_writing_ready:
        factors = {
            "emotional_stability": self._assess_stability(recent_history),
            "days_since_last_contact": self._calculate_days(profile.last_contact_date),
            "previous_letter_success": self._check_history(recent_history, "letter"),
            "current_emotional_intensity": self._get_intensity(current_state),
            "goal_alignment": self._check_goals(profile, "letter")
        }

        # Weighted scoring:
        letter_ready_score = (
            factors["emotional_stability"] * 0.3 +
            min(factors["days_since_last_contact"] / 180, 1.0) * 0.2 +
            factors["previous_letter_success"] * 0.2 +
            (1 - factors["current_emotional_intensity"]) * 0.2 +
            factors["goal_alignment"] * 0.1
        )

        return {
            "letter_writing_ready": letter_ready_score,
            "action_taking_ready": self._assess_action_ready(factors),
            "waiting_acceptance_ready": self._assess_waiting_ready(factors)
        }
```

### 5. Goal Tracking: Progress Monitoring

**User sets goal:**

```
1. User: /my_goals -> "–•–æ—á—É –Ω–∞–ø–∏—Å–∞—Ç—å –ø–∏—Å—å–º–æ —Ä–µ–±–µ–Ω–∫—É –∫ –µ–≥–æ –¥–Ω—é —Ä–æ–∂–¥–µ–Ω–∏—è"
2. –ë–û–¢ guided goal creation:
   "–ö–æ–≥–¥–∞ –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è?" -> deadline_date
   "–ß—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–∫–∞–∑–∞—Ç—å –≤ –ø–∏—Å—å–º–µ?" -> goal_description
   "–ö–∞–∫ –≤—ã –ø–æ–π–º–µ—Ç–µ —á—Ç–æ –¥–æ—Å—Ç–∏–≥–ª–∏ —Ü–µ–ª–∏?" -> success_criteria
3. GoalTracker.create_goal(
     user_uuid,
     goal_type="write_letter",
     description="–ù–∞–ø–∏—Å–∞—Ç—å –ø–∏—Å—å–º–æ –∫ –î–†",
     deadline=deadline_date,
     milestones=[
       "–ù–∞–±—Ä–æ—Å–∞—Ç—å —á–µ—Ä–Ω–æ–≤–∏–∫",
       "–ü—Ä–æ—Ä–∞–±–æ—Ç–∞—Ç—å —Å Content Guardian",
       "–§–∏–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å"
     ]
   )
4. Link goal –≤ ProfileStore
```

**Weekly progress check:**

```
[WEEKLY SCHEDULED TASK]
1. ProgressMonitor.run_weekly_check(user_uuid):
   a. Get active goals
   b. For each goal:
      - Query EpisodicMemory –¥–ª—è goal-related events
      - Calculate progress_percentage
      - Detect blockers (stuck –±–µ–∑ progress 2+ –Ω–µ–¥–µ–ª–∏)
   c. Generate progress summary
2. –ë–û–¢ sends weekly update:
   "üìä –í–∞—à –ø—Ä–æ–≥—Ä–µ—Å—Å –∑–∞ –Ω–µ–¥–µ–ª—é:

   –¶–µ–ª—å: –ù–∞–ø–∏—Å–∞—Ç—å –ø–∏—Å—å–º–æ –∫ –î–† —Ä–µ–±–µ–Ω–∫–∞
   –ü—Ä–æ–≥—Ä–µ—Å—Å: 60% ‚úÖ –ß–µ—Ä–Ω–æ–≤–∏–∫ –≥–æ—Ç–æ–≤
   –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å Content Guardian

   –•–æ—Ç–∏—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ä–∞–±–æ—Ç—É –Ω–∞–¥ —ç—Ç–∏–º?"
3. IF user blocked:
   - StrategyEngine suggests intervention
   - "–í–∏–∂—É –≤—ã –∑–∞—Å—Ç—Ä—è–ª–∏. –ú–æ–∂–µ—Ç –±—ã—Ç—å –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å?"
```

**Goal Schema:**

```yaml
Goal:
  goal_id: UUID
  user_uuid: str
  created_at: datetime
  goal_type: str (write_letter, restore_contact, self_care, legal_action)
  description: str
  deadline: datetime (optional)
  status: str (active, achieved, abandoned, paused)
  milestones:
    - milestone_id: UUID
      description: str
      status: str (pending, completed)
      completed_at: datetime (optional)
  progress_percentage: float (0-100)
  blockers: List[str] (detected issues)
  related_episodes: List[episode_id]
```

### 6. PhaseManager: –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–µ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–ò—Å—Ç–æ—á–Ω–∏–∫**: alienated_parent_support_bot_map.md (—Å—Ç—Ä–æ–∫–∏ 1600-1627)

–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–º–∏ —Ñ–∞–∑–∞–º–∏ —Ç–µ—Ä–∞–ø–µ–≤—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞. PhaseManager –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–µ–∫—É—â—É—é —Ñ–∞–∑—É —Ä–∞–±–æ—Ç—ã —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∏ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç —á–∞—Å—Ç–æ—Ç—É –∫–æ–Ω—Ç–∞–∫—Ç–∞, –≥–ª—É–±–∏–Ω—É –∏–Ω—Ç–µ—Ä–≤–µ–Ω—Ü–∏–π –∏ –æ–∂–∏–¥–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞.

**4 —Ñ–∞–∑—ã —Ä–∞–±–æ—Ç—ã —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º**:

```python
# Phase Model

PHASE_1_CRISIS = {
    "name": "–ö–†–ò–ó–ò–°",
    "duration_weeks": "1-2",
    "characteristics": {
        "emotional_states": ["SHOCK", "RAGE", "DESPAIR", "CRISIS"],
        "contact_frequency": "daily",
        "session_length": "short (10-15 min)",
        "primary_goals": [
            "–°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è",
            "Safety assessment –∏ –∫—Ä–∏–∑–∏—Å–Ω–æ–µ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ",
            "–ë–∞–∑–æ–≤–æ–µ –ø—Å–∏—Ö–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –æ PA",
            "–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π –ø–æ–º–æ—â–∏"
        ],
        "success_markers": [
            "–°–Ω–∏–∂–µ–Ω–∏–µ —Ä–∏—Å–∫–∞ —Å–∞–º–æ—É–±–∏–π—Å—Ç–≤–∞ —Å HIGH -> LOW",
            "User –ø—Ä–∏–Ω—è–ª —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å —Å–∏—Ç—É–∞—Ü–∏–∏ (SHOCK -> ACCEPTANCE –Ω–∞—á–∞–ª–æ)",
            "–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–æ–Ω—Ç–∞–∫—Ç —Å –ø—Å–∏—Ö–æ–ª–æ–≥–æ–º/–≥—Ä—É–ø–ø–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏",
            "–•–æ—Ç—è –±—ã –æ–¥–Ω–æ micro-action –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (–ø–∏—Å—å–º–æ —Ä–µ–±–µ–Ω–∫—É)"
        ],
        "techniques_priority": ["crisis_protocol", "grounding", "safety_planning", "MI_reflection"],
        "guardrails": "HIGH (suicide detection, violence detection)",
        "check_in_schedule": "–µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –≤—Ä–µ–º—è"
    },
    "transition_criteria": {
        "to_PHASE_2": [
            "suicide_risk_level < MEDIUM for 3 consecutive days",
            "user_shows_curiosity (asks questions about PA dynamics)",
            "emotional_state NOT in [CRISIS, DESPAIR] for 48h"
        ]
    }
}

PHASE_2_UNDERSTANDING = {
    "name": "–ü–û–ù–ò–ú–ê–ù–ò–ï",
    "duration_weeks": "2-4",
    "characteristics": {
        "emotional_states": ["GUILT", "BARGAINING", "ACCEPTANCE", "SEEKING_UNDERSTANDING"],
        "contact_frequency": "3-4 times per week",
        "session_length": "medium (20-30 min)",
        "primary_goals": [
            "–ò–∑—É—á–µ–Ω–∏–µ –¥–∏–Ω–∞–º–∏–∫ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –æ—Ç—á—É–∂–¥–µ–Ω–∏—è",
            "–†–∞–±–æ—Ç–∞ —Å –∫–æ–≥–Ω–∏—Ç–∏–≤–Ω—ã–º–∏ –∏—Å–∫–∞–∂–µ–Ω–∏—è–º–∏ (CBT)",
            "–û–±—É—á–µ–Ω–∏–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π —Ä–µ–≥—É–ª—è—Ü–∏–∏",
            "–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–≤—ã—Ö –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π"
        ],
        "success_markers": [
            "User correctly identifies 3+ cognitive distortions",
            "Successful NVC formulation –≤ 2+ —Å–∏—Ç—É–∞—Ü–∏—è—Ö",
            "Homework completion rate > 50%",
            "Created SMART goal with realistic timeline"
        ],
        "techniques_priority": ["psychoeducation", "CBT_restructuring", "NVC_training", "IFS_parts"],
        "homework_frequency": "weekly",
        "psychoeducation_topics": [
            "–ö–æ–Ω—Ñ–ª–∏–∫—Ç –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ —É —Ä–µ–±–µ–Ω–∫–∞ (–¶–ï–ù–¢–†–ê–õ–¨–ù–ê–Ø –ö–û–ù–¶–ï–ü–¶–ò–Ø)",
            "–ü—Å–∏—Ö–æ–ª–æ–≥–∏—è alienator",
            "–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è PA –¥–ª—è —Ä–µ–±–µ–Ω–∫–∞",
            "–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ targeted parent",
            "–ò—Ä—Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –º–æ—Ç–∏–≤—ã –û–ë–û–ò–• —Ä–æ–¥–∏—Ç–µ–ª–µ–π",
            "–ö–æ-–ø–∞—Ä–µ–Ω—Ç–∏–Ω–≥ vs –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ —Ä–æ–¥–∏—Ç–µ–ª—å—Å—Ç–≤–æ",
            "–ú–µ–¥–∏–∞—Ü–∏—è: –∫–æ–≥–¥–∞ –ø–æ–¥—Ö–æ–¥–∏—Ç, –∫–æ–≥–¥–∞ –Ω–µ—Ç",
            "–†–æ–ª—å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π —Å–µ–º—å–∏ (–±–∞–±—É—à–∫–∏/–¥–µ–¥—É—à–∫–∏)"
        ]
    },
    "transition_criteria": {
        "to_PHASE_3": [
            "user_has_created_action_plan == True",
            "emotional_regulation_improved (anger_intensity decreased by 30%)",
            "user_demonstrates_NVC_in_practice",
            "shows_readiness_for_action (ReadinessAssessor score > 0.6)",
            "understands_loyalty_conflict (key reframe achieved)"
        ]
    }
}

# Psychoeducation Module: Loyalty Conflict (PHASE_2 Primary Focus)

LOYALTY_CONFLICT_MODULE = {
    "name": "–ö–û–ù–§–õ–ò–ö–¢ –õ–û–Ø–õ–¨–ù–û–°–¢–ò –†–ï–ë–ï–ù–ö–ê",
    "source": "–ë—Ä–æ—à—é—Ä–∞ –Æ–ª–∏–∏ –ö–æ–≤–∞–ª—ë–≤–æ–π '–ö–æ–Ω—Ñ–ª–∏–∫—Ç –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏'",
    "priority": "PRIMARY (first psychoeducation topic in PHASE_2)",
    "rationale": "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –º–µ—Ö–∞–Ω–∏–∑–º PA. –ü–æ–Ω–∏–º–∞–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ - –∫–ª—é—á–µ–≤–æ–π —Ä–µ—Ñ—Ä–µ–π–º–∏–Ω–≥, –∫–æ—Ç–æ—Ä—ã–π —Å–Ω–∏–º–∞–µ—Ç –≤–∏–Ω—É —Å —Ä–æ–¥–∏—Ç–µ–ª—è –∏ —Ä–µ–±–µ–Ω–∫–∞, –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç —Ñ–æ–∫—É—Å —Å '–±–æ—Ä—å–±—ã' –Ω–∞ '–æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Ä–µ–±–µ–Ω–∫–∞ –æ—Ç –≤—ã–±–æ—Ä–∞'.",

    "learning_objectives": [
        "–ü–æ–Ω—è—Ç—å —á—Ç–æ —Ç–∞–∫–æ–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏",
        "–†–∞—Å–ø–æ–∑–Ω–∞—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ –≤ –ø–æ–≤–µ–¥–µ–Ω–∏–∏ —Ä–µ–±–µ–Ω–∫–∞",
        "–†–µ—Ñ—Ä–µ–π–º–∏—Ä–æ–≤–∞—Ç—å '–æ—Ç–≤–µ—Ä–∂–µ–Ω–∏–µ —Ä–µ–±–µ–Ω–∫–∞' –∫–∞–∫ '–∑–∞—â–∏—Ç–Ω—É—é —Ä–µ–∞–∫—Ü–∏—é –≤ –ª–æ–≤—É—à–∫–µ'",
        "–ü–µ—Ä–µ—Å—Ç–∞—Ç—å –≤–∏–Ω–∏—Ç—å —Ä–µ–±–µ–Ω–∫–∞",
        "–ù–∞—É—á–∏—Ç—å—Å—è '–æ—Å–≤–æ–±–æ–∂–¥–∞—Ç—å' —Ä–µ–±–µ–Ω–∫–∞ –æ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤—ã–±–æ—Ä–∞",
        "–ü–æ–Ω—è—Ç—å –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—É—é –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—É (–¥–µ—Ç–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è)"
    ],

    "content_delivery": {
        "stage_1_introduction": {
            "timing": "PHASE_2, session 1-2",
            "prompt": """
            –°–µ–π—á–∞—Å —è —Ä–∞—Å—Å–∫–∞–∂—É –æ —Å–∞–º–æ–º –≤–∞–∂–Ω–æ–º: –ø–æ—á–µ–º—É —Ä–µ–±–µ–Ω–æ–∫ –æ—Ç–¥–∞–ª—è–µ—Ç—Å—è –æ—Ç –≤–∞—Å.

            –†–µ–±–µ–Ω–æ–∫ –ø–µ—Ä–µ–∂–∏–≤–∞–µ—Ç —Ç–æ, —á—Ç–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **–∫–æ–Ω—Ñ–ª–∏–∫—Ç –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏**.

            –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ: —Ä–µ–±–µ–Ω–æ–∫ –ª—é–±–∏—Ç –í–ê–° –∏ –ª—é–±–∏—Ç –¥—Ä—É–≥–æ–≥–æ —Ä–æ–¥–∏—Ç–µ–ª—è. –ù–æ –æ–Ω —á—É–≤—Å—Ç–≤—É–µ—Ç (–∏–ª–∏ –µ–º—É –≥–æ–≤–æ—Ä—è—Ç), —á—Ç–æ –ª—é–±–∏—Ç—å –æ–¥–Ω–æ–≥–æ - –∑–Ω–∞—á–∏—Ç –ø—Ä–µ–¥–∞–≤–∞—Ç—å –¥—Ä—É–≥–æ–≥–æ.

            –≠—Ç–æ –Ω–µ–≤—ã–Ω–æ—Å–∏–º–∞—è –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –ª–æ–≤—É—à–∫–∞. –†–µ–±–µ–Ω–æ–∫ –Ω–µ –º–æ–∂–µ—Ç '–≤—ã–∏–≥—Ä–∞—Ç—å'.
            """,
            "visual_metaphor": "–ö–∞–Ω–∞—Ç–æ—Ö–æ–¥–µ—Ü –º–µ–∂–¥—É –¥–≤—É–º—è –±–∞—à–Ω—è–º–∏ - –¥–≤–∏–∂–µ–Ω–∏–µ –∫ –æ–¥–Ω–æ–π –∫–∞–∂–µ—Ç—Å—è –ø–∞–¥–µ–Ω–∏–µ–º —Å –¥—Ä—É–≥–æ–π",
            "check_understanding": "–ú–æ–∂–µ—Ç–µ —Å–≤–æ–∏–º–∏ —Å–ª–æ–≤–∞–º–∏ –æ–±—ä—è—Å–Ω–∏—Ç—å, —á—Ç–æ —Ç–∞–∫–æ–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏?"
        },

        "stage_2_mechanism": {
            "timing": "PHASE_2, session 2-3",
            "prompt": """
            –ö–∞–∫ —ç—Ç–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è? –ù–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–æ—Å–æ–±–æ–≤:

            1. **–ü—Ä—è–º—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è**: "–ï—Å–ª–∏ –ª—é–±–∏—à—å –º–µ–Ω—è, –Ω–µ –æ–±—â–∞–π—Å—è —Å –æ—Ç—Ü–æ–º/–º–∞—Ç–µ—Ä—å—é"
            2. **–ù–µ–≤–µ—Ä–±–∞–ª—å–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ**: –†–∞—Å—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ –ª–∏—Ü–æ —Ä–æ–¥–∏—Ç–µ–ª—è, –∫–æ–≥–¥–∞ —Ä–µ–±–µ–Ω–æ–∫ —É–ø–æ–º–∏–Ω–∞–µ—Ç –¥—Ä—É–≥–æ–≥–æ
            3. **–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –º–∞–Ω–∏–ø—É–ª—è—Ü–∏—è**: "–¢—ã –º–µ–Ω—è –±–æ–ª—å—à–µ –Ω–µ –ª—é–±–∏—à—å, —Ä–∞–∑ —Ö–æ—á–µ—à—å –∫ –Ω–µ–º—É/–Ω–µ–π?"
            4. **–°–æ–∑–¥–∞–Ω–∏–µ –∞–ª—å—è–Ω—Å–∞**: "–ú—ã —Å —Ç–æ–±–æ–π –ø—Ä–æ—Ç–∏–≤ –Ω–µ–≥–æ/–Ω–µ–µ"

            –†–µ–±–µ–Ω–æ–∫ **–∑–∞—â–∏—â–∞–µ—Ç—Å—è** –æ—Ç —ç—Ç–æ–≥–æ –¥–∞–≤–ª–µ–Ω–∏—è, –æ—Ç—Å—Ç—Ä–∞–Ω—è—è—Å—å –æ—Ç –≤–∞—Å. –≠—Ç–æ –ù–ï –µ–≥–æ –≤—ã–±–æ—Ä. –≠—Ç–æ **–≤—ã–∂–∏–≤–∞–Ω–∏–µ**.
            """,
            "personalization": "–í—Å–ø–æ–º–Ω–∏—Ç–µ —Å–∏—Ç—É–∞—Ü–∏–∏ —Å –≤–∞—à–∏–º —Ä–µ–±–µ–Ω–∫–æ–º. –í–∏–¥–∏—Ç–µ –ª–∏ –≤—ã —ç—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–∏?",
            "adherence_marker": "user_identifies_loyalty_conflict_in_own_situation"
        },

        "stage_3_reframe": {
            "timing": "PHASE_2, session 3-4",
            "prompt": """
            –í–∞–∂–Ω–µ–π—à–∏–π —Å–¥–≤–∏–≥ –≤ –≤–æ—Å–ø—Ä–∏—è—Ç–∏–∏:

            ‚ùå "–†–µ–±–µ–Ω–æ–∫ –º–µ–Ω—è –Ω–µ–Ω–∞–≤–∏–¥–∏—Ç"
            ‚úÖ "–†–µ–±–µ–Ω–æ–∫ –≤ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–µ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ –∏ –∑–∞—â–∏—â–∞–µ—Ç—Å—è"

            ‚ùå "–û–Ω –ø—Ä–µ–¥–∞—Ç–µ–ª—å, –≤—ã–±—Ä–∞–ª –¥—Ä—É–≥–æ–≥–æ"
            ‚úÖ "–ï–≥–æ –ó–ê–°–¢–ê–í–ò–õ–ò '–≤—ã–±—Ä–∞—Ç—å', –æ–Ω –∂–µ—Ä—Ç–≤–∞ –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏"

            ‚ùå "–ù–∞–¥–æ –±–æ—Ä–æ—Ç—å—Å—è –∑–∞ —Ä–µ–±–µ–Ω–∫–∞"
            ‚úÖ "–ù–∞–¥–æ –°–ù–Ø–¢–¨ —Å —Ä–µ–±–µ–Ω–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –≤—ã–±–æ—Ä–∞"

            –†–µ–±–µ–Ω–æ–∫ –ù–ï –≤–∏–Ω–æ–≤–∞—Ç. –í—ã –ù–ï –≤–∏–Ω–æ–≤–∞—Ç—ã. –í–∏–Ω–æ–≤–∞—Ç–∞ –°–ò–¢–£–ê–¶–ò–Ø.
            """,
            "cbt_integration": "Cognitive restructuring –æ—Ç blame –∫ empathy",
            "adherence_marker": "user_stops_blaming_child"
        },

        "stage_4_what_not_to_do": {
            "timing": "PHASE_2, session 4-5",
            "prompt": """
            –ß—Ç–æ –ù–ï –¥–µ–ª–∞—Ç—å (–∫—Ä–∏—Ç–∏—á–Ω–æ!):

            üö´ –ù–ï —É—Å–∏–ª–∏–≤–∞–π—Ç–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç: "–í—ã–±–µ—Ä–∏ –∫–æ–≥–æ –ª—é–±–∏—à—å –±–æ–ª—å—à–µ"
            üö´ –ù–ï –∫—Ä–∏—Ç–∏–∫—É–π—Ç–µ –¥—Ä—É–≥–æ–≥–æ —Ä–æ–¥–∏—Ç–µ–ª—è –ø—Ä–∏ —Ä–µ–±–µ–Ω–∫–µ (–£–°–ò–õ–ò–í–ê–ï–¢ –ª–æ–≤—É—à–∫—É)
            üö´ –ù–ï —Ç—Ä–µ–±—É–π—Ç–µ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤ –ª—é–±–≤–∏ ("–ï—Å–ª–∏ –ª—é–±–∏—à—å, –ø–æ—á–µ–º—É –Ω–µ –∑–≤–æ–Ω–∏—à—å?")
            üö´ –ù–ï –≤–∏–Ω–∏—Ç–µ —Ä–µ–±–µ–Ω–∫–∞

            –ö–∞–∂–¥–æ–µ –∏–∑ —ç—Ç–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π **—É–≥–ª—É–±–ª—è–µ—Ç** –∫–æ–Ω—Ñ–ª–∏–∫—Ç –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏.
            """,
            "guardrails": "ContentGuardian –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–∏—Å—å–º–∞ –Ω–∞ —ç—Ç–∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã (IP-02)"
        },

        "stage_5_what_to_do": {
            "timing": "PHASE_2, session 5-6",
            "prompt": """
            –ß—Ç–æ –î–ï–õ–ê–¢–¨:

            ‚úÖ **–û—Å–≤–æ–±–æ–¥–∏—Ç—å –æ—Ç –≤—ã–±–æ—Ä–∞**: "–¢—ã –º–æ–∂–µ—à—å –ª—é–±–∏—Ç—å –Ω–∞—Å –æ–±–æ–∏—Ö. –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ. –Ø –¥–∞—é —Ç–µ–±–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ."

            ‚úÖ **–ë–µ–∑—É—Å–ª–æ–≤–Ω–∞—è –ª—é–±–æ–≤—å**: "–Ø –ª—é–±–ª—é —Ç–µ–±—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, –≤–∏–¥–∏–º—Å—è –ª–∏ –º—ã. –ú–æ—è –ª—é–±–æ–≤—å –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–≤–æ–µ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è."

            ‚úÖ **–ù–µ –≤–æ–≤–ª–µ–∫–∞—Ç—å –≤ –∫–æ–Ω—Ñ–ª–∏–∫—Ç**: "–Ø –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –±—É–¥—É –ø—Ä–æ—Å–∏—Ç—å —Ç–µ–±—è –≤—ã–±–∏—Ä–∞—Ç—å –∏–ª–∏ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è."

            ‚úÖ **–¢–µ—Ä–ø–µ–Ω–∏–µ –∏ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∞**: "–î–µ—Ç–∏ –≤–∑—Ä–æ—Å–ª–µ—é—Ç –∏ –ø–æ–Ω–∏–º–∞—é—Ç. –Ø –±—É–¥—É –∂–¥–∞—Ç—å, –∫–æ–≥–¥–∞ —Ç—ã –±—É–¥–µ—à—å –≥–æ—Ç–æ–≤."

            –í–∞—à–∞ –∑–∞–¥–∞—á–∞ - –ù–ï –∑–∞—Å—Ç–∞–≤–∏—Ç—å —Ä–µ–±–µ–Ω–∫–∞ –≤—ã–±—Ä–∞—Ç—å –≤–∞—Å, –∞ **–°–ù–Ø–¢–¨** –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –≤—ã–±–æ—Ä–∞.
            """,
            "action_planning": "Integrate –≤ letter writing (IP-02) –∏ communication strategy",
            "adherence_marker": "user_commits_to_liberation_approach"
        },

        "stage_6_letter_exercise": {
            "timing": "PHASE_2, session 6-7",
            "prompt": """
            –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ: –ù–∞–ø–∏—à–µ–º "–ü–∏—Å—å–º–æ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è" —Ä–µ–±–µ–Ω–∫—É.

            –®–∞–±–ª–æ–Ω (–∞–¥–∞–ø—Ç–∏—Ä—É–µ–º –ø–æ–¥ –≤–∞—à —è–∑—ã–∫ –∏ —Å–∏—Ç—É–∞—Ü–∏—é):

            ---
            –î–æ—Ä–æ–≥–æ–π [–∏–º—è —Ä–µ–±–µ–Ω–∫–∞],

            –Ø —Ö–æ—á—É —Å–∫–∞–∑–∞—Ç—å —Ç–µ–±–µ –≤–∞–∂–Ω–æ–µ: —Ç—ã –º–æ–∂–µ—à—å –ª—é–±–∏—Ç—å –Ω–∞—Å –æ–±–æ–∏—Ö - –∏ –º–µ–Ω—è, –∏ [–∏–º—è –¥—Ä—É–≥–æ–≥–æ —Ä–æ–¥–∏—Ç–µ–ª—è]. –≠—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ. –¢—ã –Ω–µ –¥–æ–ª–∂–µ–Ω –≤—ã–±–∏—Ä–∞—Ç—å.

            –ú–æ—è –ª—é–±–æ–≤—å –∫ —Ç–µ–±–µ –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–æ–≥–æ, –∫–∞–∫ —á–∞—Å—Ç–æ –º—ã –≤–∏–¥–∏–º—Å—è. –Ø –≤—Å–µ–≥–¥–∞ –±—É–¥—É —Ç–≤–æ–∏–º –æ—Ç—Ü–æ–º/–º–∞—Ç–µ—Ä—å—é, –∏ —è —Ç–µ–±—è –ª—é–±–ª—é.

            –ö–æ–≥–¥–∞ –±—É–¥–µ—à—å –≥–æ—Ç–æ–≤ - —è –∑–¥–µ—Å—å.

            –° –ª—é–±–æ–≤—å—é,
            [–≤–∞—à–µ –∏–º—è]
            ---

            –•–æ—Ç–∏—Ç–µ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –Ω–∞–ø–∏—Å–∞—Ç—å —Å–≤–æ—é –≤–µ—Ä—Å–∏—é?
            """,
            "integration_ip02": "ContentGuardian –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ 'liberation' –ø—Ä–∏–Ω—Ü–∏–ø–∞–º",
            "goal_creation": "GoalTracker creates goal '–ù–∞–ø–∏—Å–∞—Ç—å –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–∏—Å—å–º–æ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è'"
        },

        "stage_7_long_term_hope": {
            "timing": "PHASE_2, session 7-8",
            "prompt": """
            –ü–æ—Å–ª–µ–¥–Ω–µ–µ –∏ —Å–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ: –ù–ê–î–ï–ñ–î–ê.

            üìä **–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç**: –∫–æ–≥–¥–∞ –¥–µ—Ç–∏ –≤–∑—Ä–æ—Å–ª–µ—é—Ç, –æ–Ω–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –∫ –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç–æ–º—É —Ä–æ–¥–∏—Ç–µ–ª—é –≤ **80% —Å–ª—É—á–∞–µ–≤**.

            –û–Ω–∏ **–ø–æ–Ω–∏–º–∞—é—Ç**, —á—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ. –û–Ω–∏ **—á—É–≤—Å—Ç–≤—É—é—Ç –≤–∏–Ω—É** –∑–∞ –æ—Ç–≤–µ—Ä–∂–µ–Ω–∏–µ. –û–Ω–∏ **–∏—â—É—Ç** –≤–∞—Å.

            –í–∞—à–∞ –∑–∞–¥–∞—á–∞ - –±—ã—Ç—å –≥–æ—Ç–æ–≤—ã–º **–ø—Ä–∏–Ω—è—Ç—å –∏—Ö** –±–µ–∑ –æ–±–≤–∏–Ω–µ–Ω–∏–π, –∫–æ–≥–¥–∞ –ø—Ä–∏–¥–µ—Ç –≤—Ä–µ–º—è.

            –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —á–µ—Ä–µ–∑ –≥–æ–¥, —á–µ—Ä–µ–∑ 5 –ª–µ—Ç, —á–µ—Ä–µ–∑ 10. –ù–æ –æ–Ω–∏ **–≤–µ—Ä–Ω—É—Ç—Å—è**.
            """,
            "phase_transition": "Sets foundation –¥–ª—è PHASE_3 (patience + strategic action)",
            "adherence_marker": "user_demonstrates_long_term_hope"
        }
    },

    "homework_assignments": {
        "loyalty_conflict_journal": {
            "description": "–ó–∞–ø–∏—Å–∞—Ç—å 3 —Å–∏—Ç—É–∞—Ü–∏–∏, –≥–¥–µ —Ä–µ–±–µ–Ω–æ–∫ –º–æ–≥ –±—ã—Ç—å –≤ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–µ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏",
            "format": "–°–∏—Ç—É–∞—Ü–∏—è -> –ß—Ç–æ —Ä–µ–±–µ–Ω–æ–∫ —Å–∫–∞–∑–∞–ª/—Å–¥–µ–ª–∞–ª -> –ö–∞–∫–æ–π –∫–æ–Ω—Ñ–ª–∏–∫—Ç –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ —ç—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç",
            "frequency": "weekly –≤ PHASE_2"
        },
        "reframing_exercise": {
            "description": "–ü–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å 5 '–Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö' –¥–µ–π—Å—Ç–≤–∏–π —Ä–µ–±–µ–Ω–∫–∞ —á–µ—Ä–µ–∑ –ø—Ä–∏–∑–º—É –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏",
            "example": "'–†–µ–±–µ–Ω–æ–∫ –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª –Ω–∞ –∑–≤–æ–Ω–æ–∫' -> '–†–µ–±–µ–Ω–æ–∫ –±–æ—è–ª—Å—è —Ä–∞—Å—Å—Ç—Ä–æ–∏—Ç—å –º–∞–º—É, –∫–æ—Ç–æ—Ä–∞—è —Ä—è–¥–æ–º'",
            "frequency": "bi-weekly"
        },
        "liberation_letter_draft": {
            "description": "–ù–∞–ø–∏—Å–∞—Ç—å –ø–∏—Å—å–º–æ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è",
            "steps": [
                "Draft –ø–∏—Å—å–º–∞ (IP-04 guided exercise)",
                "ContentGuardian check (IP-02)",
                "User revision",
                "Save to time capsule OR send (user choice)"
            ],
            "adherence_check": "IP-04 AdherenceTracker"
        }
    },

    "integration_points": {
        "IP-01_RAG": "loyalty_conflict.md –≤ knowledge base, semantic search –¥–ª—è queries –æ —Ä–µ–±–µ–Ω–∫–µ",
        "IP-02_Letter_Writing": "ContentGuardian –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–∏—Å—å–º–∞ –Ω–∞ '–æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ' vs '–¥–∞–≤–ª–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∞'",
        "IP-03_States": "SEEKING_UNDERSTANDING state –≤–∫–ª—é—á–∞–µ—Ç loyalty conflict module",
        "IP-04_Techniques": "CBT reframing, IFS parts work, NVC –¥–ª—è liberation messages",
        "IP-06_Evaluation": "Measure –ø–æ–Ω–∏–º–∞–Ω–∏—è loyalty conflict –∫–∞–∫ success metric",
        "ProfileStore": "Track loyalty_conflict_understanding: bool –≤ user profile"
    },

    "success_metrics": {
        "cognitive_shift": "User correctly identifies loyalty conflict –≤ 3+ —Å–∏—Ç—É–∞—Ü–∏—è—Ö",
        "emotional_shift": "Anger toward child —Å–Ω–∏–∂–∞–µ—Ç—Å—è –Ω–∞ 50%+ (Progress Indicators)",
        "behavioral_shift": "User —Å–æ–∑–¥–∞–ª liberation letter (GoalTracker milestone)",
        "long_term_shift": "User demonstrates patience + hope (not despair)"
    }
}

# Psychoeducation Module: –ò—Ä—Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –º–æ—Ç–∏–≤—ã –û–ë–û–ò–• —Ä–æ–¥–∏—Ç–µ–ª–µ–π

IRRATIONAL_MOTIVES_MODULE = {
    "name": "–ü–û–ù–ò–ú–ê–ù–ò–ï –ü–°–ò–•–û–õ–û–ì–ò–ò –û–ë–û–ò–• –†–û–î–ò–¢–ï–õ–ï–ô",
    "source": "–ë—Ä–æ—à—é—Ä–∞ –Æ–ª–∏–∏ –ö–æ–≤–∞–ª—ë–≤–æ–π '–ö–æ–Ω—Ñ–ª–∏–∫—Ç –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏' + –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è PA",
    "timing": "PHASE_2_UNDERSTANDING, sessions 8-10 (–ø–æ—Å–ª–µ loyalty conflict)",
    "rationale": "–ü–æ–Ω–∏–º–∞–Ω–∏–µ –∏—Ä—Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –º–æ—Ç–∏–≤–æ–≤ –û–ë–û–ò–• —Ä–æ–¥–∏—Ç–µ–ª–µ–π –ø–æ–º–æ–≥–∞–µ—Ç: (1) —Å–Ω—è—Ç—å –≤–∏–Ω—É —Å —Å–µ–±—è, (2) —Ä–∞–∑–≤–∏—Ç—å —ç–º–ø–∞—Ç–∏—é –∫ ex-partner (—Å–Ω–∏–∂–∞–µ—Ç –≥–Ω–µ–≤), (3) –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ alienator, (4) –≤—ã—Ä–∞–±–æ—Ç–∞—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é",

    "custodial_parent_motives": {
        "description": "–ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –¥—Ä–∞–π–≤–µ—Ä—ã —Ä–æ–¥–∏—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç—á—É–∂–¥–∞–µ—Ç —Ä–µ–±–µ–Ω–∫–∞",
        "categories": [
            {
                "motive": "–°—Ç—Ä–∞—Ö –ø–æ—Ç–µ—Ä–∏ –∫–æ–Ω—Ç—Ä–æ–ª—è",
                "details": "–†–æ–¥–∏—Ç–µ–ª—å –±–æ–∏—Ç—Å—è, —á—Ç–æ –µ—Å–ª–∏ —Ä–µ–±–µ–Ω–æ–∫ –±—É–¥–µ—Ç –æ–±—â–∞—Ç—å—Å—è —Å –¥—Ä—É–≥–∏–º —Ä–æ–¥–∏—Ç–µ–ª–µ–º, –æ–Ω '–ø–æ—Ç–µ—Ä—è–µ—Ç' —Ä–µ–±–µ–Ω–∫–∞ –Ω–∞–≤—Å–µ–≥–¥–∞. –ö–∞–∂–¥–∞—è –≤—Å—Ç—Ä–µ—á–∞ –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è –∫–∞–∫ —É–≥—Ä–æ–∑–∞.",
                "examples": [
                    "–ó–∞–ø—Ä–µ—â–∞–µ—Ç –∑–≤–æ–Ω–∫–∏, —Ç.–∫. –±–æ–∏—Ç—Å—è —á—Ç–æ —Ä–µ–±–µ–Ω–æ–∫ '–ø–µ—Ä–µ–º–µ—Ç–Ω–µ—Ç—Å—è'",
                    "–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –∫–∞–∂–¥—É—é –¥–µ—Ç–∞–ª—å –≤–∏–∑–∏—Ç–æ–≤",
                    "–¢—Ä–µ–±—É–µ—Ç –æ—Ç—á–µ—Ç–æ–≤ –æ—Ç —Ä–µ–±–µ–Ω–∫–∞ –ø–æ—Å–ª–µ –≤—Å—Ç—Ä–µ—á"
                ],
                "underlying_belief": "'–ï—Å–ª–∏ —è –æ—Å–ª–∞–±–ª—é –∫–æ–Ω—Ç—Ä–æ–ª—å, —è –ø–æ—Ç–µ—Ä—è—é —Ä–µ–±–µ–Ω–∫–∞'",
                "reality_check": "–î–µ—Ç–∏ –Ω–µ '–≤—ã–±–∏—Ä–∞—é—Ç' —Ä–æ–¥–∏—Ç–µ–ª—è –ø—Ä–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º –∫–æ–Ω—Ç–∞–∫—Ç–µ. –ö–æ–Ω—Ç—Ä–æ–ª—å —É—Å–∏–ª–∏–≤–∞–µ—Ç –æ—Ç—á—É–∂–¥–µ–Ω–∏–µ."
            },
            {
                "motive": "–ó–∞—â–∏—Ç–Ω–∞—è –∞–≥—Ä–µ—Å—Å–∏—è",
                "details": "–†–æ–¥–∏—Ç–µ–ª—å –∏—Å–∫—Ä–µ–Ω–Ω–µ –≤–µ—Ä–∏—Ç, —á—Ç–æ –∑–∞—â–∏—â–∞–µ—Ç —Ä–µ–±–µ–Ω–∫–∞ –æ—Ç '–ø–ª–æ—Ö–æ–≥–æ' —Ä–æ–¥–∏—Ç–µ–ª—è. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–µ–∫—Ü–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–∞—Ö–æ–≤ –∏–ª–∏ —Ä–µ–∞–∫—Ü–∏—è –Ω–∞ –ø—Ä–æ—à–ª—ã–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã.",
                "examples": [
                    "–ì–æ–≤–æ—Ä–∏—Ç —Ä–µ–±–µ–Ω–∫—É: '–û—Ç–µ—Ü/–º–∞—Ç—å —Ç–µ–±—è –æ–±–∏–¥–∏—Ç'",
                    "–ü—Ä–∏–ø–∏—Å—ã–≤–∞–µ—Ç –∑–ª—ã–µ –Ω–∞–º–µ—Ä–µ–Ω–∏—è: '–û–Ω —Ö–æ—á–µ—Ç –∑–∞–±—Ä–∞—Ç—å —Ç–µ–±—è –æ—Ç –º–µ–Ω—è'",
                    "–°–æ–∑–¥–∞–µ—Ç –æ–±—Ä–∞–∑ '–æ–ø–∞—Å–Ω–æ–≥–æ' —Ä–æ–¥–∏—Ç–µ–ª—è"
                ],
                "underlying_belief": "'–Ø –∑–∞—â–∏—â–∞—é —Ä–µ–±–µ–Ω–∫–∞ –æ—Ç —É–≥—Ä–æ–∑—ã'",
                "reality_check": "–ï—Å–ª–∏ –Ω–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–≥–æ –Ω–∞—Å–∏–ª–∏—è/–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, —ç—Ç–æ –ø—Ä–æ–µ–∫—Ü–∏—è, –Ω–µ –∑–∞—â–∏—Ç–∞."
            },
            {
                "motive": "–ú–µ—Å—Ç—å –∏ –Ω–∞–∫–∞–∑–∞–Ω–∏–µ",
                "details": "–†–æ–¥–∏—Ç–µ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–±–µ–Ω–∫–∞ –∫–∞–∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –º–µ—Å—Ç–∏ –∑–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –∏–ª–∏ –≤–æ–æ–±—Ä–∞–∂–∞–µ–º—ã–µ –æ–±–∏–¥—ã. '–¢—ã –º–µ–Ω—è –±—Ä–æ—Å–∏–ª - —è –∑–∞–±–µ—Ä—É —É —Ç–µ–±—è —Ä–µ–±–µ–Ω–∫–∞'.",
                "examples": [
                    "–ë–ª–æ–∫–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç–∞–∫—Ç –ø–æ—Å–ª–µ —Å—Å–æ—Ä—ã —Å ex-partner",
                    "–ì–æ–≤–æ—Ä–∏—Ç —Ä–µ–±–µ–Ω–∫—É: '–û–Ω –±—Ä–æ—Å–∏–ª –Ω–∞—Å'",
                    "–û—Ç–∫–∞–∑—ã–≤–∞–µ—Ç –≤ –≤–∏–¥–µ–æ-–∑–≤–æ–Ω–∫–∞—Ö –∫–∞–∫ '–Ω–∞–∫–∞–∑–∞–Ω–∏–µ'"
                ],
                "underlying_belief": "'–û–Ω/–æ–Ω–∞ –¥–æ–ª–∂–µ–Ω –∑–∞–ø–ª–∞—Ç–∏—Ç—å –∑–∞ —Ç–æ, —á—Ç–æ —Å–¥–µ–ª–∞–ª –º–Ω–µ'",
                "reality_check": "–†–µ–±–µ–Ω–æ–∫ - –Ω–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –º–µ—Å—Ç–∏. –û–Ω —Å—Ç—Ä–∞–¥–∞–µ—Ç –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ."
            },
            {
                "motive": "–†–µ–≤–Ω–æ—Å—Ç—å –∫ –æ—Ç–Ω–æ—à–µ–Ω–∏—è–º —Ä–µ–±–µ–Ω–∫–∞ —Å –¥—Ä—É–≥–∏–º —Ä–æ–¥–∏—Ç–µ–ª–µ–º",
                "details": "–†–æ–¥–∏—Ç–µ–ª—å —á—É–≤—Å—Ç–≤—É–µ—Ç —Ä–µ–≤–Ω–æ—Å—Ç—å, –∫–æ–≥–¥–∞ —Ä–µ–±–µ–Ω–æ–∫ –≤—ã—Ä–∞–∂–∞–µ—Ç –ª—é–±–æ–≤—å –∫ –¥—Ä—É–≥–æ–º—É. –í–æ—Å–ø—Ä–∏–Ω–∏–º–∞–µ—Ç —ç—Ç–æ –∫–∞–∫ –ø—Ä–µ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ.",
                "examples": [
                    "–†–∞—Å—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è, –∫–æ–≥–¥–∞ —Ä–µ–±–µ–Ω–æ–∫ –≥–æ–≤–æ—Ä–∏—Ç '–Ø —Å–∫—É—á–∞—é –ø–æ –ø–∞–ø–µ/–º–∞–º–µ'",
                    "–ö–æ–Ω–∫—É—Ä–∏—Ä—É–µ—Ç –∑–∞ –ª—é–±–æ–≤—å: '–ö–æ–≥–æ —Ç—ã –±–æ–ª—å—à–µ –ª—é–±–∏—à—å?'",
                    "–û–±–µ—Å—Ü–µ–Ω–∏–≤–∞–µ—Ç –¥—Ä—É–≥–æ–≥–æ —Ä–æ–¥–∏—Ç–µ–ª—è: '–Ø –∂–µ —Ç–µ–±–µ –ª—É—á—à–µ –ø–æ–∫—É–ø–∞—é'"
                ],
                "underlying_belief": "'–ï—Å–ª–∏ —Ä–µ–±–µ–Ω–æ–∫ –ª—é–±–∏—Ç –µ–≥–æ/–µ–µ, –∑–Ω–∞—á–∏—Ç –º–µ–Ω—è –ª—é–±–∏—Ç –º–µ–Ω—å—à–µ'",
                "reality_check": "–õ—é–±–æ–≤—å –∫ –æ–¥–Ω–æ–º—É —Ä–æ–¥–∏—Ç–µ–ª—é –Ω–µ —É–º–µ–Ω—å—à–∞–µ—Ç –ª—é–±–æ–≤—å –∫ –¥—Ä—É–≥–æ–º—É. –≠—Ç–æ –Ω–µ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–µ."
            },
            {
                "motive": "–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –º–æ—Ç–∏–≤—ã",
                "details": "–ö–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Ä–µ–±–µ–Ω–∫–æ–º = –∞–ª–∏–º–µ–Ω—Ç—ã, –ø–æ—Å–æ–±–∏—è, –∂–∏–ª—å–µ. –°—Ç—Ä–∞—Ö –ø–æ—Ç–µ—Ä–∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏.",
                "examples": [
                    "–ë–æ–∏—Ç—Å—è —Å–æ–≤–º–µ—Å—Ç–Ω–æ–π –æ–ø–µ–∫–∏, —Ç.–∫. —Å–Ω–∏–∑—è—Ç—Å—è –∞–ª–∏–º–µ–Ω—Ç—ã",
                    "–ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–±–µ–Ω–∫–∞ –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç –¥–ª—è –∂–∏–ª—å—è/—Ñ–∏–Ω–∞–Ω—Å–æ–≤",
                    "–°–æ–ø—Ä–æ—Ç–∏–≤–ª—è–µ—Ç—Å—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—é –≤—Ä–µ–º–µ–Ω–∏"
                ],
                "underlying_belief": "'–ï—Å–ª–∏ –ø–æ—Ç–µ—Ä—è—é —Ä–µ–±–µ–Ω–∫–∞, –ø–æ—Ç–µ—Ä—è—é –¥–µ–Ω—å–≥–∏/—Å—Ç–∞—Ç—É—Å'",
                "reality_check": "–†–µ–±–µ–Ω–æ–∫ - –Ω–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –∞–∫—Ç–∏–≤. –°—É–¥—ã –∑–∞—â–∏—â–∞—é—Ç –∏–Ω—Ç–µ—Ä–µ—Å—ã —Ä–µ–±–µ–Ω–∫–∞."
            },
            {
                "motive": "–°—Ç—Ä–∞—Ö –æ–¥–∏–Ω–æ—á–µ—Å—Ç–≤–∞",
                "details": "–†–µ–±–µ–Ω–æ–∫ - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –æ–ø–æ—Ä–∞ —Ä–æ–¥–∏—Ç–µ–ª—è. –°—Ç—Ä–∞—Ö –æ—Å—Ç–∞—Ç—å—Å—è –æ–¥–Ω–æ–º—É –ø–æ—Å–ª–µ —Ä–∞–∑–≤–æ–¥–∞.",
                "examples": [
                    "–†–µ–±–µ–Ω–æ–∫ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä–æ–ª—å –ø–∞—Ä—Ç–Ω–µ—Ä–∞ (—ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Ü–µ—Å—Ç)",
                    "–†–æ–¥–∏—Ç–µ–ª—å –¥–µ–ª–∏—Ç—Å—è —Å —Ä–µ–±–µ–Ω–∫–æ–º –≤–∑—Ä–æ—Å–ª—ã–º–∏ –ø—Ä–æ–±–ª–µ–º–∞–º–∏",
                    "–ì–æ–≤–æ—Ä–∏—Ç: '–£ –º–µ–Ω—è –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ —Ç—ã'"
                ],
                "underlying_belief": "'–ï—Å–ª–∏ —Ä–µ–±–µ–Ω–æ–∫ —É–π–¥–µ—Ç, —è –æ—Å—Ç–∞–Ω—É—Å—å –æ–¥–∏–Ω/–æ–¥–Ω–∞'",
                "reality_check": "–†–µ–±–µ–Ω–æ–∫ - –Ω–µ —Ç–µ—Ä–∞–ø–µ–≤—Ç –∏ –Ω–µ –ø–∞—Ä—Ç–Ω–µ—Ä. –†–æ–¥–∏—Ç–µ–ª—é –Ω—É–∂–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–∑—Ä–æ—Å–ª—ã—Ö."
            }
        ]
    },

    "non_custodial_parent_motives": {
        "description": "–ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –¥—Ä–∞–π–≤–µ—Ä—ã –æ—Ç—á—É–∂–¥–∞–µ–º–æ–≥–æ —Ä–æ–¥–∏—Ç–µ–ª—è (important –¥–ª—è —Å–∞–º–æ—Å–æ–∑–Ω–∞–Ω–∏—è)",
        "categories": [
            {
                "motive": "–ë–æ–ª—å –∏ —É—Ç—Ä–∞—Ç–∞",
                "details": "–ì–ª—É–±–æ–∫–∞—è —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –±–æ–ª—å –æ—Ç –ø–æ—Ç–µ—Ä–∏ –∫–æ–Ω—Ç–∞–∫—Ç–∞ —Å —Ä–µ–±–µ–Ω–∫–æ–º. –≠—Ç–æ –ª–µ–≥–∏—Ç–∏–º–Ω–∞—è —ç–º–æ—Ü–∏—è, –Ω–æ –º–æ–∂–µ—Ç –≤–µ—Å—Ç–∏ –∫ –¥–µ—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–º –¥–µ–π—Å—Ç–≤–∏—è–º.",
                "examples": [
                    "–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è —Ç–æ—Å–∫–∞, –¥–µ–ø—Ä–µ—Å—Å–∏—è",
                    "–ù–∞–≤—è–∑—á–∏–≤—ã–µ –º—ã—Å–ª–∏ –æ —Ä–µ–±–µ–Ω–∫–µ",
                    "–§–∏–∑–∏—á–µ—Å–∫–∏–µ —Å–∏–º–ø—Ç–æ–º—ã (–±–µ—Å—Å–æ–Ω–Ω–∏—Ü–∞, –ø–æ—Ç–µ—Ä—è –∞–ø–ø–µ—Ç–∏—Ç–∞)"
                ],
                "underlying_belief": "'–Ø –ø–æ—Ç–µ—Ä—è–ª —Å–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ –≤ –∂–∏–∑–Ω–∏'",
                "adaptive_response": "–ü—Ä–∏–∑–Ω–∞—Ç—å –±–æ–ª—å, –Ω–æ –Ω–µ –ø–æ–∑–≤–æ–ª—è—Ç—å –µ–π —É–ø—Ä–∞–≤–ª—è—Ç—å –¥–µ–π—Å—Ç–≤–∏—è–º–∏. –¢–µ—Ä–∞–ø–∏—è, –ø–æ–¥–¥–µ—Ä–∂–∫–∞."
            },
            {
                "motive": "–°—Ç—Ä–∞—Ö –±—ã—Ç—å –∑–∞–±—ã—Ç—ã–º",
                "details": "–ü–∞–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç—Ä–∞—Ö, —á—Ç–æ —Ä–µ–±–µ–Ω–æ–∫ –∑–∞–±—É–¥–µ—Ç —Ä–æ–¥–∏—Ç–µ–ª—è, –ø–µ—Ä–µ—Å—Ç–∞–Ω–µ—Ç –ª—é–±–∏—Ç—å, '–∑–∞–º–µ–Ω–∏—Ç' –¥—Ä—É–≥–∏–º.",
                "examples": [
                    "–ö–æ–º–ø—É–ª—å—Å–∏–≤–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –∫–æ–Ω—Ç–∞–∫—Ç–∞ (10 –∑–≤–æ–Ω–∫–æ–≤ –≤ –¥–µ–Ω—å)",
                    "–ù–∞–≤—è–∑—á–∏–≤—ã–µ –ø–æ–¥–∞—Ä–∫–∏, —Å–æ–æ–±—â–µ–Ω–∏—è",
                    "–í–æ–ø—Ä–æ—Å—ã '–¢—ã –º–µ–Ω—è –ø–æ–º–Ω–∏—à—å?' –≤ –ø–∏—Å—å–º–∞—Ö"
                ],
                "underlying_belief": "'–ï—Å–ª–∏ –Ω–µ –±—É–¥—É –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –Ω–∞–ø–æ–º–∏–Ω–∞—Ç—å, –æ–Ω –∑–∞–±—É–¥–µ—Ç –º–µ–Ω—è'",
                "adaptive_response": "–î–µ—Ç–∏ –Ω–µ –∑–∞–±—ã–≤–∞—é—Ç —Ä–æ–¥–∏—Ç–µ–ª–µ–π. –ö–∞—á–µ—Å—Ç–≤–æ > –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ. Trust the bond."
            },
            {
                "motive": "–ì–Ω–µ–≤ –∏ –∂–µ–ª–∞–Ω–∏–µ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç–∏",
                "details": "–Ø—Ä–æ—Å—Ç—å –Ω–∞ ex-partner –∑–∞ –æ—Ç—á—É–∂–¥–µ–Ω–∏–µ, –Ω–∞ —Å–∏—Å—Ç–µ–º—É –∑–∞ –Ω–µ—Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç—å. –ñ–µ–ª–∞–Ω–∏–µ '–Ω–∞–∫–∞–∑–∞—Ç—å' –≤–∏–Ω–æ–≤–Ω—ã—Ö.",
                "examples": [
                    "–°—É–¥–µ–±–Ω—ã–µ –±–∞—Ç–∞–ª–∏–∏ –Ω–µ —Ä–∞–¥–∏ —Ä–µ–±–µ–Ω–∫–∞, –∞ —Ä–∞–¥–∏ –ø–æ–±–µ–¥—ã",
                    "–ü—É–±–ª–∏—á–Ω–∞—è —Ç—Ä–∞–≤–ª—è ex-partner –≤ —Å–æ—Ü—Å–µ—Ç—è—Ö",
                    "–ü–æ–ø—ã—Ç–∫–∏ '—Ä–∞–∑–æ–±–ª–∞—á–∏—Ç—å' alienator –ø–µ—Ä–µ–¥ —Ä–µ–±–µ–Ω–∫–æ–º"
                ],
                "underlying_belief": "'–û–Ω–∏ –¥–æ–ª–∂–Ω—ã –∑–∞–ø–ª–∞—Ç–∏—Ç—å –∑–∞ —Ç–æ, —á—Ç–æ —Å–¥–µ–ª–∞–ª–∏'",
                "adaptive_response": "–ì–Ω–µ–≤ –ª–µ–≥–∏—Ç–∏–º–µ–Ω, –Ω–æ –º–µ—Å—Ç—å –≤—Ä–µ–¥–∏—Ç —Ä–µ–±–µ–Ω–∫—É. –§–æ–∫—É—Å –Ω–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ, –Ω–µ –Ω–∞–∫–∞–∑–∞–Ω–∏–µ."
            },
            {
                "motive": "–ë–µ—Å—Å–∏–ª–∏–µ –∏ –æ—Ç—á–∞—è–Ω–∏–µ",
                "details": "–ß—É–≤—Å—Ç–≤–æ –ø–æ–ª–Ω–æ–≥–æ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –∫–æ–Ω—Ç—Ä–æ–ª—è. '–Ø –Ω–∏—á–µ–≥–æ –Ω–µ –º–æ–≥—É —Å–¥–µ–ª–∞—Ç—å'. –ú–æ–∂–µ—Ç –≤–µ—Å—Ç–∏ –∫ –∫–∞–ø–∏—Ç—É–ª—è—Ü–∏–∏ –∏–ª–∏ –ø–∞–Ω–∏–∫–µ.",
                "examples": [
                    "–û—Ç–∫–∞–∑ –æ—Ç –ø–æ–ø—ã—Ç–æ–∫ –∫–æ–Ω—Ç–∞–∫—Ç–∞ ('–≤—Å–µ —Ä–∞–≤–Ω–æ –±–µ—Å–ø–æ–ª–µ–∑–Ω–æ')",
                    "–ò–ª–∏ –Ω–∞–æ–±–æ—Ä–æ—Ç - —Ö–∞–æ—Ç–∏—á–Ω—ã–µ, –Ω–µ–æ–±–¥—É–º–∞–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è",
                    "–°—É–∏—Ü–∏–¥–∞–ª—å–Ω—ã–µ –º—ã—Å–ª–∏"
                ],
                "underlying_belief": "'–Ø –±–µ—Å–ø–æ–º–æ—â–µ–Ω, –Ω–∏—á–µ–≥–æ –Ω–µ –º–æ–≥—É –∏–∑–º–µ–Ω–∏—Ç—å'",
                "adaptive_response": "–ï—Å—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç. –ú–∞–ª–µ–Ω—å–∫–∏–µ —à–∞–≥–∏. –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∞."
            },
            {
                "motive": "–í–∏–Ω–∞ –∏ —Å–∞–º–æ–æ–±–≤–∏–Ω–µ–Ω–∏–µ",
                "details": "–ì–ª—É–±–æ–∫–æ–µ —á—É–≤—Å—Ç–≤–æ –≤–∏–Ω—ã: '–≠—Ç–æ –º–æ—è –≤–∏–Ω–∞', '–Ø –ø–ª–æ—Ö–æ–π —Ä–æ–¥–∏—Ç–µ–ª—å', '–Ø —á—Ç–æ-—Ç–æ —Å–¥–µ–ª–∞–ª –Ω–µ —Ç–∞–∫'.",
                "examples": [
                    "–ö–æ–º–ø—É–ª—å—Å–∏–≤–Ω–æ–µ –ø–µ—Ä–µ–∏–≥—Ä—ã–≤–∞–Ω–∏–µ –ø—Ä–æ—à–ª–æ–≥–æ ('–ï—Å–ª–∏ –±—ã —è...')",
                    "–°–∞–º–æ–±–∏—á–µ–≤–∞–Ω–∏–µ",
                    "–ü–æ–ø—ã—Ç–∫–∏ '–∏—Å–∫—É–ø–∏—Ç—å –≤–∏–Ω—É' —á–µ—Ä–µ–∑ –ø–æ–¥–∞—Ä–∫–∏/—É—Å—Ç—É–ø–∫–∏"
                ],
                "underlying_belief": "'–ï—Å–ª–∏ –±—ã —è –±—ã–ª –ª—É—á—à–µ, —ç—Ç–æ–≥–æ –±—ã –Ω–µ –ø—Ä–æ–∏–∑–æ—à–ª–æ'",
                "adaptive_response": "CBT –¥–ª—è –∫–æ–≥–Ω–∏—Ç–∏–≤–Ω—ã—Ö –∏—Å–∫–∞–∂–µ–Ω–∏–π. –í—ã –ù–ï –≤–∏–Ω–æ–≤–∞—Ç—ã –≤ PA."
            },
            {
                "motive": "–ù–∞–¥–µ–∂–¥–∞ –∏ —Ü–µ–ø–ª—è–Ω–∏–µ –∑–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å",
                "details": "–ù–∞–≤—è–∑—á–∏–≤–∞—è –Ω–∞–¥–µ–∂–¥–∞ '–≤–µ—Ä–Ω—É—Ç—å –≤—Å–µ –∫–∞–∫ –±—ã–ª–æ'. –û—Ç–∫–∞–∑ –ø—Ä–∏–Ω—è—Ç—å –Ω–æ–≤—É—é —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å.",
                "examples": [
                    "–§–∞–Ω—Ç–∞–∑–∏–∏ –æ '—Å–ø–∞—Å–µ–Ω–∏–∏' —Ä–µ–±–µ–Ω–∫–∞",
                    "–û—Ç–∫–∞–∑ –æ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –∂–∏–∑–Ω–∏ ('—è –∂–¥—É, –∫–æ–≥–¥–∞ –æ–Ω –≤–µ—Ä–Ω–µ—Ç—Å—è')",
                    "–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, —á—Ç–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç"
                ],
                "underlying_belief": "'–ï—Å–ª–∏ —è –±—É–¥—É –æ—á–µ–Ω—å —Å—Ç–∞—Ä–∞—Ç—å—Å—è, –≤—Å–µ –≤–µ—Ä–Ω–µ—Ç—Å—è'",
                "adaptive_response": "–ë–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –Ω–∞–¥–µ–∂–¥–æ–π –∏ –ø—Ä–∏–Ω—è—Ç–∏–µ–º. –°—Ç—Ä–æ–∏—Ç—å –∂–∏–∑–Ω—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ."
            }
        ]
    },

    "delivery_strategy": {
        "stage_1_custodial_motives": {
            "timing": "PHASE_2, session 8",
            "prompt": """
            –¢–µ–ø–µ—Ä—å –≤–∞–∂–Ω–∞—è —Ç–µ–º–∞: –¥–∞–≤–∞–π—Ç–µ –ø–æ–π–º–µ–º –ø—Å–∏—Ö–æ–ª–æ–≥–∏—é ex-partner.

            –ü–æ—á–µ–º—É –æ–Ω/–æ–Ω–∞ –æ—Ç—á—É–∂–¥–∞–µ—Ç —Ä–µ–±–µ–Ω–∫–∞? –≠—Ç–æ –Ω–µ '–∑–ª–æ —Ä–∞–¥–∏ –∑–ª–∞'. –£ —ç—Ç–æ–≥–æ –µ—Å—Ç—å –∏—Ä—Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –º–æ—Ç–∏–≤—ã:

            1. **–°—Ç—Ä–∞—Ö –ø–æ—Ç–µ—Ä–∏ –∫–æ–Ω—Ç—Ä–æ–ª—è**: –ë–æ–∏—Ç—Å—è —á—Ç–æ '–ø–æ—Ç–µ—Ä—è–µ—Ç' —Ä–µ–±–µ–Ω–∫–∞
            2. **–ó–∞—â–∏—Ç–Ω–∞—è –∞–≥—Ä–µ—Å—Å–∏—è**: –í–µ—Ä–∏—Ç —á—Ç–æ '–∑–∞—â–∏—â–∞–µ—Ç' —Ä–µ–±–µ–Ω–∫–∞ –æ—Ç –≤–∞—Å
            3. **–ú–µ—Å—Ç—å**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–±–µ–Ω–∫–∞ –∫–∞–∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –Ω–∞–∫–∞–∑–∞–Ω–∏—è
            4. **–†–µ–≤–Ω–æ—Å—Ç—å**: –ù–µ –≤—ã–Ω–æ—Å–∏—Ç —á—Ç–æ —Ä–µ–±–µ–Ω–æ–∫ –ª—é–±–∏—Ç –≤–∞—Å
            5. **–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –º–æ—Ç–∏–≤—ã**: –ö–æ–Ω—Ç—Ä–æ–ª—å = –¥–µ–Ω—å–≥–∏/—Å—Ç–∞—Ç—É—Å
            6. **–°—Ç—Ä–∞—Ö –æ–¥–∏–Ω–æ—á–µ—Å—Ç–≤–∞**: –†–µ–±–µ–Ω–æ–∫ - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –æ–ø–æ—Ä–∞

            –ö–∞–∫–∏–µ –∏–∑ —ç—Ç–∏—Ö –º–æ—Ç–∏–≤–æ–≤ –≤—ã –≤–∏–¥–∏—Ç–µ –≤ –ø–æ–≤–µ–¥–µ–Ω–∏–∏ ex-partner?
            """,
            "goal": "–†–∞–∑–≤–∏—Ç—å —ç–º–ø–∞—Ç–∏—é –∫ alienator (–Ω–µ –æ–ø—Ä–∞–≤–¥–∞–Ω–∏–µ, –∞ –ø–æ–Ω–∏–º–∞–Ω–∏–µ)",
            "adherence_marker": "user_identifies_alienator_motives"
        },

        "stage_2_own_motives": {
            "timing": "PHASE_2, session 9",
            "prompt": """
            –ê —Ç–µ–ø–µ—Ä—å —Å–ª–æ–∂–Ω–∞—è —á–∞—Å—Ç—å: –¥–∞–≤–∞–π—Ç–µ —á–µ—Å—Ç–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –í–ê–®–ò –º–æ—Ç–∏–≤—ã.

            –£ –æ—Ç—á—É–∂–¥–∞–µ–º—ã—Ö —Ä–æ–¥–∏—Ç–µ–ª–µ–π —Ç–æ–∂–µ –µ—Å—Ç—å –∏—Ä—Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –¥—Ä–∞–π–≤–µ—Ä—ã:

            1. **–ë–æ–ª—å –∏ —É—Ç—Ä–∞—Ç–∞** (–ª–µ–≥–∏—Ç–∏–º–Ω–∞—è, –Ω–æ –º–æ–∂–µ—Ç –≤–µ—Å—Ç–∏ –∫ –¥–µ—Å—Ç—Ä—É–∫—Ü–∏–∏)
            2. **–°—Ç—Ä–∞—Ö –±—ã—Ç—å –∑–∞–±—ã—Ç—ã–º** (10 –∑–≤–æ–Ω–∫–æ–≤ –≤ –¥–µ–Ω—å, –Ω–∞–≤—è–∑—á–∏–≤–æ—Å—Ç—å)
            3. **–ì–Ω–µ–≤ –∏ –∂–µ–ª–∞–Ω–∏–µ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç–∏** (–º–µ—Å—Ç—å alienator)
            4. **–ë–µ—Å—Å–∏–ª–∏–µ** (–∫–∞–ø–∏—Ç—É–ª—è—Ü–∏—è –∏–ª–∏ –ø–∞–Ω–∏–∫–∞)
            5. **–í–∏–Ω–∞** ('–≠—Ç–æ –º–æ—è –≤–∏–Ω–∞')
            6. **–ù–∞–¥–µ–∂–¥–∞-—Ñ–∏–∫—Å–∞—Ü–∏—è** ('–í–µ—Ä–Ω—É—Ç—å –≤—Å–µ –∫–∞–∫ –±—ã–ª–æ')

            –ß–µ—Å—Ç–Ω–æ: –∫–∞–∫–∏–µ –∏–∑ —ç—Ç–∏—Ö –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –≤—ã —á—É–≤—Å—Ç–≤—É–µ—Ç–µ? –ö–∞–∫–∏–µ –º–µ—à–∞—é—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º –¥–µ–π—Å—Ç–≤–∏—è–º?
            """,
            "goal": "–°–∞–º–æ—Å–æ–∑–Ω–∞–Ω–∏–µ, –Ω–µ —Å–∞–º–æ–±–∏—á–µ–≤–∞–Ω–∏–µ",
            "guardrails": "–ù–ï –∫—Ä–∏—Ç–∏–∫–æ–≤–∞—Ç—å, –∞ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å + guide –∫ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–º –æ—Ç–≤–µ—Ç–∞–º",
            "adherence_marker": "user_demonstrates_self_awareness"
        },

        "stage_3_adaptive_responses": {
            "timing": "PHASE_2, session 10",
            "prompt": """
            –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∏—Ä—Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –º–æ—Ç–∏–≤–∞ –µ—Å—Ç—å –ê–î–ê–ü–¢–ò–í–ù–´–ô –æ—Ç–≤–µ—Ç:

            ‚ùå –°—Ç—Ä–∞—Ö –±—ã—Ç—å –∑–∞–±—ã—Ç—ã–º -> –ö–æ–º–ø—É–ª—å—Å–∏–≤–Ω—ã–µ –∑–≤–æ–Ω–∫–∏
            ‚úÖ Adaptive: Trust the bond. –ö–∞—á–µ—Å—Ç–≤–æ > –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ.

            ‚ùå –ì–Ω–µ–≤ -> –ú–µ—Å—Ç—å, —Ç—Ä–∞–≤–ª—è
            ‚úÖ Adaptive: –§–æ–∫—É—Å –Ω–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ, –Ω–µ –Ω–∞–∫–∞–∑–∞–Ω–∏–µ.

            ‚ùå –í–∏–Ω–∞ -> –°–∞–º–æ–±–∏—á–µ–≤–∞–Ω–∏–µ
            ‚úÖ Adaptive: CBT reframing. –í—ã –Ω–µ –≤–∏–Ω–æ–≤–∞—Ç—ã –≤ PA.

            –î–∞–≤–∞–π—Ç–µ –¥–ª—è –í–ê–®–ò–• –º–æ—Ç–∏–≤–æ–≤ –Ω–∞–π–¥–µ–º –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏.
            """,
            "integration": "IP-04 techniques (CBT, IFS, NVC)",
            "adherence_marker": "user_adopts_adaptive_responses"
        }
    },

    "profilestore_integration": {
        "fields_to_add": {
            "ex_partner_motives_identified": "List[str] (—Å—Ç—Ä–∞—Ö –∫–æ–Ω—Ç—Ä–æ–ª—è, –º–µ—Å—Ç—å, etc.)",
            "own_irrational_motives": "List[str] (–±–æ–ª—å, —Å—Ç—Ä–∞—Ö –∑–∞–±—ã—Ç–∏—è, etc.)",
            "adaptive_strategies_adopted": "List[str] (trust bond, focus restoration, etc.)"
        },
        "usage": "StrategyEngine –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–Ω—Ç–µ—Ä–≤–µ–Ω—Ü–∏–π"
    },

    "success_metrics": {
        "empathy_toward_alienator": "User –º–æ–∂–µ—Ç –æ–±—ä—è—Å–Ω–∏—Ç—å –º–æ—Ç–∏–≤—ã ex-partner –±–µ–∑ –¥–µ–º–æ–Ω–∏–∑–∞—Ü–∏–∏",
        "self_awareness": "User recognizes own destructive patterns",
        "behavioral_change": "Reduction –≤ compulsive contact attempts, revenge actions"
    }
}

# Psychoeducation Module: Co-Parenting vs Parallel Parenting

COPARENTING_STRATEGIES_MODULE = {
    "name": "–ö–û-–ü–ê–†–ï–ù–¢–ò–ù–ì vs –ü–ê–†–ê–õ–õ–ï–õ–¨–ù–û–ï –†–û–î–ò–¢–ï–õ–¨–°–¢–í–û",
    "source": "–ë—Ä–æ—à—é—Ä–∞ –Æ–ª–∏–∏ –ö–æ–≤–∞–ª—ë–≤–æ–π + High Conflict Institute research",
    "timing": "PHASE_2_UNDERSTANDING, sessions 11-12 OR PHASE_3_ACTION (depends on user readiness)",
    "rationale": "StrategyEngine –¥–æ–ª–∂–µ–Ω —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å ex-partner –Ω–∞ –æ—Å–Ω–æ–≤–µ co_parenting_type –∏–∑ ProfileStore. –ù–ï –≤—Å–µ —Å–∏—Ç—É–∞—Ü–∏–∏ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è –∫–æ–æ–ø–µ—Ä–∞—Ü–∏–∏.",

    "co_parenting_definition": {
        "name": "–ö–û-–ü–ê–†–ï–ù–¢–ò–ù–ì (Cooperative Co-Parenting)",
        "description": "–°–æ–≤–º–µ—Å—Ç–Ω–æ–µ —Ä–æ–¥–∏—Ç–µ–ª—å—Å—Ç–≤–æ —Å –∫–æ–æ–ø–µ—Ä–∞—Ü–∏–µ–π, –æ–±—â–µ–Ω–∏–µ–º –∏ —Å–æ–≤–º–µ—Å—Ç–Ω—ã–º–∏ —Ä–µ—à–µ–Ω–∏—è–º–∏",
        "suitable_when": [
            "–ù–∏–∑–∫–∏–π/—Å—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ –º–µ–∂–¥—É —Ä–æ–¥–∏—Ç–µ–ª—è–º–∏",
            "–û–±–∞ —Ä–æ–¥–∏—Ç–µ–ª—è —Å–ø–æ—Å–æ–±–Ω—ã —Å—Ç–∞–≤–∏—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å—ã —Ä–µ–±–µ–Ω–∫–∞ –≤—ã—à–µ –ª–∏—á–Ω—ã—Ö –æ–±–∏–¥",
            "–ù–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏ –Ω–∞—Å–∏–ª–∏—è –∏–ª–∏ —Å–µ—Ä—å–µ–∑–Ω–æ–≥–æ –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è",
            "–†–æ–¥–∏—Ç–µ–ª–∏ –º–æ–≥—É—Ç –æ–±—â–∞—Ç—å—Å—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ (—Ö–æ—Ç—è –±—ã —á–µ—Ä–µ–∑ –ø–∏—Å—å–º–∞)"
        ],
        "characteristics": {
            "communication": "–†–µ–≥—É–ª—è—Ä–Ω–∞—è, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –Ω–∞ —Ä–µ–±–µ–Ω–∫–∞",
            "decisions": "–°–æ–≤–º–µ—Å—Ç–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –ø–æ –≤–∞–∂–Ω—ã–º –≤–æ–ø—Ä–æ—Å–∞–º (—à–∫–æ–ª–∞, –∑–¥–æ—Ä–æ–≤—å–µ, —Ä–µ–ª–∏–≥–∏—è)",
            "flexibility": "–ì–∏–±–∫–∏–π –≥—Ä–∞—Ñ–∏–∫ –≤—Å—Ç—Ä–µ—á, –≤–æ–∑–º–æ–∂–Ω–∞ —Å–º–µ–Ω–∞ –ø–ª–∞–Ω–æ–≤ –ø–æ –¥–æ–≥–æ–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏",
            "events": "–û–±–∞ —Ä–æ–¥–∏—Ç–µ–ª—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –Ω–∞ —à–∫–æ–ª—å–Ω—ã—Ö/—Å–ø–æ—Ä—Ç–∏–≤–Ω—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è—Ö",
            "information_sharing": "–ê–∫—Ç–∏–≤–Ω—ã–π –æ–±–º–µ–Ω –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ä–µ–±–µ–Ω–∫–µ"
        },
        "tools_and_techniques": [
            "–°–æ–≤–º–µ—Å—Ç–Ω—ã–µ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –≤—Å—Ç—Ä–µ—á–∏ (—Ä–∞–∑ –≤ –º–µ—Å—è—Ü)",
            "–û–±—â–∏–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å (Google Calendar) –¥–ª—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è —Ä–µ–±–µ–Ω–∫–∞",
            "–†–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ (parenting plan) —Å –¥–µ—Ç–∞–ª—è–º–∏",
            "–°–µ–º–µ–π–Ω–∞—è –º–µ–¥–∏–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —Å–ø–æ—Ä–æ–≤",
            "NVC –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤"
        ],
        "example_interaction": {
            "scenario": "–†–µ–±–µ–Ω–æ–∫ –∑–∞–±–æ–ª–µ–ª –≤–æ –≤—Ä–µ–º—è –Ω–µ–¥–µ–ª–∏ —Å targeted parent",
            "co_parenting_response": "–ü–æ–∑–≤–æ–Ω–∏—Ç—å ex-partner: '–£ [–∏–º—è] —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ 38. –í–µ–¥—É –∫ –≤—Ä–∞—á—É. –î–µ—Ä–∂—É —Ç–µ–±—è –≤ –∫—É—Ä—Å–µ.' -> –ü–æ—Å–ª–µ –≤–∏–∑–∏—Ç–∞: '–í—Ä–∞—á —Å–∫–∞–∑–∞–ª –û–†–í–ò, –ø—Ä–æ–ø–∏—Å–∞–ª [–ª–µ–∫–∞—Ä—Å—Ç–≤–æ]. –í–æ—Ç —Ä–µ—Ü–µ–ø—Ç (—Ñ–æ—Ç–æ). –î–∞–≤–∞–π –≤–º–µ—Å—Ç–µ —Å–ª–µ–¥–∏—Ç—å.'"
        }
    },

    "parallel_parenting_definition": {
        "name": "–ü–ê–†–ê–õ–õ–ï–õ–¨–ù–û–ï –†–û–î–ò–¢–ï–õ–¨–°–¢–í–û (Parallel Parenting)",
        "description": "–†–æ–¥–∏—Ç–µ–ª–∏ –¥–µ–π—Å—Ç–≤—É—é—Ç –∞–≤—Ç–æ–Ω–æ–º–Ω–æ, –º–∏–Ω–∏–º–∏–∑–∏—Ä—É—è –∫–æ–Ω—Ç–∞–∫—Ç, –∫–∞–∂–¥—ã–π –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Å–≤–æ–µ –≤—Ä–µ–º—è —Å —Ä–µ–±–µ–Ω–∫–æ–º",
        "suitable_when": [
            "–í–´–°–û–ö–ò–ô —É—Ä–æ–≤–µ–Ω—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ (–≤ —Ç.—á. PA —Å–∏—Ç—É–∞—Ü–∏–∏)",
            "–û–¥–∏–Ω –∏–ª–∏ –æ–±–∞ —Ä–æ–¥–∏—Ç–µ–ª—è –Ω–µ —Å–ø–æ—Å–æ–±–Ω—ã –∫–æ–æ–ø–µ—Ä–∏—Ä–æ–≤–∞—Ç—å",
            "–ò—Å—Ç–æ—Ä–∏—è –Ω–∞—Å–∏–ª–∏—è, –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–π, –∏–ª–∏ —Å—É–¥–µ–±–Ω—ã—Ö –±–∞—Ç–∞–ª–∏–π",
            "–õ—é–±–æ–µ –æ–±—â–µ–Ω–∏–µ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —ç—Å–∫–∞–ª–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞",
            "–î–ª—è –∑–∞—â–∏—Ç—ã —Ä–µ–±–µ–Ω–∫–∞ –æ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ –º–µ–∂–¥—É —Ä–æ–¥–∏—Ç–µ–ª—è–º–∏"
        ],
        "characteristics": {
            "communication": "–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è, –¢–û–õ–¨–ö–û –æ —Ä–µ–±–µ–Ω–∫–µ, –ø–∏—Å—å–º–µ–Ω–Ω–∞—è (email/SMS), BIFF-—Ñ–æ—Ä–º–∞—Ç",
            "decisions": "–ê–≤—Ç–æ–Ω–æ–º–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –≤ —Ä–∞–º–∫–∞—Ö —Å–≤–æ–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏; —Å–æ–≤–º–µ—Å—Ç–Ω—ã–µ - —Ç–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ (–∑–¥–æ—Ä–æ–≤—å–µ, –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ) —á–µ—Ä–µ–∑ —é—Ä–∏—Å—Ç–æ–≤/–º–µ–¥–∏–∞—Ç–æ—Ä–∞",
            "flexibility": "–ñ–ï–°–¢–ö–ò–ô –≥—Ä–∞—Ñ–∏–∫ –≤—Å—Ç—Ä–µ—á, –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –±–µ–∑ —Ñ–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Å–æ–≥–ª–∞—Å–∏—è",
            "events": "–†–æ–¥–∏—Ç–µ–ª–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –†–ê–ó–î–ï–õ–¨–ù–û (—Ä–∞–∑–Ω—ã–µ —Å–ø–æ—Ä—Ç. –∏–≥—Ä—ã, —à–∫–æ–ª—å–Ω—ã–µ –≤—Å—Ç—Ä–µ—á–∏ –ø–æ –æ—á–µ—Ä–µ–¥–∏)",
            "information_sharing": "–ß–µ—Ä–µ–∑ —Ç—Ä–µ—Ç—å–∏—Ö –ª–∏—Ü (—à–∫–æ–ª–∞, –≤—Ä–∞—á –æ—Ç—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –æ–±–æ–∏–º), –Ω–µ –Ω–∞–ø—Ä—è–º—É—é"
        },
        "tools_and_techniques": [
            "BIFF communication (Brief, Informative, Friendly, Firm)",
            "Email-only contact (no phone calls, –∏–∑–±–µ–≥–∞—Ç—å –∂–∏–≤—ã—Ö –≤—Å—Ç—Ä–µ—á)",
            "–ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ (–º–∞–∫—Å–∏–º—É–º –¥–µ—Ç–∞–ª–µ–π, –º–∏–Ω–∏–º—É–º –≥–∏–±–∫–æ—Å—Ç–∏)",
            "–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ –ø–µ—Ä–µ–¥–∞—á–∏ —Ä–µ–±–µ–Ω–∫–∞ (—à–∫–æ–ª–∞, –ø—É–±–ª–∏—á–Ω–æ–µ –º–µ—Å—Ç–æ)",
            "–ü—Ä–∞–≤–∏–ª–æ '–∫–∞–∂–¥—ã–π —Å–∞–º' (–æ–¥–µ–∂–¥–∞, –∏–≥—Ä—É—à–∫–∏, –ª–µ–∫–∞—Ä—Å—Ç–≤–∞ –≤ –¥–≤—É—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–∞—Ö)",
            "OurFamilyWizard –∏–ª–∏ –ø–æ–¥–æ–±–Ω—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏"
        ],
        "example_interaction": {
            "scenario": "–†–µ–±–µ–Ω–æ–∫ –∑–∞–±–æ–ª–µ–ª –≤–æ –≤—Ä–µ–º—è –Ω–µ–¥–µ–ª–∏ —Å targeted parent",
            "parallel_parenting_response": "Email (BIFF): '–£ [–∏–º—è] —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ 38, –≤–µ–¥—É –∫ –≤—Ä–∞—á—É. –°–æ–æ–±—â—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç.' -> –ü–æ—Å–ª–µ: '–î–∏–∞–≥–Ω–æ–∑ –û–†–í–ò, –ø—Ä–æ–ø–∏—Å–∞–Ω–æ [–ª–µ–∫–∞—Ä—Å—Ç–≤–æ]. –ö–æ–ø–∏—è —Ä–µ—Ü–µ–ø—Ç–∞ –≤–æ –≤–ª–æ–∂–µ–Ω–∏–∏. [–ò–º—è] –æ—Å—Ç–∞–Ω–µ—Ç—Å—è —Å–æ –º–Ω–æ–π –¥–æ –≤—ã–∑–¥–æ—Ä–æ–≤–ª–µ–Ω–∏—è —Å–æ–≥–ª–∞—Å–Ω–æ –≥—Ä–∞—Ñ–∏–∫—É.'"
        },
        "boundary_rules": [
            "–ù–ï –æ–±—Å—É–∂–¥–∞—Ç—å –ª–∏—á–Ω—ã–µ —Ç–µ–º—ã (–Ω–æ–≤—ã–µ –ø–∞—Ä—Ç–Ω–µ—Ä—ã, —Ñ–∏–Ω–∞–Ω—Å—ã, –ø—Ä–æ—à–ª–æ–µ)",
            "–ù–ï –∫—Ä–∏—Ç–∏–∫–æ–≤–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è –¥—Ä—É–≥–æ–≥–æ —Ä–æ–¥–∏—Ç–µ–ª—è",
            "–ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–±–µ–Ω–∫–∞ –∫–∞–∫ –ø–æ—Å—ã–ª—å–Ω–æ–≥–æ",
            "–ù–ï —Å–ø—Ä–∞—à–∏–≤–∞—Ç—å —Ä–µ–±–µ–Ω–∫–∞ –æ –∂–∏–∑–Ω–∏ –¥—Ä—É–≥–æ–≥–æ —Ä–æ–¥–∏—Ç–µ–ª—è",
            "–£–≤–∞–∂–∞—Ç—å –∞–≤—Ç–æ–Ω–æ–º–∏—é –¥—Ä—É–≥–æ–≥–æ —Ä–æ–¥–∏—Ç–µ–ª—è –≤ –µ–≥–æ –≤—Ä–µ–º—è"
        ]
    },

    "decision_tree_for_strategy_engine": {
        "description": "StrategyEngine –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ProfileStore.co_parenting_type –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π",
        "logic": """
        IF ProfileStore.co_parenting_type == 'high_conflict':
            recommended_strategy = PARALLEL_PARENTING
            communication_style = BIFF_only
            recommend_mediation = False (—Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ, —Å–Ω–∞—á–∞–ª–∞ —Å–Ω–∏–∑–∏—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç)
            recommend_flexibility = False (–∂–µ—Å—Ç–∫–∏–π –≥—Ä–∞—Ñ–∏–∫ –∑–∞—â–∏—â–∞–µ—Ç)

        ELIF ProfileStore.co_parenting_type == 'cooperative':
            recommended_strategy = CO_PARENTING
            communication_style = NVC + direct_dialogue
            recommend_mediation = True (–¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤)
            recommend_flexibility = True (–≤ –∏–Ω—Ç–µ—Ä–µ—Å–∞—Ö —Ä–µ–±–µ–Ω–∫–∞)

        ELIF ProfileStore.co_parenting_type == 'parallel':
            recommended_strategy = PARALLEL_PARENTING
            communication_style = BIFF_written_only
            recommend_mediation = False (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —é—Ä–∏—Å—Ç–æ–≤ –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π)
            recommend_flexibility = False

        ELIF ProfileStore.co_parenting_type == 'none' (no contact):
            recommended_strategy = DOCUMENT_EFFORTS
            communication_style = one_way_letters (no response expected)
            recommend_mediation = False
            recommend_flexibility = N/A
        """
    },

    "transition_between_strategies": {
        "from_parallel_to_cooperative": {
            "conditions": [
                "Conflict —Å–Ω–∏–∑–∏–ª—Å—è –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ (6+ –º–µ—Å—è—Ü–µ–≤ –±–µ–∑ —ç—Å–∫–∞–ª–∞—Ü–∏–π)",
                "–û–±–∞ —Ä–æ–¥–∏—Ç–µ–ª—è –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫–æ–æ–ø–µ—Ä–∏—Ä–æ–≤–∞—Ç—å",
                "–†–µ–±–µ–Ω–æ–∫ –≤—ã–∏–≥—Ä—ã–≤–∞–µ—Ç –æ—Ç –±–æ–ª—å—à–µ–π –≥–∏–±–∫–æ—Å—Ç–∏"
            ],
            "steps": [
                "–ù–∞—á–∞—Ç—å —Å –º–∞–ª–æ–≥–æ: 1-2 –≥–∏–±–∫–∏—Ö –º–æ–º–µ–Ω—Ç–∞ –≤ –º–µ—Å—è—Ü",
                "–ü—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥ (3 –º–µ—Å—è—Ü–∞)",
                "–ï—Å–ª–∏ —É—Å–ø–µ—à–Ω–æ -> –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å –∫–æ–æ–ø–µ—Ä–∞—Ü–∏—é",
                "–ï—Å–ª–∏ escalation -> –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ parallel"
            ]
        },
        "from_cooperative_to_parallel": {
            "triggers": [
                "–≠—Å–∫–∞–ª–∞—Ü–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ (3+ —Å–µ—Ä—å–µ–∑–Ω—ã—Ö –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞ –∑–∞ –º–µ—Å—è—Ü)",
                "–ú–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏/–Ω–∞—Ä—É—à–µ–Ω–∏–µ boundaries",
                "–†–µ–±–µ–Ω–æ–∫ —Å—Ç—Ä–∞–¥–∞–µ—Ç –æ—Ç —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏—Ö —Å—Å–æ—Ä"
            ],
            "steps": [
                "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å BIFF-only communication",
                "–§–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫ (–ø–∏—Å—å–º–µ–Ω–Ω–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ)",
                "–ò–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —à–∫–æ–ª—É/–≤—Ä–∞—á–µ–π –æ —Ä–∞–∑–¥–µ–ª—å–Ω–æ–º –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–∏",
                "–û–±—ä—è—Å–Ω–∏—Ç—å —Ä–µ–±–µ–Ω–∫—É (age-appropriate): '–ú—ã –±—É–¥–µ–º –æ–±—â–∞—Ç—å—Å—è –ø–æ-–¥—Ä—É–≥–æ–º—É, —á—Ç–æ–±—ã –º–µ–Ω—å—à–µ —Å—Å–æ—Ä–∏—Ç—å—Å—è'"
            ]
        }
    },

    "profilestore_integration": {
        "field": "family_context.co_parenting_type",
        "values": ["cooperative", "parallel", "high_conflict", "none"],
        "onboarding_question": "–ö–∞–∫ –±—ã –≤—ã –æ–ø–∏—Å–∞–ª–∏ –æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å –±—ã–≤—à–∏–º –ø–∞—Ä—Ç–Ω–µ—Ä–æ–º —Å–µ–π—á–∞—Å?",
        "options": [
            "–ú—ã –º–æ–∂–µ–º –æ–±—â–∞—Ç—å—Å—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ -> cooperative",
            "–ú—ã –æ–±—â–∞–µ–º—Å—è —Ç–æ–ª—å–∫–æ –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏, –ø–∏—Å—å–º–µ–Ω–Ω–æ -> parallel",
            "–õ—é–±–æ–µ –æ–±—â–µ–Ω–∏–µ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É -> high_conflict",
            "–ö–æ–Ω—Ç–∞–∫—Ç–∞ –Ω–µ—Ç —Å–æ–≤—Å–µ–º -> none"
        ],
        "strategy_engine_usage": "–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ –∏ –¥–µ–π—Å—Ç–≤–∏—è–º"
    }
}

# Psychoeducation Module: –ú–µ–¥–∏–∞—Ü–∏—è

MEDIATION_MODULE = {
    "name": "–ú–ï–î–ò–ê–¶–ò–Ø –ö–ê–ö –ò–ù–°–¢–†–£–ú–ï–ù–¢ –†–ê–ó–†–ï–®–ï–ù–ò–Ø –°–ü–û–†–û–í",
    "source": "–ë—Ä–æ—à—é—Ä–∞ –Æ–ª–∏–∏ –ö–æ–≤–∞–ª—ë–≤–æ–π + –ø—Ä–∞–∫—Ç–∏–∫–∞ —Å–µ–º–µ–π–Ω–æ–π –º–µ–¥–∏–∞—Ü–∏–∏",
    "timing": "PHASE_2_UNDERSTANDING (psychoeducation) OR PHASE_3_ACTION (when considering mediation)",
    "rationale": "–ú–µ–¥–∏–∞—Ü–∏—è - –ù–ï —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ. –í PA-—Å–∏—Ç—É–∞—Ü–∏—è—Ö —á–∞—Å—Ç–æ –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞ –∏–ª–∏ –æ–ø–∞—Å–Ω–∞. User –¥–æ–ª–∂–µ–Ω –ø–æ–Ω–∏–º–∞—Ç—å –∫–æ–≥–¥–∞ –º–µ–¥–∏–∞—Ü–∏—è –ø–æ–¥—Ö–æ–¥–∏—Ç, –∞ –∫–æ–≥–¥–∞ –Ω–µ—Ç.",

    "mediation_definition": {
        "what_is_it": "–ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ —Å —É—á–∞—Å—Ç–∏–µ–º –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ–≥–æ —Ç—Ä–µ—Ç—å–µ–≥–æ –ª–∏—Ü–∞ (–º–µ–¥–∏–∞—Ç–æ—Ä–∞), –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–≥–∞–µ—Ç —Ä–æ–¥–∏—Ç–µ–ª—è–º –Ω–∞–π—Ç–∏ —Ä–µ—à–µ–Ω–∏–µ",
        "not_therapy": "–ú–µ–¥–∏–∞—Ü–∏—è - –Ω–µ —Ç–µ—Ä–∞–ø–∏—è. –¶–µ–ª—å: –¥–æ–≥–æ–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç—å, –Ω–µ –∏—Å—Ü–µ–ª–µ–Ω–∏–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–π",
        "not_court": "–ú–µ–¥–∏–∞—Ü–∏—è - –Ω–µ —Å—É–¥. –†–µ—à–µ–Ω–∏–µ –¥–æ–±—Ä–æ–≤–æ–ª—å–Ω–æ–µ, –Ω–µ –Ω–∞–≤—è–∑–∞–Ω–Ω–æ–µ"
    },

    "principles_of_mediation": {
        "neutrality": "–ú–µ–¥–∏–∞—Ç–æ—Ä –ù–ï –Ω–∞ —á—å–µ–π-—Ç–æ —Å—Ç–æ—Ä–æ–Ω–µ, –Ω–µ —Å—É–¥—å—è",
        "confidentiality": "–í—Å–µ —Å–∫–∞–∑–∞–Ω–Ω–æ–µ –≤ –º–µ–¥–∏–∞—Ü–∏–∏ –æ—Å—Ç–∞–µ—Ç—Å—è –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º (–∫—Ä–æ–º–µ duty to warn —Å–∏—Ç—É–∞—Ü–∏–π)",
        "voluntariness": "–£—á–∞—Å—Ç–∏–µ –¥–æ–±—Ä–æ–≤–æ–ª—å–Ω–æ–µ, –º–æ–∂–Ω–æ –≤—ã–π—Ç–∏ –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç",
        "focus_on_interests_not_positions": "–†–∞–±–æ—Ç–∞ —Å –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—è–º–∏ ('–ú–Ω–µ –≤–∞–∂–Ω–∞ —Å–≤—è–∑—å —Å —Ä–µ–±–µ–Ω–∫–æ–º'), –Ω–µ –ø–æ–∑–∏—Ü–∏—è–º–∏ ('–Ø —Ö–æ—á—É 50% –≤—Ä–µ–º–µ–Ω–∏')"
    },

    "stages_of_mediation": {
        "stage_1_preparation": {
            "description": "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –º–µ–¥–∏–∞—Ü–∏–∏",
            "steps": [
                "–í—ã–±–æ—Ä –º–µ–¥–∏–∞—Ç–æ—Ä–∞ (–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—â–µ–≥–æ—Å—è –Ω–∞ PA)",
                "–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –≤—Å—Ç—Ä–µ—á–∏ –º–µ–¥–∏–∞—Ç–æ—Ä–∞ —Å –∫–∞–∂–¥—ã–º —Ä–æ–¥–∏—Ç–µ–ª–µ–º",
                "–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–≤–µ—Å—Ç–∫–∏ –¥–Ω—è",
                "–ü–æ–¥–ø–∏—Å–∞–Ω–∏–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏—è –æ –º–µ–¥–∏–∞—Ü–∏–∏"
            ]
        },
        "stage_2_exploration": {
            "description": "–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã",
            "steps": [
                "–ö–∞–∂–¥—ã–π —Ä–æ–¥–∏—Ç–µ–ª—å –∏–∑–ª–∞–≥–∞–µ—Ç —Å–≤–æ—é –ø–æ–∑–∏—Ü–∏—é",
                "–ú–µ–¥–∏–∞—Ç–æ—Ä –≤—ã—è–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å—ã –∏ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏",
                "–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–±—â–∏—Ö —Ü–µ–ª–µ–π ('–û–±–∞ —Ö–æ—Ç–∏–º —Å—á–∞—Å—Ç—å—è —Ä–µ–±–µ–Ω–∫–∞')",
                "–í—ã—è–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π"
            ]
        },
        "stage_3_solution_finding": {
            "description": "–ü–æ–∏—Å–∫ —Ä–µ—à–µ–Ω–∏–π",
            "steps": [
                "Brainstorming –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ (–±–µ–∑ –æ—Ü–µ–Ω–∫–∏ —Å–Ω–∞—á–∞–ª–∞)",
                "–û—Ü–µ–Ω–∫–∞ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –ø–æ –∫—Ä–∏—Ç–µ—Ä–∏—è–º (–∏–Ω—Ç–µ—Ä–µ—Å—ã —Ä–µ–±–µ–Ω–∫–∞, —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç—å, etc.)",
                "–í—ã–±–æ—Ä –ª—É—á—à–µ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞",
                "–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –¥–æ–≥–æ–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–µ–π"
            ]
        },
        "stage_4_agreement": {
            "description": "–°–æ–≥–ª–∞—à–µ–Ω–∏–µ",
            "steps": [
                "–ü–∏—Å—å–º–µ–Ω–Ω–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–µ–π",
                "–ü—Ä–æ–≤–µ—Ä–∫–∞ —é—Ä–∏—Å—Ç–∞–º–∏ (–º–µ–¥–∏–∞—Ü–∏—è - –Ω–µ —é—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è)",
                "–ü–æ–¥–ø–∏—Å–∞–Ω–∏–µ",
                "–ü–ª–∞–Ω –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞"
            ]
        }
    },

    "when_mediation_is_suitable": {
        "conditions": [
            "–û–±–∞ —Ä–æ–¥–∏—Ç–µ–ª—è –î–û–ë–†–û–í–û–õ–¨–ù–û —Å–æ–≥–ª–∞—Å–Ω—ã —É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å",
            "–ù–ï–¢ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –Ω–∞—Å–∏–ª–∏—è –∏–ª–∏ —É–≥—Ä–æ–∑—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏",
            "–†–æ–¥–∏—Ç–µ–ª–∏ —Å–ø–æ—Å–æ–±–Ω—ã —Å–∏–¥–µ—Ç—å –≤ –æ–¥–Ω–æ–π –∫–æ–º–Ω–∞—Ç–µ –∏ —Å–ª—É—à–∞—Ç—å –¥—Ä—É–≥ –¥—Ä—É–≥–∞",
            "–ï—Å—Ç—å —Ö–æ—Ç—è –±—ã –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∏–¥—Ç–∏ –Ω–∞ –∫–æ–º–ø—Ä–æ–º–∏—Å—Å",
            "–°–ø–æ—Ä–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã (–≥—Ä–∞—Ñ–∏–∫ –≤—Å—Ç—Ä–µ—á, —à–∫–æ–ª–∞, –ø—Ä–∞–∑–¥–Ω–∏–∫–∏)",
            "–î–∏—Å–±–∞–ª–∞–Ω—Å –≤–ª–∞—Å—Ç–∏ –Ω–µ –∫—Ä–∏—Ç–∏—á–µ–Ω (–∏–ª–∏ –º–µ–¥–∏–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –µ–≥–æ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞—Ç—å)"
        ],
        "ideal_scenarios": [
            "Cooperative co-parenting —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º —Å–ø–æ—Ä–æ–º",
            "Transition –æ—Ç parallel –∫ cooperative (–º–µ–¥–∏–∞—Ü–∏—è –∫–∞–∫ –º–æ—Å—Ç)",
            "–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ parenting plan",
            "–ö–æ–Ω—Ñ–ª–∏–∫—Ç –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –≤–æ–ø—Ä–æ—Å—É (—à–∫–æ–ª–∞, –ø–µ—Ä–µ–µ–∑–¥)"
        ]
    },

    "when_mediation_is_NOT_suitable": {
        "red_flags": [
            "–ò—Å—Ç–æ—Ä–∏—è –¥–æ–º–∞—à–Ω–µ–≥–æ –Ω–∞—Å–∏–ª–∏—è (–º–µ–¥–∏–∞—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–ø–∞—Å–Ω–∞)",
            "–ê–∫—Ç–∏–≤–Ω–æ–µ PA —Å –æ—Ç—Ä–∏—Ü–∞–Ω–∏–µ–º —Ñ–∞–∫—Ç–æ–≤ alienator'–æ–º",
            "–û–¥–∏–Ω —Ä–æ–¥–∏—Ç–µ–ª—å –æ—Ç–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏–∑–Ω–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—É",
            "Extreme power imbalance (–æ–¥–∏–Ω —Ä–æ–¥–∏—Ç–µ–ª—å –¥–æ–º–∏–Ω–∏—Ä—É–µ—Ç, –¥—Ä—É–≥–æ–π –≤ —Å—Ç—Ä–∞—Ö–µ)",
            "Personality disorder —É –æ–¥–Ω–æ–≥–æ —Ä–æ–¥–∏—Ç–µ–ª—è (–Ω–∞—Ä—Ü–∏—Å—Å–∏–∑–º, borderline) –±–µ–∑ –ª–µ—á–µ–Ω–∏—è",
            "–û–¥–∏–Ω —Ä–æ–¥–∏—Ç–µ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ–¥–∏–∞—Ü–∏—é –∫–∞–∫ –º–∞–Ω–∏–ø—É–ª—è—Ü–∏—é ('–Ø –ø–æ—à–µ–ª –Ω–∞ –º–µ–¥–∏–∞—Ü–∏—é, –∑–Ω–∞—á–∏—Ç —è cooperative' - –Ω–æ —Å–∞–±–æ—Ç–∏—Ä—É–µ—Ç)",
            "–ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –∑–∞—â–∏—Ç–Ω—ã—Ö legal –º–µ—Ä (restraining order, custody change)"
        ],
        "PA_specific_risks": [
            "Alienator –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ–¥–∏–∞—Ü–∏—é –¥–ª—è —Å–±–æ—Ä–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ targeted parent",
            "Alienator –º–æ–∂–µ—Ç '—Å–æ–≥–ª–∞—à–∞—Ç—å—Å—è' –Ω–æ –Ω–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å (mediation –Ω–µ –∏–º–µ–µ—Ç enforcement)",
            "Targeted parent –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–Ω—É–∂–¥–µ–Ω –∫ unfair —Å–æ–≥–ª–∞—à–µ–Ω–∏—é –ø–æ–¥ –¥–∞–≤–ª–µ–Ω–∏–µ–º",
            "–†–µ–±–µ–Ω–æ–∫ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–æ–≤–ª–µ—á–µ–Ω –≤ –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ—Ç–∏–≤ –≤–æ–ª–∏"
        ]
    },

    "alternatives_to_mediation": {
        "shuttle_negotiation": {
            "description": "–ú–µ–¥–∏–∞—Ç–æ—Ä –æ–±—â–∞–µ—Ç—Å—è —Å –∫–∞–∂–¥—ã–º —Ä–æ–¥–∏—Ç–µ–ª–µ–º –û–¢–î–ï–õ–¨–ù–û, –ø–µ—Ä–µ–¥–∞–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è",
            "when": "–†–æ–¥–∏—Ç–µ–ª–∏ –Ω–µ –º–æ–≥—É—Ç —Å–∏–¥–µ—Ç—å –≤–º–µ—Å—Ç–µ, –Ω–æ –≥–æ—Ç–æ–≤—ã –∏—Å–∫–∞—Ç—å —Ä–µ—à–µ–Ω–∏–µ"
        },
        "arbitration": {
            "description": "–¢—Ä–µ—Ç—å—è —Å—Ç–æ—Ä–æ–Ω–∞ (–∞—Ä–±–∏—Ç—Ä) –≤—ã–Ω–æ—Å–∏—Ç –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û–ï —Ä–µ—à–µ–Ω–∏–µ –ø–æ—Å–ª–µ –≤—ã—Å–ª—É—à–∏–≤–∞–Ω–∏—è –æ–±–µ–∏—Ö —Å—Ç–æ—Ä–æ–Ω",
            "when": "–ù—É–∂–Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å, –º–µ–¥–∏–∞—Ü–∏—è –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∞"
        },
        "collaborative_divorce_process": {
            "description": "–ö–∞–∂–¥—ã–π —Ä–æ–¥–∏—Ç–µ–ª—å —Å —é—Ä–∏—Å—Ç–æ–º, –≤—Å–µ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≤–º–µ—Å—Ç–µ –¥–ª—è –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–æ–≤",
            "when": "–ù—É–∂–Ω–∞ legal —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ + –∫–æ–æ–ø–µ—Ä–∞—Ü–∏—è"
        },
        "court_litigation": {
            "description": "–°—É–¥–µ–±–Ω–æ–µ —Ä–∞–∑–±–∏—Ä–∞—Ç–µ–ª—å—Å—Ç–≤–æ",
            "when": "–í—Å–µ –¥—Ä—É–≥–∏–µ –º–µ—Ç–æ–¥—ã –ø—Ä–æ–≤–∞–ª–∏–ª–∏—Å—å, –Ω—É–∂–Ω–∞ –∑–∞—â–∏—Ç–∞ —á–µ—Ä–µ–∑ court order"
        },
        "family_therapy": {
            "description": "–¢–µ—Ä–∞–ø–∏—è –¥–ª—è –≤—Å–µ–π —Å–µ–º—å–∏ (–≤–∫–ª—é—á–∞—è —Ä–µ–±–µ–Ω–∫–∞)",
            "when": "–ù—É–∂–Ω–æ –∏—Å—Ü–µ–ª–µ–Ω–∏–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–π, –Ω–µ —Ç–æ–ª—å–∫–æ –¥–æ–≥–æ–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏"
        }
    },

    "strategy_engine_recommendations": {
        "logic": """
        IF ProfileStore.co_parenting_type == 'cooperative' AND user asks about mediation:
            response = '–ú–µ–¥–∏–∞—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å —Ö–æ—Ä–æ—à–∏–º –≤–∞—Ä–∏–∞–Ω—Ç–æ–º –¥–ª—è –≤–∞—Å. –í–æ—Ç –∫–∞–∫ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å—Å—è...'

        IF ProfileStore.co_parenting_type == 'high_conflict':
            IF violence_history == True:
                response = '–ú–µ–¥–∏–∞—Ü–∏—è –ù–ï —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤ –≤–∞—à–µ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –∏–∑-–∑–∞ –∏—Å—Ç–æ—Ä–∏–∏ –Ω–∞—Å–∏–ª–∏—è. –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –º–µ—Ä—ã.'
            ELSE:
                response = '–ú–µ–¥–∏–∞—Ü–∏—è –≤—Ä—è–¥ –ª–∏ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏ —Ç–∞–∫–æ–º —É—Ä–æ–≤–Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞. –°–Ω–∞—á–∞–ª–∞ —Å–Ω–∏–∑—å—Ç–µ —ç—Å–∫–∞–ª–∞—Ü–∏—é —á–µ—Ä–µ–∑ parallel parenting. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã: shuttle negotiation, –∞—Ä–±–∏—Ç—Ä–∞–∂.'

        IF user expresses 'alienator —Ç—Ä–µ–±—É–µ—Ç –º–µ–¥–∏–∞—Ü–∏–∏':
            response = '–ú–µ–¥–∏–∞—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –ª–æ–≤—É—à–∫–æ–π –ø—Ä–∏ PA. –ü—Ä–æ–∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä—É–π—Ç–µ—Å—å —Å —é—Ä–∏—Å—Ç–æ–º. Shuttle negotiation –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ.'
        """
    },

    "user_education_prompt": {
        "timing": "PHASE_2, session 13 OR when user asks",
        "content": """
        –ú–Ω–æ–≥–∏–µ –¥—É–º–∞—é—Ç —á—Ç–æ –º–µ–¥–∏–∞—Ü–∏—è - –≤—Å–µ–≥–¥–∞ —Ö–æ—Ä–æ—à–æ. –ù–æ –≤ —Å–∏—Ç—É–∞—Ü–∏—è—Ö PA —ç—Ç–æ –Ω–µ —Ç–∞–∫.

        **–ö–æ–≥–¥–∞ –º–µ–¥–∏–∞—Ü–∏—è –ú–û–ñ–ï–¢ –ø–æ–º–æ—á—å:**
        - –í—ã –æ–±–∞ –≥–æ—Ç–æ–≤—ã –∏—Å–∫–∞—Ç—å —Ä–µ—à–µ–Ω–∏–µ
        - –ù–µ—Ç –Ω–∞—Å–∏–ª–∏—è –∏–ª–∏ —É–≥—Ä–æ–∑
        - –ö–æ–Ω—Ñ–ª–∏–∫—Ç –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –≤–æ–ø—Ä–æ—Å—É

        **–ö–æ–≥–¥–∞ –º–µ–¥–∏–∞—Ü–∏—è –û–ü–ê–°–ù–ê:**
        - –ò—Å—Ç–æ—Ä–∏—è –Ω–∞—Å–∏–ª–∏—è
        - Alienator –æ—Ç—Ä–∏—Ü–∞–µ—Ç PA
        - Extreme power imbalance

        –í –≤–∞—à–µ–π —Å–∏—Ç—É–∞—Ü–∏–∏ (co_parenting_type = {user.co_parenting_type}):
        {personalized_recommendation}

        –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã: shuttle negotiation, –∞—Ä–±–∏—Ç—Ä–∞–∂, —Å—É–¥–µ–±–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å, —Å–µ–º–µ–π–Ω–∞—è —Ç–µ—Ä–∞–ø–∏—è.
        """
    }
}

# Psychoeducation Module: –†–æ–ª—å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π —Å–µ–º—å–∏

EXTENDED_FAMILY_MODULE = {
    "name": "–†–û–õ–¨ –†–û–î–°–¢–í–ï–ù–ù–ò–ö–û–í –í PA",
    "source": "–ë—Ä–æ—à—é—Ä–∞ –Æ–ª–∏–∏ –ö–æ–≤–∞–ª—ë–≤–æ–π",
    "timing": "PHASE_2_UNDERSTANDING, session 14 OR PHASE_3_ACTION (if issue arises)",
    "rationale": "Grandparents, —Ç–µ—Ç–∏/–¥—è–¥–∏, –Ω–æ–≤—ã–µ –ø–∞—Ä—Ç–Ω–µ—Ä—ã –º–æ–≥—É—Ç –£–°–ò–õ–ò–í–ê–¢–¨ –∏–ª–∏ –°–ù–ò–ñ–ê–¢–¨ PA. User –¥–æ–ª–∂–µ–Ω –ø–æ–Ω–∏–º–∞—Ç—å –¥–∏–Ω–∞–º–∏–∫—É –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –≤–ª–∏—è–Ω–∏–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π —Å–µ–º—å–∏.",

    "key_principle": {
        "statement": "–†–æ–¥–∏—Ç–µ–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –∫–ª—é—á–µ–≤—ã–º–∏ —Ñ–∏–≥—É—Ä–∞–º–∏. –†–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∏ - –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ä–æ–ª—å, –ù–ï –∑–∞–º–µ–Ω–∞.",
        "warning": "–†–µ–±–µ–Ω–æ–∫ –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å –†–û–î–ò–¢–ï–õ–Ø–ú–ò, –Ω–µ —Å –∏—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–µ–º"
    },

    "roles_of_extended_family": {
        "alienator_side_relatives": {
            "description": "–†–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∏ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã alienator (–±–∞–±—É—à–∫–∏/–¥–µ–¥—É—à–∫–∏ custodial parent)",
            "potential_positive_influence": [
                "–ú–æ–≥—É—Ç –±—ã—Ç—å '–≥–æ–ª–æ—Å–æ–º —Ä–∞–∑—É–º–∞' –¥–ª—è alienator",
                "–ú–æ–≥—É—Ç –∑–∞—â–∏—â–∞—Ç—å –ø—Ä–∞–≤–æ —Ä–µ–±–µ–Ω–∫–∞ –Ω–∞ –∫–æ–Ω—Ç–∞–∫—Ç —Å targeted parent",
                "–ú–æ–≥—É—Ç –ø—Ä–µ–¥–ª–∞–≥–∞—Ç—å –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—É—é —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—é –¥–ª—è –≤—Å—Ç—Ä–µ—á",
                "Emotional support –¥–ª—è —Ä–µ–±–µ–Ω–∫–∞ –≤ —Å–ª–æ–∂–Ω–æ–µ –≤—Ä–µ–º—è"
            ],
            "potential_negative_influence": [
                "–ú–æ–≥—É—Ç –£–°–ò–õ–ò–í–ê–¢–¨ alienation ('–¢–≤–æ–π –æ—Ç–µ—Ü/–º–∞—Ç—å –ø–ª–æ—Ö–æ–π')",
                "–ú–æ–≥—É—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å alienator –≤ –º–∞–Ω–∏–ø—É–ª—è—Ü–∏—è—Ö",
                "–ú–æ–≥—É—Ç –∑–∞–º–µ–Ω—è—Ç—å targeted parent ('–Ø —Ç–µ–±–µ –≤–º–µ—Å—Ç–æ –æ—Ç—Ü–∞/–º–∞—Ç–µ—Ä–∏')",
                "–ú–æ–≥—É—Ç —Å–∞–±–æ—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–∏–∑–∏—Ç—ã ('–ë–∞–±—É—à–∫–∞ —Å–∫–∞–∑–∞–ª–∞ –Ω–µ —Ö–æ–¥–∏—Ç—å –∫ –ø–∞–ø–µ')"
            ],
            "targeted_parent_strategy": [
                "–ü–æ–ø—ã—Ç–∞—Ç—å—Å—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä—è–º–æ–π –∫–æ–Ω—Ç–∞–∫—Ç —Å –∞–¥–µ–∫–≤–∞—Ç–Ω—ã–º–∏ —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞–º–∏",
                "–ü–∏—Å—å–º–æ –±–∞–±—É—à–∫–µ/–¥–µ–¥—É—à–∫–µ: '–ü—Ä–æ—à—É –ø–æ–º–æ—á—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–≤—è–∑—å [—Ä–µ–±–µ–Ω–∫–∞] —Å–æ –º–Ω–æ–π'",
                "–ù–ï –∫—Ä–∏—Ç–∏–∫–æ–≤–∞—Ç—å —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤ –ø—Ä–∏ —Ä–µ–±–µ–Ω–∫–µ",
                "–ü—Ä–∏–∑–Ω–∞—Ç—å –∏—Ö –≤–∞–∂–Ω–æ—Å—Ç—å –¥–ª—è —Ä–µ–±–µ–Ω–∫–∞"
            ]
        },

        "targeted_parent_side_relatives": {
            "description": "–†–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∏ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã targeted parent",
            "potential_positive_influence": [
                "Emotional support –¥–ª—è targeted parent",
                "–ú–æ–≥—É—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Å–≤—è–∑—å —Å —Ä–µ–±–µ–Ω–∫–æ–º (–µ—Å–ª–∏ –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø)",
                "–ú–æ–≥—É—Ç –±—ã—Ç—å —Å–≤–∏–¥–µ—Ç–µ–ª—è–º–∏ good parenting –¥–ª—è —Å—É–¥–∞",
                "–ú–æ–≥—É—Ç —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ –ø–æ–º–æ–≥–∞—Ç—å (—é—Ä–∏—Å—Ç—ã, —Ç–µ—Ä–∞–ø–∏—è)"
            ],
            "potential_negative_influence": [
                "–ú–æ–≥—É—Ç –£–°–ò–õ–ò–í–ê–¢–¨ –∫–æ–Ω—Ñ–ª–∏–∫—Ç ('–ü–æ–¥–∞–π –Ω–∞ –Ω–µ–µ –≤ —Å—É–¥!')",
                "–ú–æ–≥—É—Ç –∫—Ä–∏—Ç–∏–∫–æ–≤–∞—Ç—å alienator –ø—Ä–∏ —Ä–µ–±–µ–Ω–∫–µ",
                "–ú–æ–≥—É—Ç –¥–∞–≤–∞—Ç—å –ø–ª–æ—Ö–∏–µ —Å–æ–≤–µ—Ç—ã targeted parent",
                "–ú–æ–≥—É—Ç —Å–∞–±–æ—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–º–∏—Ä–µ–Ω–∏–µ ('–ù–µ –ø—Ä–æ—â–∞–π –µ–≥–æ/–µ–µ!')"
            ],
            "targeted_parent_strategy": [
                "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å boundaries: '–ù–µ –∫—Ä–∏—Ç–∏–∫—É–π—Ç–µ ex –ø—Ä–∏ —Ä–µ–±–µ–Ω–∫–µ'",
                "–ü—Ä–æ—Å–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É, –Ω–æ –Ω–µ –≤–æ–≤–ª–µ–∫–∞—Ç—å –≤ –∫–æ–Ω—Ñ–ª–∏–∫—Ç",
                "–ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤ –∫–∞–∫ –ø–æ—Å—ã–ª—å–Ω—ã—Ö –∫ ex",
                "–ï—Å–ª–∏ —Ä–µ–±–µ–Ω–æ–∫ –≤–∏–¥–∏—Ç—Å—è —Å –≤–∞—à–∏–º–∏ —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞–º–∏ - –æ–±–µ—Å–ø–µ—á–∏—Ç—å –ù–ï–ô–¢–†–ê–õ–¨–ù–û–°–¢–¨"
            ]
        },

        "new_partners": {
            "description": "–ù–æ–≤—ã–µ –ø–∞—Ä—Ç–Ω–µ—Ä—ã –æ–±–æ–∏—Ö —Ä–æ–¥–∏—Ç–µ–ª–µ–π",
            "alienator_new_partner": {
                "risks": [
                    "–ú–æ–∂–µ—Ç '–∑–∞–º–µ–Ω—è—Ç—å' targeted parent ('–ù–∞–∑—ã–≤–∞–π –µ–≥–æ/–µ–µ –ø–∞–ø–æ–π/–º–∞–º–æ–π')",
                    "–ú–æ–∂–µ—Ç —É—Å–∏–ª–∏–≤–∞—Ç—å alienation –∏–∑ —Ä–µ–≤–Ω–æ—Å—Ç–∏",
                    "–ú–æ–∂–µ—Ç –±—ã—Ç—å —Ç—Ä–∏–≥–≥–µ—Ä–æ–º –¥–ª—è —Ä–µ–±–µ–Ω–∫–∞"
                ],
                "targeted_parent_response": [
                    "–ù–ï –∫—Ä–∏—Ç–∏–∫–æ–≤–∞—Ç—å –Ω–æ–≤–æ–≥–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞ –ø—Ä–∏ —Ä–µ–±–µ–Ω–∫–µ (—É—Å–∏–ª–∏—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏)",
                    "–ü—Ä–∏–∑–Ω–∞—Ç—å –µ–≥–æ/–µ–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ –≤ –∂–∏–∑–Ω–∏ —Ä–µ–±–µ–Ω–∫–∞",
                    "–§–æ–∫—É—Å –Ω–∞ –°–í–û–ò–• –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö —Å —Ä–µ–±–µ–Ω–∫–æ–º, –Ω–µ –Ω–∞ –ø–∞—Ä—Ç–Ω–µ—Ä–µ ex"
                ]
            },
            "targeted_parent_new_partner": {
                "risks": [
                    "Alienator –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ '–¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ' ('–û–Ω —Ç–µ–±—è –±—Ä–æ—Å–∏–ª, –≤–æ—Ç –Ω–æ–≤–∞—è —Å–µ–º—å—è')",
                    "–†–µ–±–µ–Ω–æ–∫ –º–æ–∂–µ—Ç —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å —Ä–µ–≤–Ω–æ—Å—Ç—å/—É–≥—Ä–æ–∑—É",
                    "–ú–æ–∂–µ—Ç —É—Å–ª–æ–∂–Ω–∏—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–∞"
                ],
                "best_practices": [
                    "–í–≤–æ–¥–∏—Ç—å –Ω–æ–≤–æ–≥–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ, –∫–æ–≥–¥–∞ –∫–æ–Ω—Ç–∞–∫—Ç —Å —Ä–µ–±–µ–Ω–∫–æ–º —Å—Ç–∞–±–∏–ª–µ–Ω",
                    "–ù–ï —Ñ–æ—Ä—Å–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–Ω–æ—à–µ–Ω–∏—è ('–≠—Ç–æ —Ç–≤–æ—è –Ω–æ–≤–∞—è –º–∞–º–∞/–ø–∞–ø–∞')",
                    "–î–∞—Ç—å —Ä–µ–±–µ–Ω–∫—É –≤—Ä–µ–º—è –ø—Ä–∏–≤—ã–∫–Ω—É—Ç—å",
                    "–ü–∞—Ä—Ç–Ω–µ—Ä - –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∞—è —Ä–æ–ª—å, –ù–ï –∑–∞–º–µ–Ω–∞ —Ä–æ–¥–∏—Ç–µ–ª—è"
                ]
            }
        }
    },

    "managing_extended_family_influence": {
        "communication_with_alienator_relatives": {
            "when_appropriate": "–ï—Å–ª–∏ –µ—Å—Ç—å —Ö–æ—Ç—å –æ–¥–∏–Ω –∞–¥–µ–∫–≤–∞—Ç–Ω—ã–π —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫, –∫–æ—Ç–æ—Ä—ã–π —Å–ª—É—à–∞–µ—Ç",
            "approach": [
                "–ü–∏—Å—å–º–æ (email, –Ω–µ –∑–≤–æ–Ω–æ–∫): '–Ø –ø–æ–Ω–∏–º–∞—é —Å–∏—Ç—É–∞—Ü–∏—è —Å–ª–æ–∂–Ω–∞—è. –ü—Ä–æ—à—É –ø–æ–º–æ—á—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–∞–≤–æ [—Ä–µ–±–µ–Ω–∫–∞] –Ω–∞ –æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å–æ –º–Ω–æ–π.'",
                "–ê–ø–µ–ª–ª—è—Ü–∏—è –∫ –∏—Ö –ª—é–±–≤–∏ –∫ —Ä–µ–±–µ–Ω–∫—É: '–í—ã –ª—é–±–∏—Ç–µ [—Ä–µ–±–µ–Ω–∫–∞]. –†–µ–±–µ–Ω–∫—É –Ω—É–∂–Ω—ã –û–ë–ê —Ä–æ–¥–∏—Ç–µ–ª—è.'",
                "–ë–µ–∑ –æ–±–≤–∏–Ω–µ–Ω–∏–π: –ù–ï '–í–∞—à–∞ –¥–æ—á—å/—Å—ã–Ω alienator!' -> '–î–∞–≤–∞–π—Ç–µ –≤–º–µ—Å—Ç–µ –ø–æ–º–æ–∂–µ–º [—Ä–µ–±–µ–Ω–∫—É]'",
                "–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ–π —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏: '–ú–æ–∂–µ—Ç, –≤—Å—Ç—Ä–µ—á–∏ —É –≤–∞—Å?'"
            ],
            "when_not_appropriate": "–ï—Å–ª–∏ —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∏ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã, —É—á–∞—Å—Ç–≤—É—é—Ç –≤ PA, –∏–ª–∏ –∫–æ–Ω—Ç–∞–∫—Ç —ç—Å–∫–∞–ª–∏—Ä—É–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç"
        },

        "setting_boundaries_with_own_relatives": {
            "rules_for_targeted_parent_family": [
                "–ù–ï –∫—Ä–∏—Ç–∏–∫–æ–≤–∞—Ç—å ex –∏–ª–∏ alienator –ø—Ä–∏ —Ä–µ–±–µ–Ω–∫–µ",
                "–ù–ï —Ä–∞—Å—Å–ø—Ä–∞—à–∏–≤–∞—Ç—å —Ä–µ–±–µ–Ω–∫–∞ –æ –¥—Ä—É–≥–æ–º —Ä–æ–¥–∏—Ç–µ–ª–µ",
                "–ù–ï –¥–∞–≤–∞—Ç—å —Ä–µ–±–µ–Ω–∫—É '—Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –º–∞–º—ã/–ø–∞–ø—ã'",
                "–ë—ã—Ç—å –ù–ï–ô–¢–†–ê–õ–¨–ù–´–ú–ò ('–ú—ã –ª—é–±–∏–º —Ç–µ–±—è, –∏ –º–∞–º–∞/–ø–∞–ø–∞ –ª—é–±–∏—Ç')",
                "–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å targeted parent, –Ω–æ –Ω–µ –≤–º–µ—à–∏–≤–∞—Ç—å—Å—è –≤ –∫–æ–Ω—Ñ–ª–∏–∫—Ç"
            ],
            "how_to_communicate_rules": """
            –°–µ–º–µ–π–Ω–æ–µ —Å–æ–±—Ä–∞–Ω–∏–µ:

            '–°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–¥–¥–µ—Ä–∂–∫—É. –ü—Ä–æ—à—É —Å–æ–±–ª—é–¥–∞—Ç—å –≤–∞–∂–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞:

            1. –ü—Ä–∏ [—Ä–µ–±–µ–Ω–∫–µ] –ù–ï –∫—Ä–∏—Ç–∏–∫—É–µ–º ex.
            2. –ù–ï —Ä–∞—Å—Å–ø—Ä–∞—à–∏–≤–∞–µ–º [—Ä–µ–±–µ–Ω–∫–∞] –æ –¥—Ä—É–≥–æ–º —Ä–æ–¥–∏—Ç–µ–ª–µ.
            3. –ú—ã –ù–ï–ô–¢–†–ê–õ–¨–ù–´: —Ä–µ–±–µ–Ω–æ–∫ –º–æ–∂–µ—Ç –ª—é–±–∏—Ç—å –æ–±–æ–∏—Ö.

            –ï—Å–ª–∏ –Ω–µ –º–æ–∂–µ—Ç–µ —Å–æ–±–ª—é–¥–∞—Ç—å - —è –Ω–µ —Å–º–æ–≥—É –æ—Å—Ç–∞–≤–ª—è—Ç—å [—Ä–µ–±–µ–Ω–∫–∞] —Å –≤–∞–º–∏.'
            """
        }
    },

    "profilestore_integration": {
        "field": "family_context.extended_family_influence",
        "subfields": {
            "alienator_relatives_supportive": "bool (–µ—Å—Ç—å –ª–∏ –∞–¥–µ–∫–≤–∞—Ç–Ω—ã–µ —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∏ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã ex)",
            "own_relatives_boundaries_set": "bool (—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ª–∏ –ø—Ä–∞–≤–∏–ª–∞ —Å —Å–≤–æ–∏–º–∏ —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞–º–∏)",
            "new_partner_present": "bool (–µ—Å—Ç—å –ª–∏ –Ω–æ–≤—ã–π –ø–∞—Ä—Ç–Ω–µ—Ä)",
            "new_partner_introduced_to_child": "bool"
        },
        "usage": "StrategyEngine —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç –∏–ª–∏ –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç –∫–æ–Ω—Ç–∞–∫—Ç —Å —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞–º–∏ ex"
    },

    "user_education_prompt": {
        "timing": "PHASE_2, session 14 OR when user mentions relatives",
        "content": """
        –†–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∏ –º–æ–≥—É—Ç –ø–æ–º–æ—á—å –∏–ª–∏ –Ω–∞–≤—Ä–µ–¥–∏—Ç—å.

        **–†–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∏ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã ex:**
        - –ú–æ–≥—É—Ç –±—ã—Ç—å '–≥–æ–ª–æ—Å–æ–º —Ä–∞–∑—É–º–∞' –ò–õ–ò —É—Å–∏–ª–∏–≤–∞—Ç—å alienation
        - –°—Ç–æ–∏—Ç –ª–∏ —Å–≤—è–∑—ã–≤–∞—Ç—å—Å—è? –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å –ê–î–ï–ö–í–ê–¢–ù–´–ï (–Ω–µ –≤—Å–µ —Ç–æ–∫—Å–∏—á–Ω—ã)

        **–í–∞—à–∏ —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∏:**
        - –ù–ï –∫—Ä–∏—Ç–∏–∫–æ–≤–∞—Ç—å ex –ø—Ä–∏ —Ä–µ–±–µ–Ω–∫–µ
        - –ù–ï —Ä–∞—Å—Å–ø—Ä–∞—à–∏–≤–∞—Ç—å —Ä–µ–±–µ–Ω–∫–∞
        - –ù–ï–ô–¢–†–ê–õ–¨–ù–û–°–¢–¨ - –∫–ª—é—á

        **–ù–æ–≤—ã–µ –ø–∞—Ä—Ç–Ω–µ—Ä—ã:**
        - –ù–ï —Ñ–æ—Ä—Å–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–Ω–æ—à–µ–Ω–∏—è
        - –í–≤–æ–¥–∏—Ç—å –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ
        - –ü–∞—Ä—Ç–Ω–µ—Ä - –ø–æ–¥–¥–µ—Ä–∂–∫–∞, –ù–ï –∑–∞–º–µ–Ω–∞ —Ä–æ–¥–∏—Ç–µ–ª—è

        –ü–æ–º–Ω–∏—Ç–µ: —Ä–µ–±–µ–Ω–∫—É –Ω—É–∂–Ω—ã –†–û–î–ò–¢–ï–õ–ò, –Ω–µ –∏—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–µ. –§–æ–∫—É—Å –Ω–∞ –í–ê–®–ò–• –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö —Å —Ä–µ–±–µ–Ω–∫–æ–º.
        """
    }
}

PHASE_3_ACTION = {
    "name": "–î–ï–ô–°–¢–í–ò–ï",
    "duration_weeks": "4-12",
    "characteristics": {
        "emotional_states": ["STRATEGIC_ACTION", "SELF_HEALING", "ACCEPTANCE"],
        "contact_frequency": "2 times per week",
        "session_length": "medium-long (30-45 min)",
        "primary_goals": [
            "–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∫–æ–Ω—Ç–∞–∫—Ç–∞ —Å —Ä–µ–±–µ–Ω–∫–æ–º",
            "–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ —Å ex-partner",
            "–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –ø–ª–∞–Ω–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ feedback",
            "–û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ—É–¥–∞—á –∏ –ø—Ä–∞–∑–¥–Ω–æ–≤–∞–Ω–∏–µ –ø–æ–±–µ–¥"
        ],
        "success_markers": [
            "At least 1 action from plan executed per week",
            "User reports progress (–¥–∞–∂–µ –º–∞–ª–µ–Ω—å–∫–∏–π) –Ω–∞ —Ü–µ–ª–∏",
            "Reduced conflict with ex-partner (–ø–æ self-report)",
            "Maintained emotional regulation during setbacks"
        ],
        "techniques_priority": ["action_planning", "BIFF_communication", "mediation_prep", "resilience_building"],
        "support_type": "coaching + accountability",
        "failure_handling": "reframe as learning, adjust strategy, –Ω–µ abandon goal"
    },
    "transition_criteria": {
        "to_PHASE_4": [
            "user_has_sustainable_routine (–∫–æ–Ω—Ç–∞–∫—Ç –∏–ª–∏ –ø–æ–ø—ã—Ç–∫–∏ –∫–æ–Ω—Ç–∞–∫—Ç–∞ —Å—Ç–∞–±–∏–ª—å–Ω—ã)",
            "emotional_state_stable (–Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ RAGE/DESPAIR —á–∞—Å—Ç–æ)",
            "user_demonstrates_autonomy (makes decisions independently)",
            "goal_progress_steady OR goal_redefined_realistically"
        ]
    }
}

PHASE_4_SUSTAINABILITY = {
    "name": "–£–°–¢–û–ô–ß–ò–í–û–°–¢–¨",
    "duration_weeks": "12+",
    "characteristics": {
        "emotional_states": ["LONG_TERM_COMMITMENT", "SELF_HEALING", "STRATEGIC_ACTION"],
        "contact_frequency": "weekly OR bi-weekly",
        "session_length": "short-medium (15-30 min)",
        "primary_goals": [
            "–ü–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–æ–∑–∏—Ç–∏–≤–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π",
            "–†–∞–±–æ—Ç–∞ —Å –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–º –æ–∂–∏–¥–∞–Ω–∏–µ–º (–µ—Å–ª–∏ –∫–æ–Ω—Ç–∞–∫—Ç –Ω–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)",
            "–†–∞–∑–≤–∏—Ç–∏–µ –∂–∏–∑–Ω–∏ –≤–Ω–µ –ø—Ä–æ–±–ª–µ–º—ã PA",
            "–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –∏ –ª–∏—á–Ω–æ—Å—Ç–Ω—ã–π —Ä–æ—Å—Ç"
        ],
        "success_markers": [
            "User has full life beyond PA (work, hobbies, relationships)",
            "Able to maintain hope despite setbacks",
            "Contributes to community (–ø–æ–º–æ–≥–∞–µ—Ç –¥—Ä—É–≥–∏–º —Ä–æ–¥–∏—Ç–µ–ª—è–º)",
            "Emotional baseline stable and positive"
        ],
        "techniques_priority": ["meaning_making", "present_waiting", "community_contribution", "relapse_prevention"],
        "support_type": "maintenance + inspiration",
        "graduation_criteria": [
            "User feels ready to reduce contact frequency",
            "Has strong support network outside bot",
            "Demonstrated sustained progress for 3+ months"
        ]
    },
    "transition_criteria": {
        "to_GRADUATION": [
            "user_requests_graduation OR",
            "contact_restored_with_child (success!) OR",
            "user_stable_in_PHASE_4 for 6+ months AND has external support"
        ]
    }
}

# PhaseManager Logic

class PhaseManager:
    def assess_current_phase(self, user_uuid: str) -> Phase:
        """
        –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–µ–∫—É—â—É—é —Ñ–∞–∑—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        """
        profile = ProfileStore.get_profile(user_uuid)
        recent_episodes = EpisodicMemory.get_recent(user_uuid, last_30_days)
        current_emotional_state = profile.current_emotional_state
        days_since_onboarding = (datetime.now() - profile.created_at).days

        # RULE-BASED PHASE DETECTION
        # 1. –ï—Å–ª–∏ –Ω–µ–¥–∞–≤–Ω–æ onboarding –ò –≤ –∫—Ä–∏–∑–∏—Å–µ -> PHASE_1
        if days_since_onboarding < 14 AND current_emotional_state in ["SHOCK", "RAGE", "DESPAIR", "CRISIS"]:
            return PHASE_1_CRISIS

        # 2. –ï—Å–ª–∏ –∞–∫—Ç–∏–≤–Ω–æ —É—á–∏—Ç—Å—è (psychoeducation) -> PHASE_2
        semantic_insights = SemanticMemory.get_recent_patterns(user_uuid)
        if "learning_about_PA" in semantic_insights AND current_emotional_state in ["GUILT", "ACCEPTANCE", "SEEKING_UNDERSTANDING"]:
            return PHASE_2_UNDERSTANDING

        # 3. –ï—Å–ª–∏ –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ goals AND –¥–µ–ª–∞–µ—Ç –¥–µ–π—Å—Ç–≤–∏—è -> PHASE_3
        active_goals = GoalTracker.get_active_goals(user_uuid)
        if len(active_goals) > 0 AND current_emotional_state in ["STRATEGIC_ACTION", "SELF_HEALING"]:
            # Check recent actions
            recent_actions = [e for e in recent_episodes if e.episode_type == "action_taken"]
            if len(recent_actions) > 0:
                return PHASE_3_ACTION

        # 4. –ï—Å–ª–∏ –¥–æ–ª–≥–æ–µ –≤—Ä–µ–º—è –≤ stable states -> PHASE_4
        if days_since_onboarding > 90 AND current_emotional_state == "LONG_TERM_COMMITMENT":
            return PHASE_4_SUSTAINABILITY

        # DEFAULT: return current phase from profile OR infer from duration
        return profile.current_phase OR self.infer_phase_from_duration(days_since_onboarding)

    def check_phase_transition(self, user_uuid: str) -> Optional[PhaseTransition]:
        """
        –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –≥–æ—Ç–æ–≤ –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫ –ø–µ—Ä–µ—Ö–æ–¥—É –≤ —Å–ª–µ–¥—É—é—â—É—é —Ñ–∞–∑—É
        """
        current_phase = self.assess_current_phase(user_uuid)
        criteria = current_phase["transition_criteria"]

        # Evaluate criteria
        for next_phase, conditions in criteria.items():
            if self.evaluate_conditions(user_uuid, conditions):
                return PhaseTransition(
                    from_phase=current_phase["name"],
                    to_phase=next_phase,
                    reason=f"Conditions met: {conditions}",
                    recommended_message="–ü–æ–∑–¥—Ä–∞–≤–ª—è—é! –í—ã –ø—Ä–æ—à–ª–∏ —ç—Ç–∞–ø {current_phase}. –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ {next_phase}."
                )

        return None  # No transition ready

    def adapt_interaction_params(self, user_uuid: str, current_phase: Phase) -> InteractionParams:
        """
        –ê–¥–∞–ø—Ç–∏—Ä—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –ø–æ–¥ —Ç–µ–∫—É—â—É—é —Ñ–∞–∑—É
        """
        return InteractionParams(
            check_in_frequency=current_phase["characteristics"]["contact_frequency"],
            session_length=current_phase["characteristics"]["session_length"],
            techniques_priority=current_phase["characteristics"]["techniques_priority"],
            homework_frequency=current_phase["characteristics"].get("homework_frequency", None),
            guardrails_level=current_phase["characteristics"].get("guardrails", "MEDIUM"),
            support_type=current_phase["characteristics"].get("support_type", "therapeutic")
        )
```

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏**:
- **StrategyEngine** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `current_phase` –¥–ª—è –≤—ã–±–æ—Ä–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
- **JITAIEngine** –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç timing –∏–Ω—Ç–µ—Ä–≤–µ–Ω—Ü–∏–π –ø–æ–¥ `contact_frequency`
- **GoalTracker** –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ—Ç –æ–∂–∏–¥–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –ø–æ–¥ —Ñ–∞–∑—É
- **SupervisorAgent** –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ñ–∞–∑–µ

---

### 7. Progress Indicators: –ú–µ—Ç—Ä–∏–∫–∏ —Ç–µ—Ä–∞–ø–µ–≤—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

**–ò—Å—Ç–æ—á–Ω–∏–∫**: alienated_parent_support_bot_map.md (—Å—Ç—Ä–æ–∫–∏ 1630-1668)

–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ 4 –∫–ª—é—á–µ–≤—ã–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º. Progress Indicators –¥–æ–ø–æ–ª–Ω—è—é—Ç Goal Tracking (–∫–æ—Ç–æ—Ä—ã–π –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç user-defined goals) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –∏–∑–º–µ—Ä–µ–Ω–∏–µ–º –æ–±—â–µ–≥–æ well-being –∏ —Ç–µ—Ä–∞–ø–µ–≤—Ç–∏—á–µ—Å–∫–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.

**4 –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –º–µ—Ç—Ä–∏–∫**:

```python
# Progress Indicators Model

PROGRESS_CATEGORIES = {
    "emotional_regulation": {
        "description": "–°–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —É–ø—Ä–∞–≤–ª—è—Ç—å —ç–º–æ—Ü–∏—è–º–∏ –∏ —Å–Ω–∏–∂–µ–Ω–∏–µ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö —Ä–µ–∞–∫—Ü–∏–π",
        "questions": [
            {
                "id": "rage_frequency",
                "text": "–ö–∞–∫ —á–∞—Å—Ç–æ –≤—ã —á—É–≤—Å—Ç–≤—É–µ—Ç–µ —Å–∏–ª—å–Ω—É—é —è—Ä–æ—Å—Ç—å? (—à–∫–∞–ª–∞ 1-10)",
                "scale": "1 (–Ω–∏–∫–æ–≥–¥–∞) - 10 (–ø–æ—Å—Ç–æ—è–Ω–Ω–æ)",
                "frequency": "weekly",
                "baseline_collection": "onboarding"
            },
            {
                "id": "emotion_duration",
                "text": "–ö–∞–∫ –¥–æ–ª–≥–æ –æ–±—ã—á–Ω–æ –¥–ª—è—Ç—Å—è –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —ç–º–æ—Ü–∏–∏ –ø–æ—Å–ª–µ —Ç—Ä–∏–≥–≥–µ—Ä–∞?",
                "scale": "hours, days, weeks",
                "frequency": "weekly"
            },
            {
                "id": "impulse_control",
                "text": "–£–¥–∞–µ—Ç—Å—è –ª–∏ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –∏–º–ø—É–ª—å—Å—ã (–Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≥–Ω–µ–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –Ω–µ —Å–æ–≤–µ—Ä—à–∞—Ç—å –Ω–µ–æ–±–¥—É–º–∞–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è)?",
                "scale": "1 (–Ω–∏–∫–æ–≥–¥–∞) - 10 (–≤—Å–µ–≥–¥–∞)",
                "frequency": "weekly"
            }
        ],
        "automated_metrics": [
            {
                "metric": "anger_intensity_trend",
                "source": "EpisodicMemory + EmotionalStateDetector",
                "calculation": "average anger_intensity score –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π vs –ø—Ä–µ–¥—ã–¥—É—â–∏–µ 7 –¥–Ω–µ–π"
            },
            {
                "metric": "crisis_episodes_count",
                "source": "EpisodicMemory",
                "calculation": "count of episodes —Å emotional_state == CRISIS –∑–∞ –ø–µ—Ä–∏–æ–¥"
            }
        ]
    },

    "communication_quality": {
        "description": "–£–ª—É—á—à–µ–Ω–∏–µ –Ω–∞–≤—ã–∫–æ–≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ —Å ex-partner –∏ —Ä–µ–±–µ–Ω–∫–æ–º",
        "questions": [
            {
                "id": "nvc_usage",
                "text": "–ò—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ª–∏ –ù–í–û (–ù–µ–Ω–∞—Å–∏–ª—å—Å—Ç–≤–µ–Ω–Ω–æ–µ –û–±—â–µ–Ω–∏–µ) –≤ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞—Ö —Å –±—ã–≤—à–∏–º –ø–∞—Ä—Ç–Ω–µ—Ä–æ–º?",
                "scale": "–Ω–∏–∫–æ–≥–¥–∞, –∏–Ω–æ–≥–¥–∞, —á–∞—Å—Ç–æ, –≤—Å–µ–≥–¥–∞",
                "frequency": "bi-weekly"
            },
            {
                "id": "conflict_reduction",
                "text": "–°–Ω–∏–∑–∏–ª–∞—Å—å –ª–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–Ω–æ—Å—Ç—å –≤ –æ–±—â–µ–Ω–∏–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 2 –Ω–µ–¥–µ–ª–∏?",
                "scale": "–¥–∞, –Ω–µ—Ç, –Ω–µ –±—ã–ª–æ –æ–±—â–µ–Ω–∏—è",
                "frequency": "bi-weekly"
            },
            {
                "id": "response_rate",
                "text": "–ü–æ–ª—É—á–∞–µ—Ç–µ –ª–∏ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤–∞—à–∏ —Å–æ–æ–±—â–µ–Ω–∏—è ex-partner –∏–ª–∏ —Ä–µ–±–µ–Ω–∫—É?",
                "scale": "–Ω–∏–∫–æ–≥–¥–∞, —Ä–µ–¥–∫–æ, –∏–Ω–æ–≥–¥–∞, —á–∞—Å—Ç–æ",
                "frequency": "weekly"
            }
        ],
        "automated_metrics": [
            {
                "metric": "nvc_formulation_success_rate",
                "source": "IP-04 AdherenceTracker",
                "calculation": "% of NVC exercises –≥–¥–µ user successfully —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞–ª NVC"
            },
            {
                "metric": "biff_compliance",
                "source": "ContentGuardian (IP-05) –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ draft messages",
                "calculation": "% of messages —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö BIFF (Brief, Informative, Friendly, Firm)"
            }
        ]
    },

    "contact_with_child": {
        "description": "–ß–∞—Å—Ç–æ—Ç–∞ –∏ –∫–∞—á–µ—Å—Ç–≤–æ –∫–æ–Ω—Ç–∞–∫—Ç–∞ —Å —Ä–µ–±–µ–Ω–∫–æ–º (–≥–ª–∞–≤–Ω—ã–π outcome metric)",
        "questions": [
            {
                "id": "contact_frequency",
                "text": "–ö–∞–∫ —á–∞—Å—Ç–æ –≤—ã –∫–æ–Ω—Ç–∞–∫—Ç–∏—Ä—É–µ—Ç–µ —Å —Ä–µ–±–µ–Ω–∫–æ–º (–≤–∏–¥–µ–æ, –∑–≤–æ–Ω–æ–∫, —Å–æ–æ–±—â–µ–Ω–∏–µ, –≤—Å—Ç—Ä–µ—á–∞)?",
                "scale": "–µ–∂–µ–¥–Ω–µ–≤–Ω–æ, –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é, —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é, —Ä–∞–∑ –≤ –º–µ—Å—è—Ü, —Ä–µ–∂–µ, –Ω–∏–∫–æ–≥–¥–∞",
                "frequency": "weekly",
                "baseline_collection": "onboarding"
            },
            {
                "id": "contact_quality",
                "text": "–ö–∞–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –∫–æ–Ω—Ç–∞–∫—Ç–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å)?",
                "scale": "–æ—á–µ–Ω—å –ø–ª–æ—Ö–æ–µ (1) - –æ—Ç–ª–∏—á–Ω–æ–µ (10)",
                "frequency": "after each contact",
                "conditional": "IF contact_frequency != '–Ω–∏–∫–æ–≥–¥–∞'"
            },
            {
                "id": "positive_changes",
                "text": "–ï—Å—Ç—å –ª–∏ –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö —Å —Ä–µ–±–µ–Ω–∫–æ–º –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü?",
                "scale": "—É—Ö—É–¥—à–∏–ª–æ—Å—å, –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π, –Ω–µ–±–æ–ª—å—à–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ, –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ",
                "frequency": "monthly"
            }
        ],
        "automated_metrics": [
            {
                "metric": "contact_attempts_count",
                "source": "GoalTracker (actions logged)",
                "calculation": "count of 'contact_attempt' actions per week"
            },
            {
                "metric": "contact_success_rate",
                "source": "GoalTracker",
                "calculation": "% of contact attempts that resulted in actual contact"
            }
        ]
    },

    "well_being": {
        "description": "–û–±—â–µ–µ —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ –∏ –∫–∞—á–µ—Å—Ç–≤–æ –∂–∏–∑–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
        "questions": [
            {
                "id": "overall_wellbeing",
                "text": "–ö–∞–∫ –≤–∞—à–µ –æ–±—â–µ–µ —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ —Å–µ–π—á–∞—Å?",
                "scale": "1 (–æ—á–µ–Ω—å –ø–ª–æ—Ö–æ–µ) - 10 (–æ—Ç–ª–∏—á–Ω–æ–µ)",
                "frequency": "weekly",
                "baseline_collection": "onboarding"
            },
            {
                "id": "sleep_quality",
                "text": "–°–ø–∏—Ç–µ –ª–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ?",
                "scale": "—Å–æ–≤—Å–µ–º –Ω–µ—Ç, –ø–ª–æ—Ö–æ, –Ω–æ—Ä–º–∞–ª—å–Ω–æ, —Ö–æ—Ä–æ—à–æ, –æ—Ç–ª–∏—á–Ω–æ",
                "frequency": "weekly"
            },
            {
                "id": "joy_presence",
                "text": "–ï—Å—Ç—å –ª–∏ —Ä–∞–¥–æ—Å—Ç—å –≤ –≤–∞—à–µ–π –∂–∏–∑–Ω–∏ —Å–µ–π—á–∞—Å (–≤–Ω–µ —Å–∏—Ç—É–∞—Ü–∏–∏ —Å —Ä–µ–±–µ–Ω–∫–æ–º)?",
                "scale": "—Å–æ–≤—Å–µ–º –Ω–µ—Ç, –Ω–µ–º–Ω–æ–≥–æ, —É–º–µ—Ä–µ–Ω–Ω–æ, –º–Ω–æ–≥–æ",
                "frequency": "weekly"
            },
            {
                "id": "functioning",
                "text": "–ù–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ –≤—ã —Å–ø—Ä–∞–≤–ª—è–µ—Ç–µ—Å—å —Å —Ä–∞–±–æ—Ç–æ–π, –¥–æ–º–∞—à–Ω–∏–º–∏ –¥–µ–ª–∞–º–∏, —Å–æ—Ü–∏–∞–ª—å–Ω—ã–º–∏ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞–º–∏?",
                "scale": "1 (—Å–æ–≤—Å–µ–º –Ω–µ —Å–ø—Ä–∞–≤–ª—è—é—Å—å) - 10 (–æ—Ç–ª–∏—á–Ω–æ —Å–ø—Ä–∞–≤–ª—è—é—Å—å)",
                "frequency": "bi-weekly"
            }
        ],
        "automated_metrics": [
            {
                "metric": "session_engagement",
                "source": "EpisodicMemory",
                "calculation": "average session length + message count per session"
            },
            {
                "metric": "homework_completion_rate",
                "source": "IP-04 AdherenceTracker",
                "calculation": "% of assigned homework completed"
            }
        ]
    }
}

# ProgressMonitor Implementation

class ProgressMonitor:
    def collect_progress_data(self, user_uuid: str, category: str) -> ProgressData:
        """
        –°–æ–±–∏—Ä–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
        """
        # 1. User self-report questions (scheduled –ø–æ frequency)
        self_report = self.prompt_user_questions(user_uuid, category)

        # 2. Automated metrics from system
        automated = self.calculate_automated_metrics(user_uuid, category)

        # 3. Combine
        return ProgressData(
            category=category,
            timestamp=datetime.now(),
            self_report=self_report,
            automated_metrics=automated,
            trend=self.calculate_trend(user_uuid, category)  # improving, stable, declining
        )

    def generate_progress_report(self, user_uuid: str, period: str = "monthly") -> ProgressReport:
        """
        –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç—á–µ—Ç –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        """
        data = {}
        for category in PROGRESS_CATEGORIES.keys():
            data[category] = self.collect_progress_data(user_uuid, category)

        # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
        charts = self.generate_charts(data)  # line charts –¥–ª—è trends

        # Narrative summary (LLM-generated)
        summary = self.generate_narrative_summary(data)

        return ProgressReport(
            user_uuid=user_uuid,
            period=period,
            data=data,
            charts=charts,
            narrative_summary=summary,
            recommendations=self.generate_recommendations(data)
        )

    def check_stagnation(self, user_uuid: str) -> Optional[StagnationAlert]:
        """
        –î–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç –∑–∞—Å—Ç–æ–π –≤ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ –∏ –∞–ª–µ—Ä—Ç–∏—Ç StrategyEngine
        """
        trends = {cat: self.calculate_trend(user_uuid, cat) for cat in PROGRESS_CATEGORIES.keys()}

        # If 3+ categories showing "declining" or "stable" for 4+ weeks
        declining_count = sum(1 for t in trends.values() if t == "declining")
        stable_count = sum(1 for t in trends.values() if t == "stable")

        if declining_count >= 2:
            return StagnationAlert(
                severity="HIGH",
                message="–ü—Ä–æ–≥—Ä–µ—Å—Å —É—Ö—É–¥—à–∞–µ—Ç—Å—è –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –æ–±–ª–∞—Å—Ç—è—Ö",
                recommendation="–ü–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é, –≤–æ–∑–º–æ–∂–Ω–æ –Ω—É–∂–Ω–∞ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø–æ–º–æ—â—å"
            )

        if stable_count >= 3 AND self.weeks_since_change(user_uuid) > 4:
            return StagnationAlert(
                severity="MEDIUM",
                message="–ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞—Å—Ç–æ–ø–æ—Ä–∏–ª—Å—è",
                recommendation="–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ –∏–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å goals"
            )

        return None  # All good
```

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Progress Indicators**:
- **Weekly check-ins**: –ë–æ—Ç —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç progress questions –≤ –Ω–∞—á–∞–ª–µ –Ω–µ–¥–µ–ª—å–Ω–æ–π —Å–µ—Å—Å–∏–∏
- **Dashboard visualization**: Frontend –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç charts (–µ—Å–ª–∏ –µ—Å—Ç—å UI) –∏–ª–∏ text summary –≤ —á–∞—Ç–µ
- **StrategyEngine feedback**: –ï—Å–ª–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å —Å—Ç–∞–≥–Ω–∏—Ä—É–µ—Ç, StrategyEngine –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ—Ç –ø–æ–¥—Ö–æ–¥
- **PhaseManager**: Progress indicators –≤–ª–∏—è—é—Ç –Ω–∞ phase transition readiness

---

### 8. Letter Writing Integration –≤ Graph

**Extended graph.yaml —Å letter states:**

```yaml
# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ graph.yaml (extension)

states:
  # ... existing emotional states from IP-03 ...

  # NEW: Letter Writing States
  WRITE_LETTER_GRIEF:
    description: "–ü–∏—Å—å–º–æ —Ä–µ–±–µ–Ω–∫—É –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∫–æ—Ä–±–∏"
    entry_conditions:
      emotional_state: ["GRIEF", "NOSTALGIA"]
      readiness_score: ">0.7"
      goal_type: "write_letter"
    prompts:
      - "–î–∞–≤–∞–π—Ç–µ –Ω–∞–ø–∏—à–µ–º –ø–∏—Å—å–º–æ –≤–∞—à–µ–º—É —Ä–µ–±–µ–Ω–∫—É."
      - "–ß—Ç–æ –≤—ã —Ö–æ—Ç–∏—Ç–µ —Å–∫–∞–∑–∞—Ç—å –µ–º—É/–µ–π –æ —Ç–æ–º, –∫–∞–∫ —Å–∫—É—á–∞–µ—Ç–µ?"
    techniques:
      - emotional_expression
      - validation
      - letter_scaffolding
    next_states:
      - LETTER_REVIEW (Content Guardian check)
      - GRIEF (if user not ready)

  WRITE_LETTER_HOPE:
    description: "–ü–∏—Å—å–º–æ —Ä–µ–±–µ–Ω–∫—É –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è –Ω–∞–¥–µ–∂–¥—ã"
    entry_conditions:
      emotional_state: ["HOPE", "ACCEPTANCE"]
      readiness_score: ">0.6"
    prompts:
      - "–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ —Ä–µ–±–µ–Ω–∫—É –æ —Å–≤–æ–µ–π –Ω–∞–¥–µ–∂–¥–µ –Ω–∞ –±—É–¥—É—â–µ–µ."
    techniques:
      - positive_reframing
      - future_focus
    next_states:
      - LETTER_REVIEW

  WRITE_LETTER_RECONCILIATION:
    description: "–ü–∏—Å—å–º–æ —Å –ø–æ–ø—ã—Ç–∫–æ–π –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–∞–∫—Ç–∞"
    entry_conditions:
      emotional_state: ["ACCEPTANCE", "STRATEGIC_ACTION"]
      readiness_score: ">0.8"
      co_parenting_type: "!high_conflict"
    prompts:
      - "–ì–æ—Ç–æ–≤—ã –Ω–∞–ø–∏—Å–∞—Ç—å –ø–∏—Å—å–º–æ –æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ –∫–æ–Ω—Ç–∞–∫—Ç–∞?"
    techniques:
      - NVC_framework
      - boundary_setting
      - action_planning
    next_states:
      - LETTER_REVIEW
      - ACTION_PLANNING (–µ—Å–ª–∏ –ø–∏—Å—å–º–æ - —á–∞—Å—Ç—å larger strategy)

  LETTER_REVIEW:
    description: "–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∏—Å—å–º–∞ Content Guardian"
    entry_conditions:
      previous_state: "WRITE_LETTER_*"
    actions:
      - content_guardian_check (from IP-02)
      - child_safety_validation
      - manipulation_detection
    next_states:
      - LETTER_APPROVED (if passed)
      - LETTER_REVISION (if issues found)
      - current_letter_state (if user wants to revise)

  LETTER_APPROVED:
    description: "–ü–∏—Å—å–º–æ –æ–¥–æ–±—Ä–µ–Ω–æ, —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å"
    actions:
      - save_to_time_capsule (from IP-02)
      - update_goal_progress
      - log_milestone
    next_states:
      - return_to_emotional_state
      - REFLECTION (–ø—Ä–∏–≥–ª–∞—Å–∏—Ç—å –∫ —Ä–µ—Ñ–ª–µ–∫—Å–∏–∏ –æ –ø–∏—Å—å–º–µ)

transitions:
  GRIEF -> WRITE_LETTER_GRIEF:
    condition: "strategy_engine_recommends AND user_consents"

  HOPE -> WRITE_LETTER_HOPE:
    condition: "goal_includes('letter') AND readiness > 0.6"

  ACCEPTANCE -> WRITE_LETTER_RECONCILIATION:
    condition: "days_since_last_contact > 90 AND co_parenting_type != 'high_conflict'"
```

### 7. Trauma-Aware Transitions

**Detecting and avoiding triggers:**

```
[DURING STATE TRANSITION]
1. User –≤ RAGE —Å–æ—Å—Ç–æ—è–Ω–∏–∏, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω transition –∫ NVC_TRAINING
2. TraumaAwareTransitions.check_safety(
     from_state="RAGE",
     to_state="NVC_TRAINING",
     user_uuid=user_uuid
   ):
   a. Retrieve trauma_markers from ProfileStore
      triggers = ["—à–∫–æ–ª–∞", "–¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è", "—Ä–∞–∑–≤–æ–¥ —Å–ª–æ–≤–æ"]
   b. Check if to_state.prompts contain triggers:
      NVC_TRAINING prompts mention "–æ–±—â–µ–Ω–∏–µ —Å –±—ã–≤—à–∏–º –ø–∞—Ä—Ç–Ω–µ—Ä–æ–º"
      -> potential trigger detected
   c. IF trigger_detected:
      - Modify prompts to avoid trigger words
      - Add grounding technique first
      - "–ü—Ä–µ–∂–¥–µ —á–µ–º –ø–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É, –¥–∞–≤–∞–π—Ç–µ —Å–¥–µ–ª–∞–µ–º
         –¥—ã—Ö–∞—Ç–µ–ª—å–Ω–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ."
   d. Set trauma_aware_mode = True –¥–ª—è —ç—Ç–æ–≥–æ transition
3. –ë–û–¢ uses modified prompts
4. EpisodicMemory logs trauma_aware_transition_used
```

**Trauma Marker Schema:**

```yaml
TraumaMarker:
  trigger_word: str
  emotional_response: str (rage, freeze, dissociation)
  first_detected: datetime
  occurrences: int
  severity: float (0-1)
  avoidance_strategy: str (skip, gentle_intro, grounding_first)
```

## API –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã

### ProfileStore

**create_profile(user_uuid: str, profile_data: dict)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: —Å–æ–∑–¥–∞–Ω–∏–µ initial user profile
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `user_uuid` - –∞–Ω–æ–Ω–∏–º–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
  - `profile_data` - structured profile information
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: profile_id

**update_profile(user_uuid: str, updates: dict)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ profile fields
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `user_uuid` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
  - `updates` - partial updates (child_info, family_context, etc.)
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: success: bool

**get_profile(user_uuid: str)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `user_uuid` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: UserProfile object

**add_trauma_marker(user_uuid: str, trigger: str, response: str)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ detected trigger
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `user_uuid` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
  - `trigger` - trigger word/phrase
  - `response` - observed emotional response
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: marker_id

### EpisodicMemory

**log_conversation_turn(user_uuid: str, turn_data: dict)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ conversation turn
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `user_uuid` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
  - `turn_data` - user message, bot response, state, techniques
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: episode_id

**log_significant_event(user_uuid: str, event_type: str, details: dict)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ milestones, breakthroughs, crises
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `user_uuid` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
  - `event_type` - milestone, crisis, breakthrough
  - `details` - event-specific details
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: episode_id

**get_recent(user_uuid: str, time_window: timedelta)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ø–æ–ª—É—á–µ–Ω–∏–µ recent episodes
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `user_uuid` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
  - `time_window` - –ø–µ—Ä–∏–æ–¥ (last 7 days, etc.)
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: List[Episode]

**search_episodes(user_uuid: str, query: str, filters: dict)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: semantic search –ø–æ episodes
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `user_uuid` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
  - `query` - natural language query
  - `filters` - emotional_state, date_range, event_type
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: List[Episode] (ranked by relevance)

### SemanticMemory

**store_insight(user_uuid: str, insight: SemanticUnit)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ extracted insight
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `user_uuid` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
  - `insight` - semantic unit object
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: semantic_id

**get_insights(user_uuid: str, time_window: str, insight_type: str)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ø–æ–ª—É—á–µ–Ω–∏–µ insights –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `user_uuid` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
  - `time_window` - daily, weekly, monthly
  - `insight_type` - pattern, learning, progress, concern
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: List[SemanticUnit]

### MemoryConsolidation

**run_daily_consolidation(cutoff_date: datetime)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: background process –¥–ª—è semantic extraction
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `cutoff_date` - –ø—Ä–æ—Ü–µ—Å—Å–∏—Ç—å episodes –¥–æ —ç—Ç–æ–π –¥–∞—Ç—ã
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: ConsolidationReport (episodes_processed, insights_created)

**extract_patterns(episodes: List[Episode])**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: pattern extraction –∏–∑ episodes
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `episodes` - —Å–ø–∏—Å–æ–∫ episodes –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: List[Pattern] (recurring themes, triggers, effective techniques)

### StrategyEngine

**select_next_intervention(current_state: str, user_uuid: str)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –≤—ã–±–æ—Ä —Å–ª–µ–¥—É—é—â–µ–π —Ç–µ—Ä–∞–ø–µ–≤—Ç–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `current_state` - —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - `user_uuid` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–ª—è context retrieval
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: InterventionRecommendation (next_state, rationale, timing)

**apply_strategy_policies(context: dict)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ rule-based policies
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `context` - profile, readiness, goals, recent_history
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: List[StrategyOption] (ranked)

### ReadinessAssessor

**assess(current_state: str, profile: UserProfile, recent_history: List[Episode])**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –æ—Ü–µ–Ω–∫–∞ readiness –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö interventions
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `current_state` - —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
  - `profile` - user profile
  - `recent_history` - recent episodes
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: ReadinessScores (letter_writing_ready, action_taking_ready, waiting_ready)

**assess_emotional_stability(episodes: List[Episode])**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –æ—Ü–µ–Ω–∫–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ —ç–º–æ—Ü–∏–π
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `episodes` - last 7 days episodes
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: float (0-1, higher = more stable)

### GoalTracker

**create_goal(user_uuid: str, goal_data: dict)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: —Å–æ–∑–¥–∞–Ω–∏–µ user-defined goal
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `user_uuid` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
  - `goal_data` - type, description, deadline, milestones
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: goal_id

**update_progress(goal_id: UUID, progress: float, completed_milestones: List[str])**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ goal progress
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `goal_id` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä goal
  - `progress` - –ø—Ä–æ—Ü–µ–Ω—Ç (0-100)
  - `completed_milestones` - —Å–ø–∏—Å–æ–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö milestones
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: success: bool

**get_active_goals(user_uuid: str)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ø–æ–ª—É—á–µ–Ω–∏–µ active goals
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `user_uuid` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: List[Goal]

**detect_blockers(goal_id: UUID)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–µ—Ç–µ–∫—Ü–∏—è blockers
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `goal_id` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä goal
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: List[Blocker] (no_progress_2weeks, emotional_barrier, external_factor)

### ProgressMonitor

**run_weekly_check(user_uuid: str)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `user_uuid` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: WeeklyProgressReport

**generate_progress_summary(goals: List[Goal], episodes: List[Episode])**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –≥–µ–Ω–µ—Ä–∞—Ü–∏—è human-readable summary
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `goals` - active goals
  - `episodes` - recent episodes
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: str (formatted progress summary)

### JITAIEngine

**optimize_intervention_timing(intervention: str, user_uuid: str)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ optimal timing –¥–ª—è intervention
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `intervention` - —Ç–∏–ø –∏–Ω—Ç–µ—Ä–≤–µ–Ω—Ü–∏–∏ (letter_writing, action_planning)
  - `user_uuid` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–ª—è temporal patterns
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: OptimalTiming (recommended_time_of_day, recommended_day_of_week, defer: bool)

**check_temporal_patterns(user_uuid: str)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –∞–Ω–∞–ª–∏–∑ –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å most receptive
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `user_uuid` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: TemporalPatterns (best_times, worst_times, engagement_curve)

## –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### Onboarding Flow

```
User /start
  |
  v
ProfileSetupWorkflow (BESSER state)
  |
  +---> Guided questions
  |
  v
ProfileStore.create_profile()
  |
  v
KAG.create_node(type="User")
  |
  v
GoalTracker.create_goal() [initial goal]
  |
  v
EpisodicMemory.log_event("profile_created")
  |
  v
User ready for therapy sessions
```

### Strategy Selection Flow

```
BESSER Agent in state GRIEF
  |
  v
StrategyEngine.select_next_intervention(current_state="GRIEF", user_uuid)
  |
  +---> ProfileStore.get_profile() [context]
  +---> EpisodicMemory.get_recent(last_7_days) [history]
  +---> SemanticMemory.get_insights(monthly) [patterns]
  +---> GoalTracker.get_active_goals() [goals]
  |
  v
ReadinessAssessor.assess(context)
  |
  v
Apply strategy_policies (letter_writing_policy, action_policy, etc.)
  |
  +---> IF letter_ready > 0.7: recommend "WRITE_LETTER_GRIEF"
  +---> ELSE: recommend "GRIEF_PROCESSING"
  |
  v
JITAIEngine.optimize_timing()
  |
  +---> IF evening AND semantic_patterns.show("evening sadness"): defer_to_morning
  |
  v
Return InterventionRecommendation to BESSER Agent
  |
  v
Graph transition: GRIEF -> WRITE_LETTER_GRIEF
```

### Memory Consolidation Flow

```
[NIGHTLY CRON JOB]
Celery task: MemoryConsolidation.run_daily_consolidation()
  |
  v
EpisodicMemory.get_episodes(last_24h)
  |
  v
extract_patterns(episodes)
  |
  +---> Detect recurring emotional states
  +---> Detect trigger patterns
  +---> Detect effective techniques
  +---> Detect goal progress patterns
  |
  v
LLM semantic summarization
  |
  v
SemanticMemory.store_insights(insights)
  |
  v
ProfileStore.update_preferences() [based on patterns]
  |
  v
IF critical_pattern_detected (stuck, regression):
  - Flag for ClinicalOversight (IP-06)
```

### Goal Progress Flow

```
User works on goal throughout week
  |
  v
EpisodicMemory logs goal-related episodes
  |
  v
[WEEKLY CRON]
ProgressMonitor.run_weekly_check(user_uuid)
  |
  v
GoalTracker.get_active_goals()
  |
  v
FOR each goal:
  - Query EpisodicMemory for related episodes
  - Calculate progress_percentage
  - Detect blockers (stuck > 2 weeks?)
  |
  v
Generate WeeklyProgressReport
  |
  v
–ë–û–¢ sends progress summary to user
  |
  v
IF blocker detected:
  - StrategyEngine suggests intervention
```

## –ü–æ—Ä—è–¥–æ–∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –≠—Ç–∞–ø 1: Profile Store Foundation

1. **UserProfile Pydantic Models**
   - Define schema –¥–ª—è User, Child, Family
   - Validation rules

2. **ProfileStore CRUD**
   - PostgreSQL schema
   - create_profile, update_profile, get_profile
   - Integration —Å KAG (create User node)

3. **Onboarding Workflow –≤ BESSER**
   - Guided questions state machine
   - Profile setup flow

### –≠—Ç–∞–ø 2: Episodic Memory

4. **EpisodicMemory Schema**
   - TimescaleDB –¥–ª—è time-series events
   - Episode model —Å embeddings

5. **Conversation Logging**
   - Integration —Å BESSER Agent
   - log_conversation_turn() –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ turn
   - log_significant_event() –¥–ª—è milestones

6. **Memory Retrieval**
   - get_recent() queries
   - search_episodes() —Å semantic search

### –≠—Ç–∞–ø 3: Semantic Memory

7. **SemanticMemory Store**
   - Vector database –¥–ª—è insights
   - SemanticUnit schema

8. **MemoryConsolidation Background Process**
   - Celery task –¥–ª—è nightly consolidation
   - extract_patterns() logic
   - LLM-based summarization

9. **Integration —Å ProfileStore**
   - Update preferences –Ω–∞ –æ—Å–Ω–æ–≤–µ patterns
   - Trauma marker detection

### –≠—Ç–∞–ø 4: Strategy Engine

10. **ReadinessAssessor**
    - assess_emotional_stability()
    - Multi-factor readiness scoring
    - Calibration —á–µ—Ä–µ–∑ expert feedback (IP-06)

11. **Strategy Policies**
    - letter_writing_policy.py
    - action_policy.py
    - waiting_policy.py
    - Rule-based decision trees

12. **StrategyEngine Coordinator**
    - select_next_intervention()
    - Integration —Å ProfileStore, EpisodicMemory, SemanticMemory
    - Return recommendations to BESSER

### –≠—Ç–∞–ø 5: Goal Tracking

13. **GoalTracker CRUD**
    - create_goal, update_progress, get_active_goals
    - Milestone tracking
    - Blocker detection

14. **ProgressMonitor**
    - Weekly check cron job
    - generate_progress_summary()
    - Integration —Å EpisodicMemory

15. **Goal Templates Library**
    - Pre-defined goal templates (write_letter, restore_contact, self_care)
    - User customization

### –≠—Ç–∞–ø 6: Graph Extensions

16. **Letter States –≤ graph.yaml**
    - WRITE_LETTER_GRIEF, WRITE_LETTER_HOPE, WRITE_LETTER_RECONCILIATION
    - LETTER_REVIEW, LETTER_APPROVED
    - Transitions –æ—Ç emotional states

17. **TraumaAwareTransitions**
    - check_safety() –ø–µ—Ä–µ–¥ transitions
    - Trigger detection
    - Prompt modification

18. **Integration Letter Writing (IP-02) —Å Graph**
    - Connect IP-02 workflows to graph states
    - Content Guardian check –≤ LETTER_REVIEW state

### –≠—Ç–∞–ø 7: JITAI Engine

19. **Temporal Pattern Analysis**
    - check_temporal_patterns()
    - Best/worst times –¥–ª—è interventions

20. **Timing Optimization**
    - optimize_intervention_timing()
    - Defer logic

### –≠—Ç–∞–ø 8: TRIZ Resolver (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è MVP)

21. **Contradiction Detection**
    - Detect –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—è (—Ö–æ—á–µ—Ç –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å vs –Ω–µ –≥–æ—Ç–æ–≤)

22. **TRIZ Principles Application**
    - Separation in time
    - Dynamic adaptation
    - Feedback loops

## –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏

### 1. User Profile Incomplete

**–°–∏—Ç—É–∞—Ü–∏—è**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ–ø—É—Å—Ç–∏–ª –≤–æ–ø—Ä–æ—Å—ã –ø—Ä–∏ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–µ, profile –Ω–µ–ø–æ–ª–Ω—ã–π

**–û–±—Ä–∞–±–æ—Ç–∫–∞**:
- Graceful degradation (use defaults)
- Progressive profiling (–∑–∞–¥–∞–≤–∞—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –≤ –¥–∏–∞–ª–æ–≥–∞—Ö)
- Mark profile as "incomplete" –∏ –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å completion
- Strategy Engine adapts –∫ limited context

### 2. Episodic Memory Explosion

**–°–∏—Ç—É–∞—Ü–∏—è**: –î–ª—è active user 1000+ episodes –∑–∞ –º–µ—Å—è—Ü, queries slow

**–û–±—Ä–∞–±–æ—Ç–∫–∞**:
- Pagination –¥–ª—è get_recent()
- Archiving —Å—Ç–∞—Ä—ã—Ö episodes (>6 months) –≤ cold storage
- Summarization —á–µ—Ä–µ–∑ SemanticMemory (replace –º–Ω–æ–≥–∏–µ episodes –æ–¥–Ω–∏–º summary)
- Index optimization (PostgreSQL/TimescaleDB)

### 3. Conflicting Goals

**–°–∏—Ç—É–∞—Ü–∏—è**: User set goals "–Ω–µ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –ø—Ä–æ–≤–æ–∫–∞—Ü–∏–∏" AND "–±–æ—Ä–æ—Ç—å—Å—è –∑–∞ –ø—Ä–∞–≤–∞"

**–û–±—Ä–∞–±–æ—Ç–∫–∞**:
- GoalTracker.detect_conflicts()
- –ë–û–¢ facilitates goal prioritization dialogue
- "–í–∏–∂—É –≤–∞—à–∏ —Ü–µ–ª–∏ –º–æ–≥—É—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å. –ö–∞–∫–∞—è —Å–µ–π—á–∞—Å –≤–∞–∂–Ω–µ–µ?"
- Tag goals as "primary" vs "secondary"

### 4. Readiness Assessment Incorrect

**–°–∏—Ç—É–∞—Ü–∏—è**: ReadinessAssessor –æ—Ü–µ–Ω–∏–ª ready=0.8, –Ω–æ user –æ—Ç–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ—Ç intervention

**–û–±—Ä–∞–±–æ—Ç–∫–∞**:
- Log discrepancy –¥–ª—è model retraining
- Ask user feedback: "–ß—Ç–æ –ø–æ–º–µ—à–∞–ª–æ? –Ø –ø–µ—Ä–µ–æ—Ü–µ–Ω–∏–ª –≤–∞—à—É –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å?"
- Update readiness model weights –Ω–∞ –æ—Å–Ω–æ–≤–µ feedback
- Expert review sample (IP-06)

### 5. Semantic Memory Hallucination

**–°–∏—Ç—É–∞—Ü–∏—è**: LLM –≤ consolidation —Å–æ–∑–¥–∞–ª incorrect insight ("user hates child" –∫–æ–≥–¥–∞ —ç—Ç–æ –Ω–µ —Ç–∞–∫)

**–û–±—Ä–∞–±–æ—Ç–∫–∞**:
- Human-in-the-loop validation –¥–ª—è high-impact insights
- Show insights to user: "–Ø –∑–∞–º–µ—Ç–∏–ª –ø–∞—Ç—Ç–µ—Ä–Ω X. –ü—Ä–∞–≤–∏–ª—å–Ω–æ?"
- User can reject/correct insights
- Flag –¥–ª—è expert review

### 6. Trauma Trigger False Positive

**–°–∏—Ç—É–∞—Ü–∏—è**: –°–∏—Å—Ç–µ–º–∞ –æ—à–∏–±–æ—á–Ω–æ —Å—á–∏—Ç–∞–µ—Ç "—à–∫–æ–ª–∞" —Ç—Ä–∏–≥–≥–µ—Ä–æ–º (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–ø–æ–º—è–Ω—É–ª –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ)

**–û–±—Ä–∞–±–æ—Ç–∫–∞**:
- Confidence scoring –¥–ª—è triggers (–Ω–µ –¥–æ–±–∞–≤–ª—è—Ç—å –ø–æ—Å–ª–µ –æ–¥–Ω–æ–≥–æ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è)
- Track emotional response –ø–æ—Å–ª–µ trigger mention
- IF no negative response -> downgrade trigger severity
- User can manually remove trigger: /manage_triggers

### 7. Strategy Engine Stuck Loop

**–°–∏—Ç—É–∞—Ü–∏—è**: StrategyEngine —Ü–∏–∫–ª–∏—á–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ (GRIEF -> WRITE_LETTER -> GRIEF -> WRITE_LETTER)

**–û–±—Ä–∞–±–æ—Ç–∫–∞**:
- Detect loops –≤ EpisodicMemory (same state transitions >3 times)
- StrategyEngine adds diversity constraint
- "–ú—ã —É–∂–µ –ø—Ä–æ–±–æ–≤–∞–ª–∏ —ç—Ç–æ. –ü–æ–ø—Ä–æ–±—É–µ–º –¥—Ä—É–≥–æ–π –ø–æ–¥—Ö–æ–¥?"
- Escalate to ClinicalOversight –µ—Å–ª–∏ stuck >2 weeks

### 8. JITAI Timing Conflict —Å User Availability

**–°–∏—Ç—É–∞—Ü–∏—è**: JITAI recommends intervention –≤ 10am, –Ω–æ user —Ç–æ–ª—å–∫–æ –≤–µ—á–µ—Ä–æ–º –æ–Ω–ª–∞–π–Ω

**–û–±—Ä–∞–±–æ—Ç–∫–∞**:
- Track user online patterns —á–µ—Ä–µ–∑ EpisodicMemory
- Optimize timing window (best time WITHIN user availability)
- Allow user to set preferences: "–õ—É—á—à–µ –≤—Ä–µ–º—è –¥–ª—è –º–µ–Ω—è: –≤–µ—á–µ—Ä"
- Defer interventions –¥–æ availability window

## –î–æ–ø—É—â–µ–Ω–∏—è

1. **User Honesty**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —á–µ—Å—Ç–Ω–æ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ profile questions (–Ω–µ –º–æ–∂–µ–º verify, –Ω–æ trust)
2. **Memory Retention**: 6 months active memory, –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ä—à–µ (–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è —Ç–µ—Ä–∞–ø–∏–∏)
3. **Consolidation Frequency**: Nightly –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ (–Ω–µ real-time semantic extraction)
4. **Readiness Model**: Rule-based + simple ML (–Ω–µ deep learning) –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è MVP
5. **Goal Types**: 4-5 pre-defined goal types –ø–æ–∫—Ä—ã–≤–∞—é—Ç 80% use cases
6. **LLM for Consolidation**: GPT-4 –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ç–æ—á–µ–Ω –¥–ª—è semantic summarization (—Å validation)
7. **Trigger Detection**: User-reported + pattern-detected triggers (–Ω–µ external –±–∏–æ–º–µ—Ç—Ä–∏—è)
8. **Strategy Policies**: Rule-based policies –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã (–Ω–µ reinforcement learning)

## –û—Ç–∫—Ä—ã—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

1. **Memory Retention Period**: 6 –º–µ—Å—è—Ü–µ–≤ –∏–ª–∏ –¥–æ–ª—å—à–µ? (GDPR data minimization vs therapeutic context)
2. **Consolidation LLM**: GPT-4 vs cheaper model –¥–ª—è nightly batch? (cost vs quality)
3. **Readiness Threshold Calibration**: –ö—Ç–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç optimal thresholds? (expert panel vs data-driven)
4. **Goal Templates**: –ó–∞—Ä–∞–Ω–µ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –∏–ª–∏ user fully custom? (balance guidance vs autonomy)
5. **JITAI Timing**: –ù–∞—Å–∫–æ–ª—å–∫–æ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å timing? (—Ä–∏—Å–∫ –±—ã—Ç—å intrusive)
6. **Trauma Markers**: –°–∫–æ–ª—å–∫–æ occurrences –Ω—É–∂–Ω–æ –¥–ª—è confirmation trigger? (1, 2, 3+?)
7. **Strategy Override**: –ú–æ–∂–µ—Ç –ª–∏ user override strategy recommendations? (always yes, but track?)
8. **Profile Export**: Include –≤ GDPR export (IP-07) –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω–æ? (–≤–µ—Ä–æ—è—Ç–Ω–æ –≤–º–µ—Å—Ç–µ)

## Acceptance Criteria

### Happy Path

1. **Profile Creation Works**:
   - New user completes onboarding
   - Profile stored –≤ PostgreSQL
   - User node created –≤ KAG
   - Initial goal set

2. **Episodic Memory Logs Correctly**:
   - Every conversation turn logged
   - Timestamps accurate
   - Embeddings generated
   - Searchable —á–µ—Ä–µ–∑ semantic search

3. **Semantic Memory Consolidation Runs**:
   - Nightly job processes episodes
   - Insights created
   - Patterns detected (recurring emotions, triggers)
   - ProfileStore updated —Å learnings

4. **Strategy Engine Recommends Correctly**:
   - User –≤ GRIEF -> assess readiness -> recommend WRITE_LETTER_GRIEF
   - Recommendation aligns —Å goals
   - JITAI timing optimized

5. **Goal Tracking Functional**:
   - User creates goal
   - Progress updates automatically
   - Weekly check sends summary
   - Blockers detected

6. **Letter States Work**:
   - Transition GRIEF -> WRITE_LETTER_GRIEF
   - Content Guardian check –≤ LETTER_REVIEW
   - Save to time capsule –µ—Å–ª–∏ approved

7. **Trauma-Aware Transitions**:
   - Trigger detected –≤ prompts
   - Prompts modified
   - User not triggered

### –†—É—á–Ω–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π –ø—Ä–æ–≤–µ—Ä–∫–∏

**–°—Ü–µ–Ω–∞—Ä–∏–π 1: End-to-End Onboarding + Goal**

1. New user /start
2. Complete onboarding questions
3. Verify profile stored (query PostgreSQL)
4. Verify KAG node created
5. Set goal "–ù–∞–ø–∏—Å–∞—Ç—å –ø–∏—Å—å–º–æ –∫ –î–†"
6. Verify goal –≤ GoalTracker

**–°—Ü–µ–Ω–∞—Ä–∏–π 2: Conversation -> Episodic Memory -> Consolidation**

1. User has 10 conversations over 2 days
2. Verify all 10 logged –≤ EpisodicMemory
3. Run manual consolidation job
4. Verify insights created –≤ SemanticMemory
5. Check ProfileStore updated (new trigger added)

**–°—Ü–µ–Ω–∞—Ä–∏–π 3: Strategy Selection**

1. User –≤ GRIEF state
2. Trigger StrategyEngine.select_next_intervention()
3. Verify retrieves profile, episodes, insights, goals
4. Verify ReadinessAssessor runs
5. Verify recommendation returned
6. Check graph transition occurs

**–°—Ü–µ–Ω–∞—Ä–∏–π 4: Goal Progress Check**

1. User has goal "write_letter" 50% done
2. Run weekly ProgressMonitor
3. Verify summary generated
4. Verify –ë–û–¢ sends weekly update
5. User interacts, progress updates
6. Verify blocker detected –µ—Å–ª–∏ stuck

**–°—Ü–µ–Ω–∞—Ä–∏–π 5: Trauma-Aware Transition**

1. User has trigger "—Ä–∞–∑–≤–æ–¥" –≤ profile
2. Attempt transition —Å prompt containing "—Ä–∞–∑–≤–æ–¥"
3. Verify TraumaAwareTransitions detects
4. Verify prompt modified
5. User completes transition without distress

## Definition of Done

- [x] UserProfile Pydantic models defined
- [x] ProfileStore CRUD implemented (PostgreSQL)
- [x] Onboarding workflow –≤ BESSER
- [x] EpisodicMemory schema (TimescaleDB)
- [x] Conversation logging integration
- [x] SemanticMemory store (Vector DB)
- [x] MemoryConsolidation Celery task
- [x] Pattern extraction logic
- [x] ReadinessAssessor implementation
- [x] Strategy policies (letter, action, waiting)
- [x] StrategyEngine coordinator
- [x] GoalTracker CRUD
- [x] ProgressMonitor weekly check
- [x] Goal templates library
- [x] Letter states –≤ graph.yaml extension
- [x] TraumaAwareTransitions logic
- [x] JITAIEngine timing optimization
- [x] KAG integration –¥–ª—è memory nodes
- [x] BESSER session <-> Profile bridge
- [x] Memory retrieval APIs
- [x] Blocker detection algorithm
- [x] Weekly progress summary generation
- [x] Trigger detection logic
- [x] Semantic search functional
- [x] Feature flags: MEMORY_ENABLED, STRATEGY_ENGINE_ENABLED, GOAL_TRACKING_ENABLED
- [x] README –¥–ª—è memory/strategy modules

## –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ NFR –¥–ª—è MVP

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **Profile retrieval**: <= 50ms
- **Episodic memory write**: <= 100ms (–Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç conversation)
- **Semantic search**: <= 500ms –¥–ª—è recent episodes
- **Strategy selection**: <= 1s (acceptable latency)
- **Consolidation job**: <= 30 min –¥–ª—è 10k episodes (nightly batch)
- **Goal progress check**: <= 5s per user (weekly batch)

### –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å

- **Memory write success**: 99.9% (critical –¥–ª—è –Ω–µ —Ç–µ—Ä—è—Ç—å context)
- **Consolidation success**: 95% (can retry failed jobs)
- **Strategy recommendation**: 100% fallback to default –µ—Å–ª–∏ failure
- **Profile corruption**: 0% (validated writes)

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ —Ä–µ—Å—É—Ä—Å–∞–º

- **Profile size**: <= 50KB per user
- **Episodic memory retention**: 6 months active, archive older
- **Semantic memory**: <= 1000 insights per user (summarize/merge older)
- **Vector store**: embeddings –¥–ª—è last 6 months only
- **Consolidation CPU**: <= 4 cores –¥–ª—è batch job
- **Memory (RAM)**: <= 4GB –¥–ª—è consolidation process

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

- **Profile data encryption**: at rest (same as IP-07 PII protection)
- **Episodic memory**: tokenized (no real PII), encrypted at rest
- **Semantic insights**: reviewed –¥–ª—è PII leaks before storing
- **Goal data**: user_uuid only (no de-anonymization needed)
- **Memory export**: include –≤ GDPR data export (IP-07)
- **Trauma markers**: sensitive data, encrypted, access logged
- **Strategy recommendations**: logged –¥–ª—è audit (clinical decisions)

## –ù–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å

### –õ–æ–≥–∏

- **Profile events**: profile_created, profile_updated, trigger_added
- **Memory events**: episode_logged, consolidation_run, insight_created
- **Strategy events**: strategy_selected, readiness_assessed, intervention_recommended
- **Goal events**: goal_created, milestone_completed, blocker_detected, weekly_check_sent
- **Trauma events**: trigger_detected, transition_modified
- **All logs**: structured JSON, user_uuid, timestamp, event_details

### –ú–µ—Ç—Ä–∏–∫–∏

- **profiles_created_total**: —Å—á–µ—Ç—á–∏–∫
- **episodes_logged_total**: —Å—á–µ—Ç—á–∏–∫
- **consolidation_duration_seconds**: histogram
- **insights_created_total**: —Å—á–µ—Ç—á–∏–∫
- **strategy_recommendations_total**: —Å—á–µ—Ç—á–∏–∫ –ø–æ intervention_type
- **readiness_scores_distribution**: histogram (letter_ready, action_ready, waiting_ready)
- **goals_created_total**: —Å—á–µ—Ç—á–∏–∫
- **goals_achieved_total**: —Å—á–µ—Ç—á–∏–∫
- **weekly_checks_sent_total**: —Å—á–µ—Ç—á–∏–∫
- **blockers_detected_total**: —Å—á–µ—Ç—á–∏–∫
- **trauma_triggers_detected_total**: —Å—á–µ—Ç—á–∏–∫
- **memory_retrieval_latency_ms**: histogram
- **strategy_selection_latency_ms**: histogram

### –¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞

- **Span start**: strategy_engine.select_intervention()
- **Child spans**:
  - profile_store.get_profile()
  - episodic_memory.get_recent()
  - semantic_memory.get_insights()
  - readiness_assessor.assess()
- **Span end**: recommendation returned
- **Trace ID**: propagate —á–µ—Ä–µ–∑ all memory/strategy calls

## –†–µ–ª–∏–∑

### –í–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ feature flag

```yaml
MEMORY_ENABLED: true
PROFILE_STORE_ENABLED: true
EPISODIC_MEMORY_ENABLED: true
SEMANTIC_MEMORY_ENABLED: true
CONSOLIDATION_ENABLED: true
STRATEGY_ENGINE_ENABLED: true
READINESS_ASSESSMENT_ENABLED: true
GOAL_TRACKING_ENABLED: true
JITAI_ENABLED: false  # beta feature
TRAUMA_AWARE_TRANSITIONS: true
LETTER_GRAPH_EXTENSION: true
```

### –ü–ª–∞–Ω —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

1. **Staging (2 –Ω–µ–¥–µ–ª–∏)**:
   - Deploy ProfileStore + EpisodicMemory
   - Test onboarding flow
   - Simulate conversations, verify logging
   - Run manual consolidation, verify insights

2. **Production Phased Rollout**:
   - **–§–∞–∑–∞ 1 (–Ω–µ–¥–µ–ª—è 1)**: ProfileStore —Ç–æ–ª—å–∫–æ
     - MEMORY_ENABLED=true
     - Onboarding flow active
     - No strategy engine yet (manual states)
   - **–§–∞–∑–∞ 2 (–Ω–µ–¥–µ–ª—è 2)**: + EpisodicMemory
     - Conversation logging active
     - Monitor storage growth
   - **–§–∞–∑–∞ 3 (–Ω–µ–¥–µ–ª—è 3)**: + SemanticMemory + Consolidation
     - Nightly jobs start
     - Expert review sample insights (IP-06)
   - **–§–∞–∑–∞ 4 (–Ω–µ–¥–µ–ª—è 4)**: + StrategyEngine
     - STRATEGY_ENGINE_ENABLED=true
     - Monitor recommendations quality
   - **–§–∞–∑–∞ 5 (–Ω–µ–¥–µ–ª—è 5)**: + GoalTracking
     - GOAL_TRACKING_ENABLED=true
     - Weekly checks start
   - **–§–∞–∑–∞ 6 (–Ω–µ–¥–µ–ª—è 6)**: + Letter Graph Extension
     - LETTER_GRAPH_EXTENSION=true
     - Full integration IP-02 + IP-03

## –û—Ç–∫–∞—Ç

### –£—Å–ª–æ–≤–∏—è –æ—Ç–∫–∞—Ç–∞

- Memory writes fail (data loss detected)
- Consolidation job crashes repeatedly
- Strategy Engine recommends dangerous interventions (safety issue)
- Performance degradation (latency > 2s –¥–ª—è strategy selection)
- User complaints (too intrusive, creepy memory)

### –®–∞–≥–∏ –≤–æ–∑–≤—Ä–∞—Ç–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è

1. **–ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π –æ—Ç–∫–∞—Ç**:
   - Set STRATEGY_ENGINE_ENABLED=false (fallback to manual states)
   - Set CONSOLIDATION_ENABLED=false (stop background jobs)
   - Keep ProfileStore + EpisodicMemory (read-only)

2. **Data integrity check**:
   - Verify no corrupted profiles
   - Verify no lost episodes
   - Restore from backup –µ—Å–ª–∏ needed

3. **Root cause analysis**:
   - Review logs –¥–ª—è memory write failures
   - Check consolidation job errors
   - Analyze strategy recommendations

4. **Fix –∏ validation**:
   - Fix bugs
   - Test –≤ staging
   - Expert review (IP-06)

5. **Re-deployment**:
   - Gradual re-enable (–§–∞–∑–∞ 1-6)
   - Enhanced monitoring

## –†–∏—Å–∫–∏ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏–∏

### –†–∏—Å–∫ 1: Memory Explosion (Storage Costs)

**–û–ø–∏—Å–∞–Ω–∏–µ**: Active users generate 1000s episodes, storage costs escalate

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
- Retention policy (6 months active memory)
- Aggressive consolidation (replace many episodes —Å semantic summaries)
- Archive to cold storage (S3 Glacier)
- Monitor per-user storage, alert if > threshold

### –†–∏—Å–∫ 2: Consolidation LLM Hallucinations

**–û–ø–∏—Å–∞–Ω–∏–µ**: LLM creates incorrect semantic insights, misleads strategy

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
- Human-in-the-loop validation –¥–ª—è high-impact insights
- Show insights to user –¥–ª—è feedback
- Expert review sample (IP-06)
- Confidence scoring, only store high-confidence insights
- Fact-checking prompts: "Is this supported by episodes?"

### –†–∏—Å–∫ 3: Strategy Engine Bias

**–û–ø–∏—Å–∞–Ω–∏–µ**: StrategyEngine —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏ over-recommends certain interventions

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
- Track recommendation distribution (alert –µ—Å–ª–∏ imbalanced)
- A/B test strategies (IP-06 evaluation)
- Expert review recommendations
- User feedback loop ("–≠—Ç–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –ø–æ–º–æ–≥–ª–∞?")
- Regular calibration —á–µ—Ä–µ–∑ expert panel

### –†–∏—Å–∫ 4: Readiness Assessment Inaccuracy

**–û–ø–∏—Å–∞–Ω–∏–µ**: ReadinessAssessor frequently misjudges user readiness

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
- Log discrepancies (recommended vs user action)
- Retrain model –Ω–∞ actual outcomes
- Multi-factor assessment (–Ω–µ single score)
- Allow user override ("–Ø –Ω–µ –≥–æ—Ç–æ–≤ —Å–µ–π—á–∞—Å")
- Expert validation sample

### –†–∏—Å–∫ 5: Privacy - Memory Contains Indirect PII

**–û–ø–∏—Å–∞–Ω–∏–µ**: Episodic memory reveals PII —á–µ—Ä–µ–∑ context (–¥–∞–∂–µ —Å —Ç–æ–∫–µ–Ω–∞–º–∏)

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
- Aggressive tokenization (IP-07 PII scrubbing)
- Semantic memory further abstracts (less detail)
- GDPR export includes all memory (transparency)
- User can delete specific episodes
- Regular privacy audit

### –†–∏—Å–∫ 6: Trauma Trigger False Negatives

**–û–ø–∏—Å–∞–Ω–∏–µ**: System fails to detect real trigger, user re-traumatized

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
- Conservative trigger detection (low threshold)
- Allow user to manually add triggers
- Monitor emotional response spikes –ø–æ—Å–ª–µ transitions
- Incident logging –¥–ª—è missed triggers
- Expert review pattern

### –†–∏—Å–∫ 7: Goal Tracking Demotivation

**–û–ø–∏—Å–∞–Ω–∏–µ**: Showing lack of progress demotivates users

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
- Positive framing ("–í—ã —Å–¥–µ–ª–∞–ª–∏ X —à–∞–≥–æ–≤" vs "–í—ã –Ω–µ –¥–æ—Å—Ç–∏–≥–ª–∏ Y")
- Celebrate small wins
- Normalize setbacks ("–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, —Ç–µ—Ä–∞–ø–∏—è –Ω–µ –ª–∏–Ω–µ–π–Ω–∞")
- Allow goal pause/modification
- Clinical oversight –¥–ª—è stuck users

### –†–∏—Å–∫ 8: Strategy Engine Override User Autonomy

**–û–ø–∏—Å–∞–Ω–∏–µ**: Too aggressive recommendations feel controlling

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
- Always present as suggestions, not commands
- User can decline/defer
- TRIZ Principle 13: Feedback ("–ß—Ç–æ –≤—ã –¥—É–º–∞–µ—Ç–µ?")
- Track acceptance rate (alert –µ—Å–ª–∏ low)
- Adjust tone based on user preferences

## –°–∞–º–æ–ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–ª–∞–Ω–∞

- [x] –ù–µ—Ç –∫–æ–¥–∞ –∏ –ø—Å–µ–≤–¥–æ–∫–æ–¥–∞ (—Ç–æ–ª—å–∫–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
- [x] –ó–∞–ø–æ–ª–Ω–µ–Ω—ã scope, acceptance criteria, risks, release plan
- [x] –§–∞–π–ª –∏–º–µ–Ω–æ–≤–∞–Ω —Å–æ–≥–ª–∞—Å–Ω–æ —Ñ–æ—Ä–º–∞—Ç—É IP-08-memory-profile-strategy.md
- [x] –ù–µ—Ç —É–ø–æ–º–∏–Ω–∞–Ω–∏–π —Å–µ–∫—Ä–µ—Ç–æ–≤ –∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö URL
- [x] –ü–æ–∫—Ä—ã—Ç—ã –≤—Å–µ gaps –∏–∑ GPTresolve.md (Memory, Profile, Strategy, Goal Tracking, Letter Integration)
- [x] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ IP (IP-01 KAG, IP-02 Letter Writing, IP-03 Emotional States, IP-05 Safety, IP-06 Evaluation, IP-07 Privacy)
- [x] Mermaid –¥–∏–∞–≥—Ä–∞–º–º—ã –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
- [x] –î–µ—Ç–∞–ª—å–Ω—ã–π flow –æ—Ç onboarding –¥–æ consolidation
- [x] –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏ (memory explosion, LLM hallucinations, readiness errors)
- [x] NFR, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, observability, release, –æ—Ç–∫–∞—Ç, —Ä–∏—Å–∫–∏ - –≤—Å–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ
- [x] JITAI, TRIZ, Trauma-Aware concepts –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã
