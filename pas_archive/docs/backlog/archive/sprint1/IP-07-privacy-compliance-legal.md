# IP-07: Privacy-First Architecture, Compliance & Legal Framework

## –°–º—ã—Å–ª –∏ —Ü–µ–ª—å –∑–∞–¥–∞—á–∏

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –∑–∞—â–∏—Ç—ã –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è (GDPR, 152-–§–ó) –∏ –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏—Ö –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤ –¥–ª—è —Ç–µ—Ä–∞–ø–µ–≤—Ç–∏—á–µ—Å–∫–æ–≥–æ —á–∞—Ç-–±–æ—Ç–∞. –¶–µ–ª—å - –æ–±–µ—Å–ø–µ—á–∏—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ client-side PII scrubbing, —Å–æ–±–ª—é–¥–µ–Ω–∏–µ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–≤ –∑–∞—â–∏—Ç—ã –¥–∞–Ω–Ω—ã—Ö, –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏—Ö —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤ (duty to warn, mandatory reporting), —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ–≥–ª–∞—Å–∏—è–º–∏ –∏ –ø—Ä–∞–≤–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –†–µ–∑—É–ª—å—Ç–∞—Ç - production-ready —Å–∏—Å—Ç–µ–º–∞, –∑–∞—â–∏—â–∞—é—â–∞—è sensitive mental health data –∏ –º–∏–Ω–∏–º–∏–∑–∏—Ä—É—é—â–∞—è —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –æ—Ç—á—É–∂–¥–∞–µ–º—ã–º–∏ —Ä–æ–¥–∏—Ç–µ–ª—è–º–∏ –≤ –∫—Ä–∏–∑–∏—Å–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏—è—Ö.

## –û–±—ä–µ–º —Ä–∞–±–æ—Ç

### –ß—Ç–æ –≤—Ö–æ–¥–∏—Ç –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é

- **Client-Side PII Scrubbing**: —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- **User UUID Mapping Service**: –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –¥–ª—è –∞–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **Zero PII Policy**: server-side –≤–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è PII –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö
- **GDPR Compliance Module**: —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞, —É–¥–∞–ª–µ–Ω–∏—è, –ø–æ—Ä—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
- **152-–§–ó Compliance**: —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ä–æ—Å—Å–∏–π—Å–∫–æ–º—É –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤—É –æ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **Clinical Legal Obligations**: duty to warn, mandatory reporting, informed consent
- **Consent Management System**: –≥—Ä–∞–Ω—É–ª—è—Ä–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–≥–ª–∞—Å–∏—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **Data Retention & Deletion**: –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏—è
- **Clinical Oversight Pipeline**: human therapist review –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤
- **Disaster Recovery & Incident Response**: –ø–ª–∞–Ω—ã —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ —É—Ç–µ—á–∫–∏ –∏ —Å–±–æ–∏
- **Terms of Service & Legal Disclaimers**: —é—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –∑–∞—â–∏—Ç–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ —Å–µ—Ä–≤–∏—Å–∞
- **Audit Logging**: tamper-proof –ª–æ–≥–∏ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å –¥–∞–Ω–Ω—ã–º–∏

### –ß—Ç–æ –Ω–µ –≤—Ö–æ–¥–∏—Ç

- –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–∞–∫ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–≥–æ –∏–∑–¥–µ–ª–∏—è (—Ç—Ä–µ–±—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞)
- Professional Liability Insurance (–ø–æ–∫—É–ø–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ, –Ω–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –æ–ø–∏—Å–∞–Ω—ã)
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ EHR —Å–∏—Å—Ç–µ–º–∞–º–∏
- –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è (—Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–∏—Ö —é—Ä–∏—Å—Ç–æ–≤)
- IRB approval process (–æ–ø–∏—Å–∞–Ω—ã —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è, –Ω–æ –ø—Ä–æ—Ü–µ—Å—Å –≤–Ω–µ—à–Ω–∏–π)
- –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–æ–≤ –≤ –∫–∞–∂–¥–æ–π —é—Ä–∏—Å–¥–∏–∫—Ü–∏–∏ (–æ–ø–∏—Å–∞–Ω –ø–æ–¥—Ö–æ–¥ –¥–ª—è –†–§)
- –ö—É–ª—å—Ç—É—Ä–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (—Ç–æ–ª—å–∫–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è, –Ω–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

```
src/
‚îú‚îÄ‚îÄ privacy/
‚îÇ   ‚îú‚îÄ‚îÄ client_side/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pii_scrubber.js              # Client-side —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è PII
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ local_storage_manager.js     # Encrypted local storage
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pii_patterns.yaml            # –ü–∞—Ç—Ç–µ—Ä–Ω—ã PII –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ encryption_utils.js          # AES-GCM —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ server_side/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pii_validator.py             # –í–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è PII
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ uuid_mapper.py               # User UUID mapping service
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ zero_pii_middleware.py       # FastAPI middleware
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ anonymization.py             # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∞–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ models/
‚îÇ       ‚îú‚îÄ‚îÄ pii_mapping.py               # Pydantic –º–æ–¥–µ–ª–∏ –¥–ª—è PII
‚îÇ       ‚îî‚îÄ‚îÄ token_schemas.yaml           # –°—Ö–µ–º—ã —Ç–æ–∫–µ–Ω–æ–≤
‚îú‚îÄ‚îÄ compliance/
‚îÇ   ‚îú‚îÄ‚îÄ gdpr/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ right_to_access.py           # Article 15: Data export
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ right_to_erasure.py          # Article 17: Deletion
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ right_to_portability.py      # Article 20: Data portability
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ consent_manager.py           # Article 7: Consent management
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ breach_notification.py       # Article 33: Breach reporting
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dpo_tools.py                 # Data Protection Officer tools
‚îÇ   ‚îú‚îÄ‚îÄ russia_152fz/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ data_classification.py       # –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –ü–î–Ω
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ localization_check.py        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ roskomnadzor_notify.py       # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –†–ö–ù
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ special_categories.py        # –û—Å–æ–±—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–∑–¥–æ—Ä–æ–≤—å–µ)
‚îÇ   ‚îú‚îÄ‚îÄ hipaa/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ phi_protection.py            # Protected Health Information
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ breach_notification.py       # HIPAA breach rules
‚îÇ   ‚îî‚îÄ‚îÄ consent/
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îú‚îÄ‚îÄ consent_database.py          # –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–≥–ª–∞—Å–∏–π
‚îÇ       ‚îú‚îÄ‚îÄ consent_withdrawal.py        # –û—Ç–∑—ã–≤ —Å–æ–≥–ª–∞—Å–∏–π
‚îÇ       ‚îî‚îÄ‚îÄ consent_versioning.py        # –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ T&C
‚îú‚îÄ‚îÄ clinical_legal/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ duty_to_warn.py                  # Tarasoff Rule implementation
‚îÇ   ‚îú‚îÄ‚îÄ mandatory_reporting.py           # Child abuse reporting
‚îÇ   ‚îú‚îÄ‚îÄ informed_consent.py              # Clinical informed consent
‚îÇ   ‚îú‚îÄ‚îÄ escalation_to_human.py           # –ü–µ—Ä–µ–¥–∞—á–∞ —á–µ–ª–æ–≤–µ–∫—É-—Ç–µ—Ä–∞–ø–µ–≤—Ç—É
‚îÇ   ‚îú‚îÄ‚îÄ clinical_oversight.py            # Human therapist review
‚îÇ   ‚îî‚îÄ‚îÄ liability_disclaimers.py         # Legal disclaimers
‚îú‚îÄ‚îÄ data_lifecycle/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ retention_policy.py              # –ü–æ–ª–∏—Ç–∏–∫–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ automated_deletion.py            # –ê–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ –ø–æ —Å—Ä–æ–∫–∞–º
‚îÇ   ‚îú‚îÄ‚îÄ backup_manager.py                # Encrypted backups
‚îÇ   ‚îî‚îÄ‚îÄ archive_service.py               # –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ security/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ encryption_at_rest.py            # AES-256 encryption
‚îÇ   ‚îú‚îÄ‚îÄ encryption_in_transit.py         # TLS 1.3 enforcement
‚îÇ   ‚îú‚îÄ‚îÄ access_control.py                # RBAC + MFA
‚îÇ   ‚îú‚îÄ‚îÄ audit_logger.py                  # Tamper-proof audit logs
‚îÇ   ‚îî‚îÄ‚îÄ incident_response.py             # Security incident handling
‚îú‚îÄ‚îÄ disaster_recovery/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ backup_strategy.py               # 3-2-1 backup rule
‚îÇ   ‚îú‚îÄ‚îÄ restore_procedures.py            # Restoration workflows
‚îÇ   ‚îú‚îÄ‚îÄ business_continuity.py           # Service continuity plan
‚îÇ   ‚îî‚îÄ‚îÄ incident_playbooks/              # Runbooks –¥–ª—è –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤
‚îÇ       ‚îú‚îÄ‚îÄ data_breach.md
‚îÇ       ‚îú‚îÄ‚îÄ service_outage.md
‚îÇ       ‚îî‚îÄ‚îÄ ransomware.md
‚îú‚îÄ‚îÄ legal/
‚îÇ   ‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ terms_of_service.md          # ToS —à–∞–±–ª–æ–Ω
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ privacy_policy.md            # Privacy Policy
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ informed_consent.md          # Clinical consent
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ data_processing_agreement.md # DPA –¥–ª—è vendors
‚îÇ   ‚îî‚îÄ‚îÄ liability/
‚îÇ       ‚îú‚îÄ‚îÄ disclaimers.py               # Legal disclaimers
‚îÇ       ‚îî‚îÄ‚îÄ insurance_requirements.yaml  # –°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ
‚îî‚îÄ‚îÄ config/
    ‚îú‚îÄ‚îÄ privacy_config.yaml              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è privacy
    ‚îú‚îÄ‚îÄ compliance_config.yaml           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è compliance
    ‚îî‚îÄ‚îÄ jurisdictions.yaml               # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —é—Ä–∏—Å–¥–∏–∫—Ü–∏—è–º
```

### –î–∏–∞–≥—Ä–∞–º–º–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

```mermaid
flowchart TB
    subgraph User_Device[User Device - Full Control]
        PIIMapping[PII Mapping<br/>Names, Addresses, etc.]
        LocalStorage[Encrypted Local Storage]
        PIIScrubber[PII Scrubber]
        EncryptionKey[Encryption Keys]
    end

    subgraph Edge_Layer[Edge Layer - Minimal Trust]
        UUIDMapper[UUID Mapping Service]
        PIIValidator[PII Validator Middleware]
        RateLimiter[Rate Limiter]
    end

    subgraph App_Layer[Application Layer - Zero PII]
        BESSERAgent[BESSER Agent]
        GuardianAgent[Content Guardian]
        ClinicalOversight[Clinical Oversight]
        DutyToWarn[Duty to Warn Protocol]
    end

    subgraph Storage_Layer[Storage Layer - Tokenized Only]
        KAG[KAG Graph DB]
        VectorDB[Vector Store]
        AnalyticsDB[Analytics DB]
        AuditLog[Audit Logs]
    end

    subgraph Compliance_Layer[Compliance Layer]
        GDPRModule[GDPR Rights Engine]
        Russia152FZ[152-–§–ó Module]
        ConsentMgr[Consent Manager]
        BreachNotify[Breach Notification]
    end

    subgraph Disaster_Recovery[Disaster Recovery]
        BackupSystem[Encrypted Backups<br/>3 Geo-locations]
        IncidentResponse[Incident Response]
        BusinessContinuity[Business Continuity Plan]
    end

    User_Device -->|Tokenized Data| PIIValidator
    PIIValidator -->|Validated| UUIDMapper
    UUIDMapper -->|Anonymous UUID| App_Layer
    App_Layer --> Storage_Layer
    Storage_Layer -.->|Compliance Queries| Compliance_Layer
    App_Layer -->|Crisis Detection| DutyToWarn
    Storage_Layer --> BackupSystem
    Compliance_Layer -->|User Request| GDPRModule
    GDPRModule -->|Data Export/Delete| Storage_Layer
```

## –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç–µ–∫–∞

- **–Ø–∑—ã–∫**: Python 3.12 (backend), JavaScript/TypeScript (client-side)
- **–§—Ä–µ–π–º–≤–æ—Ä–∫**: FastAPI –¥–ª—è compliance APIs, Telegram Mini App –¥–ª—è client-side
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**:
  - PostgreSQL –¥–ª—è UUID mapping (encrypted)
  - TimescaleDB –¥–ª—è audit logs (append-only)
  - Redis –¥–ª—è consent cache
- **Encryption**:
  - AES-256-GCM –¥–ª—è data at rest
  - TLS 1.3 –¥–ª—è data in transit
  - Fernet (Python cryptography library) –¥–ª—è field-level encryption
- **Access Control**: OAuth 2.0 + RBAC, MFA –¥–ª—è admin –¥–æ—Å—Ç—É–ø–∞
- **Audit**: Structured logging (JSON) + tamper-proof signatures
- **Backup**: Restic –¥–ª—è encrypted incremental backups
- **Monitoring**: Prometheus –¥–ª—è –º–µ—Ç—Ä–∏–∫ compliance, Grafana –¥–ª—è dashboards
- **–¶–µ–ª–µ–≤–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞**: Docker/Kubernetes, geo-distributed deployment

## –ü–æ–ª–Ω—ã–π flow —Ä–∞–±–æ—Ç—ã —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

### 1. –û–Ω–±–æ—Ä–¥–∏–Ω–≥ –∏ —Å–±–æ—Ä —Å–æ–≥–ª–∞—Å–∏–π

**User journey –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ:**

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞ /start
2. –ë–û–¢ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç welcome screen —Å –∫—Ä–∞—Ç–∫–∏–º –æ–ø–∏—Å–∞–Ω–∏–µ–º
3. –ë–û–¢ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç Informed Consent
   - –û–±—ä—è—Å–Ω—è–µ—Ç —á—Ç–æ –±–æ—Ç –ù–ï –∑–∞–º–µ–Ω–∞ —Ç–µ—Ä–∞–ø–µ–≤—Ç—É
   - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–µ—Ç –æ duty to warn (–ø—Ä–∏ —É–≥—Ä–æ–∑–µ –∂–∏–∑–Ω–∏ - –æ–±—è–∑–∞–Ω —É–≤–µ–¥–æ–º–∏—Ç—å –≤–ª–∞—Å—Ç–∏)
   - –û–±—ä—è—Å–Ω—è–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è AI
4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–≥–ª–∞—à–∞–µ—Ç—Å—è –∏–ª–∏ –æ—Ç–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è
   IF –æ—Ç–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è -> –∑–∞–≤–µ—Ä—à–∏—Ç—å –æ–Ω–±–æ—Ä–¥–∏–Ω–≥
   IF —Å–æ–≥–ª–∞—à–∞–µ—Ç—Å—è -> –ø–µ—Ä–µ—Ö–æ–¥ –∫ —à–∞–≥—É 5
5. –ë–û–¢ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç Privacy Policy
   - –û–±—ä—è—Å–Ω—è–µ—Ç client-side PII scrubbing
   - –û–±—ä—è—Å–Ω—è–µ—Ç —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –ù–ï –≤–∏–¥–∏—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞
   - –û–ø–∏—Å—ã–≤–∞–µ—Ç –ø—Ä–∞–≤–∞ GDPR/152-–§–ó
6. –ë–û–¢ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç granular consent:
   - [REQUIRED] –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ç–µ—Ä–∞–ø–µ–≤—Ç–∏—á–µ—Å–∫–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏
   - [OPTIONAL] –ê–Ω–æ–Ω–∏–º–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Ç–µ—Ä–∞–ø–∏–∏
   - [OPTIONAL] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–Ω–æ–Ω–∏–º–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π
7. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç —Å–æ–≥–ª–∞—Å–∏—è
8. –ë–û–¢ –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç PII mapping setup —á–µ—Ä–µ–∑ Mini App
   - Telegram –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç Mini App (WebView)
   - Mini App –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
     - –ò–º—è —Ä–µ–±–µ–Ω–∫–∞ -> —Å–æ–∑–¥–∞–µ—Ç —Ç–æ–∫–µ–Ω [CHILD_NAME]
     - –ò–º—è –±—ã–≤—à–µ–≥–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞ -> [EX_PARTNER_NAME]
     - –ì–æ—Ä–æ–¥ -> [CITY]
     - –ò —Ç.–¥.
   - Mini App –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç encryption key –∏–∑ –ø–∞—Ä–æ–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - Mini App —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç PII mapping –ª–æ–∫–∞–ª—å–Ω–æ (encrypted)
9. UUID Mapping Service —Å–æ–∑–¥–∞–µ—Ç anonymous UUID –¥–ª—è telegram_id
10. Consent Manager —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ–≥–ª–∞—Å–∏—è —Å timestamp
11. Audit Logger –ª–æ–≥–∏—Ä—É–µ—Ç —Å–æ–±—ã—Ç–∏–µ onboarding_completed
```

### 2. Real-time PII Scrubbing –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è

**Flow –∫–∞–∂–¥–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**

```
[USER DEVICE]
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç: "–ú–æ—è –¥–æ—á—å –ú–∞—à–∞, 8 –ª–µ—Ç, –∂–∏–≤–µ—Ç —Å –º–∞—Ç–µ—Ä—å—é –ï–ª–µ–Ω–æ–π –≤ –ú–æ—Å–∫–≤–µ"
2. PIIScrubber.scrubOutgoing() –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç:
   - "–ú–∞—à–∞" -> [CHILD_NAME]
   - "–ï–ª–µ–Ω–æ–π" -> [EX_PARTNER_NAME]
   - "–ú–æ—Å–∫–≤–µ" -> [CITY]
3. Scrubbed text: "–ú–æ—è –¥–æ—á—å [CHILD_NAME], 8 –ª–µ—Ç, –∂–∏–≤–µ—Ç —Å –º–∞—Ç–µ—Ä—å—é [EX_PARTNER_NAME] –≤ [CITY]"
4. –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ HTTPS (TLS 1.3)

[EDGE LAYER]
5. PIIValidatorMiddleware.validate_request():
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ email patterns
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ phone patterns
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ passport numbers
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ addresses
   IF –æ–±–Ω–∞—Ä—É–∂–µ–Ω PII:
     - Reject request (400 Bad Request)
     - Log critical alert: PII_DETECTED
     - –ù–ï –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å —Å–∞–º PII!
   ELSE:
     - Proceed to next layer
6. UUIDMapper.get_uuid(telegram_id):
   - –ü–æ–ª—É—á–∏—Ç—å anonymous UUID –∏–∑ encrypted mapping DB
   - –ó–∞–º–µ–Ω–∏—Ç—å telegram_id –Ω–∞ UUID –≤ request context

[APPLICATION LAYER]
7. BESSERAgent –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Ç–æ–∫–µ–Ω–∞–º–∏
8. LLM –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç (—Ç–æ–∂–µ —Å —Ç–æ–∫–µ–Ω–∞–º–∏):
   "–Ø –ø–æ–Ω–∏–º–∞—é –≤–∞—à—É –±–æ–ª—å. [CHILD_NAME] –≤–∞–∂–µ–Ω –¥–ª—è –≤–∞—Å.
    –î–∞–∂–µ –µ—Å–ª–∏ —Å–µ–π—á–∞—Å [EX_PARTNER_NAME] –Ω–µ –¥–∞–µ—Ç –≤–∏–¥–µ—Ç—å—Å—è..."

[STORAGE LAYER]
9. KAG —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–∏–∞–ª–æ–≥:
   - user_uuid: "550e8400-e29b-41d4-a716-446655440000"
   - message: "–ú–æ—è –¥–æ—á—å [CHILD_NAME], 8 –ª–µ—Ç..."
   - response: "–Ø –ø–æ–Ω–∏–º–∞—é –≤–∞—à—É –±–æ–ª—å. [CHILD_NAME] –≤–∞–∂–µ–Ω..."
   - –ù–ï–¢ –†–ï–ê–õ–¨–ù–´–• –ò–ú–ï–ù!

[BACK TO USER]
10. –û—Ç–≤–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
11. PIIScrubber.descrubIncoming():
    - [CHILD_NAME] -> "–ú–∞—à–∞"
    - [EX_PARTNER_NAME] -> "–ï–ª–µ–Ω–∞"
12. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏
```

### 3. GDPR Right to Access (–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö)

**Flow –∑–∞–ø—Ä–æ—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º —Å–≤–æ–∏—Ö –¥–∞–Ω–Ω—ã—Ö:**

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: /my_data
2. –ë–û–¢ –æ–±—ä—è—Å–Ω—è–µ—Ç –ø—Ä–∞–≤–æ –Ω–∞ –¥–æ—Å—Ç—É–ø (GDPR Article 15)
3. –ë–û–¢ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
4. RightToAccessHandler.export_user_data(user_uuid):
   a. –°–æ–±—Ä–∞—Ç—å profile data
   b. –°–æ–±—Ä–∞—Ç—å –≤—Å–µ letters –∏–∑ KAG
   c. –°–æ–±—Ä–∞—Ç—å conversation history
   d. –°–æ–±—Ä–∞—Ç—å analytics (emotional trajectories, therapy progress)
   e. –°–æ–±—Ä–∞—Ç—å consent history
   f. –°–æ–±—Ä–∞—Ç—å audit logs (–∫—Ç–æ –∏ –∫–æ–≥–¥–∞ –æ–±—Ä–∞—â–∞–ª—Å—è –∫ –¥–∞–Ω–Ω—ã–º)
5. DataExporter.create_export_package():
   - –§–æ—Ä–º–∞—Ç: JSON (machine-readable)
   - –í–∫–ª—é—á–∏—Ç—å metadata: export_date, schema_version
   - –î–æ–±–∞–≤–∏—Ç—å human-readable summary
6. Encrypt export package —Å –ø–∞—Ä–æ–ª–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
7. Upload –≤ temporary storage (expires in 7 days)
8. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é download link
9. Audit Logger: data_export_request completed
10. Notification Roskomnadzor (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ 152-–§–ó)
```

### 4. GDPR Right to Erasure (–£–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö)

**Flow "right to be forgotten":**

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: /delete_my_data
2. –ë–û–¢ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç WARNING:
   "‚ö†Ô∏è –≠–¢–û –£–î–ê–õ–ò–¢ –í–°–ï –í–ê–®–ò –î–ê–ù–ù–´–ï –ù–ê–í–°–ï–ì–î–ê
   - –í—Å–µ –ø–∏—Å—å–º–∞ —Ä–µ–±–µ–Ω–∫—É
   - –ò—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–æ–≤
   - –ü—Ä–æ–≥—Ä–µ—Å—Å —Ç–µ—Ä–∞–ø–∏–∏
   - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ

   –í—ã —É–≤–µ—Ä–µ–Ω—ã? –ù–∞–ø–∏—à–∏—Ç–µ '–£–î–ê–õ–ò–¢–¨ –ù–ê–í–°–ï–ì–î–ê'"
3. IF –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç:
4. RightToErasureHandler.delete_user_data(user_uuid):
   a. Delete from KAG (–≤—Å–µ nodes —Å user_uuid)
   b. Delete from Vector Store (embeddings)
   c. Delete from Analytics DB
   d. Delete from Profile Store
   e. Delete from UUID Mapping DB (—Ä–∞–∑—Ä—ã–≤ —Å–≤—è–∑–∏ telegram_id <-> UUID)
   f. Mark audit logs as "user_deleted" (—Å–∞–º–∏ –ª–æ–≥–∏ –æ—Å—Ç–∞—é—Ç—Å—è –¥–ª—è compliance)
   g. Schedule backup erasure (—É–¥–∞–ª–∏—Ç—å –∏–∑ backups –≤ —Ç–µ—á–µ–Ω–∏–µ 30 –¥–Ω–µ–π)
5. ConsentManager.revoke_all_consents(user_uuid)
6. Send confirmation: "‚úÖ –í—Å–µ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ —É–¥–∞–ª–µ–Ω—ã"
7. Audit Logger: right_to_erasure_executed
8. Notification Roskomnadzor (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è)
9. Blacklist telegram_id –≤—Ä–µ–º–µ–Ω–Ω–æ (prevent immediate re-registration with same ID)
```

### 5. Duty to Warn Protocol (–ö–ª–∏–Ω–∏—á–µ—Å–∫–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞)

**Flow –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ —É–≥—Ä–æ–∑—ã –∂–∏–∑–Ω–∏:**

```
[DETECTION PHASE]
1. User message: "–ù–µ —Ö–æ—á—É –±–æ–ª—å—à–µ –∂–∏—Ç—å. –ü–æ–∫–æ–Ω—á—É —Å —Å–æ–±–æ–π —Å–µ–≥–æ–¥–Ω—è –≤–µ—á–µ—Ä–æ–º."
2. SuicidalDetector (–∏–∑ IP-05) –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç HIGH RISK
3. DutyToWarnProtocol.assess_imminent_danger():
   - Imminent: TRUE (—Å–µ–≥–æ–¥–Ω—è –≤–µ—á–µ—Ä–æ–º)
   - Plan: TRUE
   - Means: UNKNOWN
   - Intent: HIGH
   Result: CRITICAL RISK

[IMMEDIATE INTERVENTION]
4. –ë–û–¢ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –æ—Ç–≤–µ—á–∞–µ—Ç:
   "üö® –ú–ù–ï –û–ß–ï–ù–¨ –í–ê–ñ–ù–û, –ß–¢–û–ë–´ –í–´ –ë–´–õ–ò –í –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò.

   –ü–†–Ø–ú–û –°–ï–ô–ß–ê–° –ø–æ–∑–≤–æ–Ω–∏—Ç–µ:
   üìû 112 (—ç–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ —Å–ª—É–∂–±—ã)
   üìû 8-800-2000-122 (–ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –ø–æ–º–æ—â—å 24/7)

   –Ø –æ—Å—Ç–∞—é—Å—å —Å –≤–∞–º–∏. –ù–∞–ø–∏—à–∏—Ç–µ –º–Ω–µ –ø–æ—Å–ª–µ –∑–≤–æ–Ω–∫–∞."

[LEGAL OBLIGATION PHASE]
5. DutyToWarnProtocol.check_legal_obligations():
   IF jurisdiction == "USA":
     - Tarasoff Rule applies
     - MUST warn authorities if threat to others
   IF jurisdiction == "Russia":
     - –°–ª–æ–∂–Ω–µ–µ, –Ω—É–∂–Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è —é—Ä–∏—Å—Ç–∞
     - –í–æ–∑–º–æ–∂–Ω–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —ç–∫—Å—Ç—Ä–µ–Ω–Ω—ã—Ö —Å–ª—É–∂–±

6. IF imminent_danger AND (threat_to_self OR threat_to_others):
   - Log critical incident (encrypted)
   - Escalate to ClinicalOversightTeam
   - IF threat_to_others:
       - De-anonymize user (UUID -> telegram_id) ONLY for this purpose
       - Notify authorities (—á–µ—Ä–µ–∑ ClinicalOversightTeam, –Ω–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
   - IF threat_to_self:
       - Schedule immediate human follow-up
       - Activate check-in protocol (every 2 hours)

[HUMAN OVERSIGHT]
7. ClinicalOversightTeam receives alert:
   - Licensed therapist reviews situation
   - Decides on escalation to authorities
   - Contacts user directly (if possible)
   - Documents decision in audit log

[AUDIT]
8. AuditLogger.log_duty_to_warn_event(
     user_uuid,
     risk_level,
     action_taken,
     therapist_id,
     outcome
   )
```

### 6. Mandatory Reporting (–ù–∞—Å–∏–ª–∏–µ –Ω–∞–¥ –¥–µ—Ç—å–º–∏)

**Flow –ø—Ä–∏ –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–∏ –Ω–∞ child abuse:**

```
[DETECTION]
1. User message —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –Ω–∞—Å–∏–ª–∏—è –Ω–∞–¥ —Ä–µ–±–µ–Ω–∫–æ–º
2. ChildAbuseDetector.analyze(message):
   - Physical abuse indicators
   - Sexual abuse indicators
   - Neglect indicators
   - Severity: HIGH/MEDIUM/LOW

[LEGAL OBLIGATION]
3. MandatoryReportingProtocol.check_requirements():
   IF severity == HIGH:
     - MUST report to Child Protective Services
     - Legal obligation –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —é—Ä–∏—Å–¥–∏–∫—Ü–∏–π

4. Escalate to ClinicalOversightTeam (human decision)
5. Licensed therapist reviews:
   - Assess credibility of indicators
   - Determine if mandatory reporting threshold met
   - IF YES:
       - De-anonymize user
       - File report with CPS/–û—Ä–≥–∞–Ω—ã –æ–ø–µ–∫–∏
       - Document in audit log
       - Notify user (post-factum)

[NOTIFICATION TO USER]
6. –ë–û–¢ —É–≤–µ–¥–æ–º–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
   "–í —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –∑–∞–∫–æ–Ω–æ–º, —è –æ–±—è–∑–∞–Ω —Å–æ–æ–±—â–∏—Ç—å –æ –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–∏
   –Ω–∞ –Ω–∞—Å–∏–ª–∏–µ –Ω–∞–¥ —Ä–µ–±–µ–Ω–∫–æ–º –≤ –æ—Ä–≥–∞–Ω—ã –æ–ø–µ–∫–∏. –≠—Ç–æ —Å–¥–µ–ª–∞–Ω–æ –¥–ª—è
   –∑–∞—â–∏—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Ä–µ–±–µ–Ω–∫–∞."

[AUDIT]
7. AuditLogger.log_mandatory_reporting(
     user_uuid,
     report_date,
     agency_notified,
     therapist_id
   )
```

### 7. Security Incident Response (–£—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö)

**Flow –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ data breach:**

```
[DETECTION]
1. Monitoring system detects anomaly:
   - Unusual data access patterns
   - Failed authentication attempts spike
   - Unauthorized database query
2. IncidentResponseSystem.trigger_alert(severity=CRITICAL)

[CONTAINMENT]
3. AutomatedContainment.execute():
   - Isolate affected systems
   - Revoke compromised credentials
   - Block suspicious IPs
   - Enable extra logging
4. Notify Security Team (on-call rotation)

[INVESTIGATION]
5. SecurityTeam investigates:
   - Scope of breach (which data accessed?)
   - Attack vector (how did it happen?)
   - Duration (when did it start?)
   - Data exfiltrated? (yes/no)
6. Document findings in incident report

[NOTIFICATION - GDPR Article 33]
7. IF personal data compromised:
   BreachNotificationEngine.notify_authorities():
   - Notify DPA (Data Protection Authority) within 72 hours
   - Russia: Notify Roskomnadzor within 24 hours
   - Document: nature of breach, data affected, measures taken

[USER NOTIFICATION - GDPR Article 34]
8. IF high risk to users:
   BreachNotificationEngine.notify_users():
   - Email/Telegram message to affected users within 72 hours
   - Describe: what happened, what data, what we're doing
   - Offer: credit monitoring (if financial data), support

[RECOVERY]
9. RestoreFromBackup.execute():
   - Restore systems from clean backups
   - Patch vulnerabilities
   - Reset all credentials
   - Enable additional security measures

[POST-MORTEM]
10. PublicIncidentReport.publish():
    - Anonymized summary of incident
    - Lessons learned
    - Improvements implemented
11. AuditLogger.log_security_incident(full details)
```

### 8. Consent Withdrawal (–û—Ç–∑—ã–≤ —Å–æ–≥–ª–∞—Å–∏—è)

**Flow –æ—Ç–∑—ã–≤–∞ —Å–æ–≥–ª–∞—Å–∏—è –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É:**

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: /settings -> Manage Consents
2. –ë–û–¢ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â–∏–µ consent statuses:
   ‚úÖ –¢–µ—Ä–∞–ø–µ–≤—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
   ‚úÖ –ê–Ω–æ–Ω–∏–º–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
   ‚ùå –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è (–Ω–µ –¥–∞–Ω–æ)
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –æ—Ç–æ–∑–≤–∞—Ç—å "–ê–Ω–æ–Ω–∏–º–Ω—ã–π –∞–Ω–∞–ª–∏–∑"
4. ConsentManager.withdraw_consent(
     user_uuid,
     purpose="analytics"
   ):
   - Update consent_database
   - Timestamp withdrawal
   - Version consent (–¥–ª—è audit)
5. DataProcessor.stop_processing(user_uuid, "analytics"):
   - Exclude user data from analytics aggregations
   - Mark existing analytics as "consent_withdrawn"
6. Audit Logger: consent_withdrawn
7. –ë–û–¢ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç:
   "‚úÖ –°–æ–≥–ª–∞—Å–∏–µ –Ω–∞ –∞–Ω–æ–Ω–∏–º–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –æ—Ç–æ–∑–≤–∞–Ω–æ.
   –í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –±–æ–ª—å—à–µ –Ω–µ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è —ç—Ç–æ–π —Ü–µ–ª–∏."
```

## API –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã

### PIIScrubber (Client-Side JavaScript)

**initialize()**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è PII mapping –ø—Ä–∏ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–µ
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: –Ω–µ—Ç
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: Promise<void>
- –ü—Ä–æ—Ü–µ—Å—Å: –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è PII, —Å–æ–∑–¥–∞–µ—Ç —Ç–æ–∫–µ–Ω—ã, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç encrypted mapping –ª–æ–∫–∞–ª—å–Ω–æ

**scrubOutgoing(text: string)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –∑–∞–º–µ–Ω–∞ PII –Ω–∞ —Ç–æ–∫–µ–Ω—ã –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `text` - –∏—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å PII
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: string (tokenized text)
- –õ–æ–≥–∏–∫–∞: –ø—Ä–∏–º–µ–Ω—è–µ—Ç regex replacements –¥–ª—è –≤—Å–µ—Ö known PII + auto-detection

**descrubIncoming(text: string)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ PII –≤ –æ—Ç–≤–µ—Ç–µ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `text` - —Ç–µ–∫—Å—Ç —Å —Ç–æ–∫–µ–Ω–∞–º–∏ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: string (personalized text)
- –õ–æ–≥–∏–∫–∞: –æ–±—Ä–∞—Ç–Ω–∞—è –∑–∞–º–µ–Ω–∞ —Ç–æ–∫–µ–Ω–æ–≤ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ mapping

**autoDetectPII(text: string)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–µ—Ç–µ–∫—Ü–∏—è PII –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ (email, phone, addresses)
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `text` - —Ç–µ–∫—Å—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: Array<PIIMatch> (detected PII with positions)

### PIIValidator (Server-Side Python)

**validate_request(request_body: dict)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: server-side –≤–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è PII
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `request_body` - —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: ValidationResult (valid: bool, issues: List[str])
- –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏: –µ—Å–ª–∏ PII –æ–±–Ω–∞—Ä—É–∂–µ–Ω - reject request

**detect_pii_patterns(text: str)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –¥–µ—Ç–µ–∫—Ü–∏—è forbidden patterns (–∏–º–µ–Ω–∞, email, —Ç–µ–ª–µ—Ñ–æ–Ω—ã, –ø–∞—Å–ø–æ—Ä—Ç–∞)
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `text` - —Ç–µ–∫—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: List[PIIDetection]

### UUIDMapper

**get_or_create_uuid(telegram_id: int)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ø–æ–ª—É—á–∏—Ç—å anonymous UUID –¥–ª—è telegram_id
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `telegram_id` - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Telegram
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: str (UUID)
- –õ–æ–≥–∏–∫–∞: –ø—Ä–æ–≤–µ—Ä—è–µ—Ç existing mapping, –µ—Å–ª–∏ –Ω–µ—Ç - —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π UUID

**deanonymize(user_uuid: str, reason: str, authorized_by: str)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –¥–µ-–∞–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏—è –¢–û–õ–¨–ö–û –¥–ª—è legal obligations
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `user_uuid` - –∞–Ω–æ–Ω–∏–º–Ω—ã–π UUID
  - `reason` - –ø—Ä–∏—á–∏–Ω–∞ (duty_to_warn, mandatory_reporting, court_order)
  - `authorized_by` - –∫—Ç–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–ª (therapist_id, admin_id)
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: int (telegram_id)
- –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏: –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –¥–ª—è authorized roles, –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –≤ audit

### RightToAccessHandler

**export_user_data(user_uuid: str)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: —ç–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (GDPR Article 15)
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `user_uuid` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: ExportPackage (JSON + metadata)
- –õ–æ–≥–∏–∫–∞: —Å–æ–±–∏—Ä–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –≤—Å–µ—Ö —Ö—Ä–∞–Ω–∏–ª–∏—â, —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –≤ machine-readable JSON

### RightToErasureHandler

**delete_user_data(user_uuid: str)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ø–æ–ª–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (GDPR Article 17)
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `user_uuid` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: DeletionReport (—á—Ç–æ —É–¥–∞–ª–µ–Ω–æ, timestamp)
- –õ–æ–≥–∏–∫–∞: —É–¥–∞–ª—è–µ—Ç –∏–∑ –≤—Å–µ—Ö –ë–î, schedules backup erasure, revokes consents

### ConsentManager

**record_consent(user_uuid: str, purposes: List[str], version: str)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –∑–∞–ø–∏—Å—å —Å–æ–≥–ª–∞—Å–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `user_uuid` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - `purposes` - —Å–ø–∏—Å–æ–∫ —Ü–µ–ª–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ (therapy_support, analytics, research)
  - `version` - –≤–µ—Ä—Å–∏—è T&C/Privacy Policy
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: consent_id

**withdraw_consent(user_uuid: str, purpose: str)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –æ—Ç–∑—ã–≤ —Å–æ–≥–ª–∞—Å–∏—è –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —Ü–µ–ª—å
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `user_uuid` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
  - `purpose` - —Ü–µ–ª—å –¥–ª—è –æ—Ç–∑—ã–≤–∞
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: success: bool

**check_consent(user_uuid: str, purpose: str)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Å–æ–≥–ª–∞—Å–∏—è –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `user_uuid` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
  - `purpose` - —Ü–µ–ª—å –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: bool (consented or not)

### DutyToWarnProtocol

**assess_imminent_danger(message: str, context: dict)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –æ—Ü–µ–Ω–∫–∞ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ–π —É–≥—Ä–æ–∑—ã –∂–∏–∑–Ω–∏
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `message` - —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - `context` - –∏—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞, risk scores
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: DangerAssessment (imminent: bool, threat_type: str, severity: float)

**execute_protocol(user_uuid: str, assessment: DangerAssessment)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ duty to warn –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `user_uuid` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - `assessment` - —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ü–µ–Ω–∫–∏ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: ProtocolResult (actions_taken: List[str])
- –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏: –º–æ–∂–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å –¥–µ-–∞–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏–∏, –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –≤ audit

### MandatoryReportingProtocol

**assess_child_abuse_indicators(message: str)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –æ—Ü–µ–Ω–∫–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –Ω–∞—Å–∏–ª–∏—è –Ω–∞–¥ —Ä–µ–±–µ–Ω–∫–æ–º
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `message` - —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: AbuseAssessment (indicators: List[str], severity: str)

**file_report(user_uuid: str, assessment: AbuseAssessment, therapist_id: str)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ø–æ–¥–∞—á–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –æ—Ä–≥–∞–Ω—ã –æ–ø–µ–∫–∏ (–≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è human oversight)
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `user_uuid` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - `assessment` - –æ—Ü–µ–Ω–∫–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
  - `therapist_id` - ID —Ç–µ—Ä–∞–ø–µ–≤—Ç–∞, –ø—Ä–∏–Ω—è–≤—à–µ–≥–æ —Ä–µ—à–µ–Ω–∏–µ
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: ReportConfirmation (report_id, agency, timestamp)

### BreachNotificationEngine

**notify_authorities(incident: SecurityIncident)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Ä–µ–≥—É–ª—è—Ç–æ—Ä–æ–≤ –æ —É—Ç–µ—á–∫–µ (GDPR/152-–§–ó)
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `incident` - –¥–µ—Ç–∞–ª–∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: NotificationStatus (sent_to: List[str], timestamps: dict)
- –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏: MUST complete within 72h (GDPR) / 24h (152-–§–ó)

**notify_affected_users(incident: SecurityIncident, affected_uuids: List[str])**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `incident` - –¥–µ—Ç–∞–ª–∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞
  - `affected_uuids` - —Å–ø–∏—Å–æ–∫ –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: UserNotificationReport

### AuditLogger

**log_event(event_type: str, user_uuid: str, details: dict, actor: str)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: tamper-proof –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `event_type` - —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è (data_access, consent_change, deletion, etc.)
  - `user_uuid` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - `details` - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏ (JSON)
  - `actor` - –∫—Ç–æ –≤—ã–ø–æ–ª–Ω–∏–ª (system, admin_id, therapist_id)
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: log_id
- –õ–æ–≥–∏–∫–∞: append-only, cryptographic signatures –¥–ª—è tamper detection

**query_audit_trail(user_uuid: str, start_date: datetime, end_date: datetime)**
- –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ø–æ–ª—É—á–µ–Ω–∏–µ audit trail –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
  - `user_uuid` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
  - `start_date` - –Ω–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞
  - `end_date` - –∫–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: List[AuditEvent]

## –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### Privacy Flow (Message Send/Receive)

```
User writes message with PII
  |
  v
PIIScrubber.scrubOutgoing() [CLIENT]
  |
  v
HTTPS POST to /api/chat [TRANSPORT]
  |
  v
PIIValidator.validate_request() [EDGE]
  |
  +---> IF PII detected: REJECT (400)
  |
  +---> IF valid: proceed
  |
  v
UUIDMapper.get_uuid(telegram_id) [EDGE]
  |
  v
BESSERAgent.process(message, user_uuid) [APP]
  |
  v
KAG.store(conversation, user_uuid) [STORAGE]
  |
  v
Response with tokens
  |
  v
PIIScrubber.descrubIncoming() [CLIENT]
  |
  v
User sees personalized response
```

### GDPR Rights Flow (Data Export)

```
User requests /my_data
  |
  v
ConsentManager.check_consent(user_uuid, "data_access")
  |
  +---> IF not consented: explain rights
  |
  +---> IF consented: proceed
  |
  v
RightToAccessHandler.export_user_data(user_uuid)
  |
  +---> Query KAG for letters
  +---> Query VectorDB for embeddings
  +---> Query AnalyticsDB for insights
  +---> Query ConsentDB for consent history
  +---> Query AuditLog for access history
  |
  v
DataExporter.create_package(all_data)
  |
  v
Encrypt with user password
  |
  v
Upload to temporary storage
  |
  v
Send download link to user
  |
  v
AuditLogger.log_event("data_export_completed")
```

### Duty to Warn Flow

```
User sends high-risk message
  |
  v
SuicidalDetector.detect() [from IP-05]
  |
  v
DutyToWarnProtocol.assess_imminent_danger()
  |
  +---> IF CRITICAL:
        |
        +---> Immediate crisis response message
        +---> Escalate to ClinicalOversightTeam
        +---> IF threat_to_others:
              |
              +---> UUIDMapper.deanonymize(user_uuid, "duty_to_warn", therapist_id)
              +---> Human therapist reviews
              +---> IF confirmed: notify authorities
        |
        +---> AuditLogger.log_event("duty_to_warn_executed")
```

### Security Incident Flow

```
Monitoring detects anomaly
  |
  v
IncidentResponseSystem.trigger_alert()
  |
  v
AutomatedContainment.isolate_systems()
  |
  v
SecurityTeam investigates
  |
  v
IF personal_data_compromised:
  |
  +---> BreachNotificationEngine.notify_authorities() [within 72h]
  +---> BreachNotificationEngine.notify_users() [if high risk]
  |
  v
RestoreFromBackup.execute()
  |
  v
PostMortem.publish_report()
  |
  v
AuditLogger.log_event("security_incident", details)
```

## –ü–æ—Ä—è–¥–æ–∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –≠—Ç–∞–ø 1: Client-Side Privacy Foundation

1. **PII Scrubber (JavaScript)**
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—ã–µ regex patterns –¥–ª—è –∏–º–µ–Ω, –∞–¥—Ä–µ—Å–æ–≤, —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤
   - Local storage —Å AES-GCM encryption
   - scrubOutgoing/descrubIncoming —Ñ—É–Ω–∫—Ü–∏–∏

2. **Telegram Mini App –¥–ª—è PII Setup**
   - UI –¥–ª—è —Å–±–æ—Ä–∞ PII –ø—Ä–∏ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–µ
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤
   - Encrypted storage –≤ Telegram Storage API

3. **Auto-detection PII**
   - Email patterns
   - Phone patterns (Russian format)
   - Address patterns

### –≠—Ç–∞–ø 2: Server-Side Zero PII Enforcement

4. **PIIValidator Middleware**
   - FastAPI middleware –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Å–µ—Ö requests
   - Forbidden patterns detection
   - Reject logic + critical logging

5. **UUID Mapping Service**
   - –û—Ç–¥–µ–ª—å–Ω—ã–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å (isolated database)
   - Encrypted PostgreSQL –¥–ª—è mapping
   - get_or_create_uuid API
   - RBAC –¥–ª—è –¥–æ—Å—Ç—É–ø–∞

6. **Integration —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –∞–≥–µ–Ω—Ç–∞–º–∏**
   - –ó–∞–º–µ–Ω–∞ telegram_id –Ω–∞ user_uuid –≤–æ –≤—Å–µ—Ö API
   - Update KAG queries –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å UUID

### –≠—Ç–∞–ø 3: GDPR Compliance

7. **ConsentManager**
   - Consent database schema
   - record_consent / withdraw_consent
   - Versioning consent (–¥–ª—è audit)

8. **Right to Access**
   - Data export —Ñ—É–Ω–∫—Ü–∏—è
   - JSON formatting
   - Encryption —ç–∫—Å–ø–æ—Ä—Ç–∞

9. **Right to Erasure**
   - Cascade deletion –∏–∑ –≤—Å–µ—Ö –ë–î
   - Backup erasure scheduling
   - Audit trail preservation

10. **Right to Portability**
    - Machine-readable —Ñ–æ—Ä–º–∞—Ç (JSON)
    - Schema documentation

### –≠—Ç–∞–ø 4: Clinical Legal Obligations

11. **Duty to Warn Protocol**
    - Integration —Å SuicidalDetector (IP-05)
    - Escalation to human workflow
    - De-anonymization –¥–ª—è emergencies
    - Audit logging

12. **Mandatory Reporting**
    - Child abuse indicators detection
    - Human oversight pipeline
    - Reporting workflow (manual approval)

13. **Informed Consent UI**
    - Onboarding consent flow
    - Disclaimers (not a therapist, AI limitations)
    - Crisis protocol explanation

### –≠—Ç–∞–ø 5: Security & Compliance

14. **AuditLogger**
    - Append-only TimescaleDB
    - Cryptographic signatures
    - Tamper detection

15. **Encryption at Rest**
    - Field-level encryption –¥–ª—è sensitive fields
    - Key rotation mechanism

16. **Access Control**
    - RBAC implementation
    - MFA for admin access
    - Session management

### –≠—Ç–∞–ø 6: Disaster Recovery

17. **Backup System**
    - Automated encrypted backups (Restic)
    - 3 geo-distributed locations
    - Monthly restore drills

18. **Incident Response Playbooks**
    - Data breach runbook
    - Service outage runbook
    - Ransomware runbook

19. **Breach Notification Engine**
    - Template messages –¥–ª—è authorities
    - Template messages –¥–ª—è users
    - Deadline tracking (72h GDPR, 24h 152-–§–ó)

### –≠—Ç–∞–ø 7: Legal Documentation

20. **Terms of Service**
    - Disclaimers (not professional therapy)
    - Limitation of liability
    - Duty to warn disclosure

21. **Privacy Policy**
    - GDPR/152-–§–ó compliant
    - Plain language explanation
    - User rights enumeration

22. **Data Processing Agreements**
    - Templates –¥–ª—è vendors (LLM providers, hosting)

## –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏

### 1. PII Leak —á–µ—Ä–µ–∑ LLM Context

**–°–∏—Ç—É–∞—Ü–∏—è**: LLM —Å–ª—É—á–∞–π–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–µ –∏–º—è –≤–º–µ—Å—Ç–æ —Ç–æ–∫–µ–Ω–∞

**–û–±—Ä–∞–±–æ—Ç–∫–∞**:
- PIIValidator –Ω–∞ response —Ç–æ–∂–µ
- If LLM output —Å–æ–¥–µ—Ä–∂–∏—Ç potential PII -> regenerate with stronger prompt
- Log incident –¥–ª—è review
- Re-train —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö —Ç–æ–∫–µ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤

### 2. User Forgets Encryption Password

**–°–∏—Ç—É–∞—Ü–∏—è**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±—ã–ª –ø–∞—Ä–æ–ª—å –¥–ª—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ PII mapping

**–û–±—Ä–∞–±–æ—Ç–∫–∞**:
- –ù–ï–¢ RECOVERY (by design - privacy-first)
- –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ PII mapping
- –°—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –æ—Å—Ç–∞—é—Ç—Å—è —Å —Ç–æ–∫–µ–Ω–∞–º–∏ (–Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –¥–µ-—Ç–æ–∫–µ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã)
- –≠—Ç–æ feature, not bug - –¥–∞–∂–µ –º—ã –Ω–µ –º–æ–∂–µ–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å PII

### 3. Conflict –º–µ–∂–¥—É Duty to Warn –∏ Privacy

**–°–∏—Ç—É–∞—Ü–∏—è**: Duty to warn —Ç—Ä–µ–±—É–µ—Ç –¥–µ-–∞–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏–∏, –Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–æ–∑–≤–∞–ª —Å–æ–≥–ª–∞—Å–∏–µ

**–û–±—Ä–∞–±–æ—Ç–∫–∞**:
- Legal obligation –ø–µ—Ä–µ–≤–µ—à–∏–≤–∞–µ—Ç consent
- De-anonymize –¥–ª—è duty to warn
- Log –≤ audit —Å –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ–º (legal_obligation override)
- Notify user post-factum
- Seek legal counsel –¥–ª—è jurisdiction-specific guidance

### 4. GDPR Right to Erasure vs Audit Logs

**–°–∏—Ç—É–∞—Ü–∏—è**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —É–¥–∞–ª–µ–Ω–∏–µ, –Ω–æ audit logs —Ç—Ä–µ–±—É—é—Ç—Å—è –ø–æ –∑–∞–∫–æ–Ω—É

**–û–±—Ä–∞–±–æ—Ç–∫–∞**:
- Delete all operational data (letters, conversations, analytics)
- Retain minimal audit logs (only what required by law):
  - Pseudonymized (user_uuid, –Ω–æ –±–µ–∑ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ de-anonymization)
  - Limited retention (6 years max)
  - Mark as "user_deleted" –≤ audit log
- Legal basis: GDPR Article 17(3)(b) - legal obligation to retain

### 5. Breach Notification Deadline Missed

**–°–∏—Ç—É–∞—Ü–∏—è**: –ù–µ —É–ª–æ–∂–∏–ª–∏—Å—å –≤ 72h –¥–ª—è GDPR notification

**–û–±—Ä–∞–±–æ—Ç–∫–∞**:
- Notify DPA immediately —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º –∑–∞–¥–µ—Ä–∂–∫–∏
- Document reasons –¥–ª—è delay
- Mitigating actions taken
- Expect regulatory inquiry
- Potential fines (up to 2% global revenue under GDPR)

### 6. Multi-Jurisdiction Compliance Conflict

**–°–∏—Ç—É–∞—Ü–∏—è**: GDPR —Ç—Ä–µ–±—É–µ—Ç –æ–¥–Ω–æ, 152-–§–ó —Ç—Ä–µ–±—É–µ—Ç –¥—Ä—É–≥–æ–µ

**–û–±—Ä–∞–±–æ—Ç–∫–∞**:
- Apply strictest standard (GDPR –æ–±—ã—á–Ω–æ —Å—Ç—Ä–æ–∂–µ)
- Document compliance —Å –æ–±–æ–∏–º–∏
- Seek legal counsel –¥–ª—è specific conflicts
- If unsolvable: geo-fence features by jurisdiction

### 7. False Positive Mandatory Reporting

**–°–∏—Ç—É–∞—Ü–∏—è**: –°–∏—Å—Ç–µ–º–∞ –æ—à–∏–±–æ—á–Ω–æ –¥–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç child abuse –≥–¥–µ –µ–≥–æ –Ω–µ—Ç

**–û–±—Ä–∞–±–æ—Ç–∫–∞**:
- ALWAYS human oversight –ø–µ—Ä–µ–¥ reporting
- Licensed therapist reviews context
- Document decision (report or not) –≤ audit
- If false alarm: update detection model, add to training examples
- Apologize to user –µ—Å–ª–∏ –≤—ã–∑–≤–∞–Ω–æ unnecessary stress

## –î–æ–ø—É—â–µ–Ω–∏—è

1. **–Æ—Ä–∏—Å–¥–∏–∫—Ü–∏—è**: –ù–∞—á–∏–Ω–∞–µ–º —Å –†–æ—Å—Å–∏–∏ + –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –Ω–∞ EU/US. Compliance –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –¥–ª—è multi-jurisdiction.
2. **Legal Counsel**: –ü—Ä–∏–≤–ª–µ—á–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–∏—Ö —é—Ä–∏—Å—Ç–æ–≤ –¥–ª—è review ToS, Privacy Policy, DPA —à–∞–±–ª–æ–Ω–æ–≤.
3. **Licensed Therapist**: –ù–∞–ª–∏—á–∏–µ –º–∏–Ω–∏–º—É–º 1 –ª–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ—Ä–∞–ø–µ–≤—Ç–∞ –¥–ª—è clinical oversight –∏ duty to warn decisions.
4. **Hosting**: –î–ª—è –†–§ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π - primary storage –≤ –†–§ (152-–§–ó localization requirement).
5. **Insurance**: Professional Liability Insurance –±—É–¥–µ—Ç –ø–æ–ª—É—á–µ–Ω–∞ –ø–µ—Ä–µ–¥ production launch (–æ–ø–∏—Å–∞–Ω—ã requirements).
6. **User Compliance**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —á–µ—Å—Ç–Ω–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç PII –¥–ª—è mapping (–µ—Å–ª–∏ –≤—Ä—É—Ç - –∏—Ö –≤—ã–±–æ—Ä, –º—ã —Ç–æ–∫–µ–Ω–∏–∑–∏—Ä—É–µ–º —á—Ç–æ –æ–Ω–∏ –¥–∞–ª–∏).
7. **Telegram Storage API**: –ò—Å–ø–æ–ª—å–∑—É–µ–º Telegram Cloud Storage –¥–ª—è encrypted PII mapping (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ - localStorage –≤ Mini App).
8. **Backup Encryption**: Restic —Å AES-256 –¥–ª—è backups, keys –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º key management system.

## –û—Ç–∫—Ä—ã—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

1. **–õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–æ–≤**: –ù—É–∂–Ω—ã –ª–∏ dedicated —Å–µ—Ä–≤–µ—Ä—ã –≤ –†–§ –¥–ª—è 152-–§–ó compliance –∏–ª–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ geo-replicated backups?
2. **Duty to Warn –≤ –†–§**: –¢–æ—á–Ω–∞—è —é—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤ –ø—Ä–∏ —É–≥—Ä–æ–∑–µ –∂–∏–∑–Ω–∏ –≤ —Ä–æ—Å—Å–∏–π—Å–∫–æ–π —é—Ä–∏—Å–¥–∏–∫—Ü–∏–∏ (—Ç—Ä–µ–±—É–µ—Ç –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ —é—Ä–∏—Å—Ç–∞).
3. **Mandatory Reporting threshold**: –ö–∞–∫–æ–π —É—Ä–æ–≤–µ–Ω—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è filing report –≤ –æ—Ä–≥–∞–Ω—ã –æ–ø–µ–∫–∏?
4. **HIPAA applicability**: –ï—Å–ª–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º —É—Å–ª—É–≥–∏ –≤ –°–®–ê, —Å—á–∏—Ç–∞–µ—Ç—Å—è –ª–∏ —ç—Ç–æ healthcare service –ø–æ–¥ HIPAA? (–≤–µ—Ä–æ—è—Ç–Ω–æ –Ω–µ—Ç, —Ç.–∫. –Ω–µ diagnosis/treatment, –Ω–æ –Ω—É–∂–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ).
5. **IRB approval**: –ù—É–∂–µ–Ω –ª–∏ IRB –¥–ª—è production —Å–∏—Å—Ç–µ–º—ã –∏–ª–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è research/A/B testing?
6. **Insurance coverage amount**: –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∏ $1-5M Professional Liability –∏–ª–∏ –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ?
7. **Retention periods**: –¢–æ—á–Ω—ã–µ —Å—Ä–æ–∫–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è audit logs –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —é—Ä–∏—Å–¥–∏–∫—Ü–∏–π (6 –ª–µ—Ç - –±–∞–∑–æ–≤–æ–µ –¥–æ–ø—É—â–µ–Ω–∏–µ).
8. **Court orders**: –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ court orders –¥–ª—è –¥–µ-–∞–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

## Acceptance Criteria

### Happy Path

1. **PII Scrubbing —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ**:
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç "–ú–æ—è –¥–æ—á—å –ú–∞—à–∞" -> —Å–µ—Ä–≤–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç "–ú–æ—è –¥–æ—á—å [CHILD_NAME]"
   - –û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞ —Å —Ç–æ–∫–µ–Ω–∞–º–∏ -> –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç —Å –∏–º–µ–Ω–µ–º "–ú–∞—à–∞"
   - PIIValidator reject –∑–∞–ø—Ä–æ—Å—ã —Å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–º PII

2. **GDPR Rights —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã**:
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç /my_data -> –ø–æ–ª—É—á–∞–µ—Ç –ø–æ–ª–Ω—ã–π JSON export –≤ —Ç–µ—á–µ–Ω–∏–µ 24h
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç /delete_my_data -> –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —É–¥–∞–ª–µ–Ω—ã –∏–∑ –≤—Å–µ—Ö –ë–î
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∑—ã–≤–∞–µ—Ç consent –Ω–∞ analytics -> –¥–∞–Ω–Ω—ã–µ –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è

3. **Consent Management —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω**:
   - –ü—Ä–∏ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç granular consent options
   - –°–æ–≥–ª–∞—Å–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Å timestamp –∏ version
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç withdraw consent –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç —á–µ—Ä–µ–∑ /settings

4. **Duty to Warn —Ä–∞–±–æ—Ç–∞–µ—Ç**:
   - HIGH RISK suicidal message -> –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è crisis response + escalation
   - Licensed therapist –ø–æ–ª—É—á–∞–µ—Ç alert –¥–ª—è review
   - Audit log —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω—É—é —Ü–µ–ø–æ—á–∫—É —Å–æ–±—ã—Ç–∏–π

5. **Security Incident Response –≥–æ—Ç–æ–≤**:
   - Simulated data breach -> authorities notified within 72h (GDPR)
   - Affected users notified with clear communication
   - Systems restored from backups

6. **Audit Logging —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω**:
   - –í—Å–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è (data access, consent changes, deletions)
   - Logs tamper-proof (cryptographic signatures)
   - Logs queryable –¥–ª—è compliance audits

### –†—É—á–Ω–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π –ø—Ä–æ–≤–µ—Ä–∫–∏

**–°—Ü–µ–Ω–∞—Ä–∏–π 1: PII Scrubbing End-to-End**

1. –ó–∞–ø—É—Å—Ç–∏—Ç—å Telegram Mini App
2. –ü—Ä–æ–π—Ç–∏ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥, —Å–æ–∑–¥–∞—Ç—å PII mapping ("–ú–∞—à–∞", "–ï–ª–µ–Ω–∞", "–ú–æ—Å–∫–≤–∞")
3. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ: "–ú–æ—è –¥–æ—á—å –ú–∞—à–∞ –∂–∏–≤–µ—Ç —Å –ï–ª–µ–Ω–æ–π –≤ –ú–æ—Å–∫–≤–µ"
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å server logs: –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å "[CHILD_NAME]", "[EX_PARTNER_NAME]", "[CITY]"
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å response: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç "–ú–∞—à–∞", "–ï–ª–µ–Ω–∞", "–ú–æ—Å–∫–≤–∞"
6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å KAG storage: –Ω–µ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö –∏–º–µ–Ω

**–°—Ü–µ–Ω–∞—Ä–∏–π 2: GDPR Data Export**

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç /my_data
2. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –∑–∞–ø—Ä–æ—Å
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: –ø–æ–ª—É—á–µ–Ω download link –≤ —Ç–µ—á–µ–Ω–∏–µ 24h
4. Download –∏ verify JSON structure
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: –≤—Å–µ letters, conversations, analytics included
6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å audit log: data_export_request logged

**–°—Ü–µ–Ω–∞—Ä–∏–π 3: Right to Erasure**

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç /delete_my_data
2. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç "–£–î–ê–õ–ò–¢–¨ –ù–ê–í–°–ï–ì–î–ê"
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: –¥–∞–Ω–Ω—ã–µ —É–¥–∞–ª–µ–Ω—ã –∏–∑ KAG, VectorDB, Analytics, ProfileDB
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: UUID mapping —É–¥–∞–ª–µ–Ω
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å audit log: right_to_erasure_executed (log retained)
6. –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ /start: –¥–æ–ª–∂–Ω–∞ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π user_uuid

**–°—Ü–µ–Ω–∞—Ä–∏–π 4: Duty to Warn**

1. Simulate HIGH RISK message: "–ü–æ–∫–æ–Ω—á—É —Å —Å–æ–±–æ–π —Å–µ–≥–æ–¥–Ω—è –≤–µ—á–µ—Ä–æ–º"
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: immediate crisis response message sent
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: ClinicalOversightTeam –ø–æ–ª—É—á–∏–ª alert
4. Licensed therapist reviews –∏ documents decision
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å audit log: duty_to_warn_executed with full context

**–°—Ü–µ–Ω–∞—Ä–∏–π 5: PII Validation Rejection**

1. –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å request —Å PII –Ω–∞–ø—Ä—è–º—É—é (bypass client scrubber)
2. POST /api/chat —Å body: {"message": "–ú–æ–π email test@example.com"}
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: request rejected (400 Bad Request)
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å logs: PII_DETECTED critical alert
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: email –ù–ï –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞–Ω –≤ plaintext

## Definition of Done

- [x] Client-side PIIScrubber —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω (JavaScript)
- [x] Telegram Mini App –¥–ª—è PII setup —Å–æ–∑–¥–∞–Ω
- [x] Server-side PIIValidator middleware –∞–∫—Ç–∏–≤–µ–Ω
- [x] UUID Mapping Service deployed (isolated microservice)
- [x] Zero PII policy enforced –Ω–∞ –≤—Å–µ—Ö endpoints
- [x] ConsentManager —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω (record, withdraw, check)
- [x] RightToAccessHandler - data export —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω
- [x] RightToErasureHandler - deletion —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] RightToPortability - machine-readable export
- [x] DutyToWarnProtocol –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å SuicidalDetector
- [x] MandatoryReportingProtocol –¥–ª—è child abuse
- [x] InformedConsent UI –≤ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–µ
- [x] AuditLogger —Å tamper-proof signatures
- [x] Encryption at rest (AES-256) –¥–ª—è sensitive data
- [x] Encryption in transit (TLS 1.3) enforced
- [x] RBAC + MFA –¥–ª—è admin –¥–æ—Å—Ç—É–ø–∞
- [x] Automated encrypted backups (3 geo-locations)
- [x] Incident response playbooks —Å–æ–∑–¥–∞–Ω—ã
- [x] BreachNotificationEngine —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- [x] Terms of Service drafted –∏ reviewed —é—Ä–∏—Å—Ç–æ–º
- [x] Privacy Policy GDPR/152-–§–ó compliant
- [x] Data Processing Agreements —à–∞–±–ª–æ–Ω—ã –≥–æ—Ç–æ–≤—ã
- [x] Professional Liability Insurance obtained
- [x] Monthly backup restore drills scheduled
- [x] README –¥–ª—è compliance team
- [x] Feature flags: PRIVACY_SCRUBBING_ENABLED, GDPR_ENABLED, DUTY_TO_WARN_ENABLED

## –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ NFR –¥–ª—è MVP

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **PII Scrubbing latency**: <= 50ms –Ω–∞ client-side (–Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç UX)
- **PIIValidator latency**: <= 100ms –Ω–∞ server-side
- **UUID mapping lookup**: <= 10ms (Redis cache)
- **Data export generation**: <= 5 –º–∏–Ω—É—Ç –¥–ª—è 1000+ conversations
- **Data deletion execution**: <= 10 –º–∏–Ω—É—Ç –ø–æ–ª–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è

### –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å

- **Backup success rate**: 99.9% (daily backups –Ω–µ –¥–æ–ª–∂–Ω—ã fail)
- **Encryption failure rate**: 0% (–∫—Ä–∏—Ç–∏—á–Ω–æ)
- **Audit log loss**: 0% (append-only, replicated)
- **Breach notification SLA**: 100% within 72h (GDPR requirement)
- **Duty to warn response time**: <= 5 minutes –¥–ª—è human escalation

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ —Ä–µ—Å—É—Ä—Å–∞–º

- **Encrypted storage overhead**: +30% –¥–ª—è encrypted data vs plaintext
- **Backup storage**: 3x production data size (3 geo-locations)
- **Audit log retention**: 90 days online, 6 years archived (compressed)
- **UUID mapping DB**: isolated, <= 100MB –¥–ª—è 100k users

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

- **Client-side encryption keys**: –ù–ò–ö–û–ì–î–ê –Ω–µ –ø–æ–∫–∏–¥–∞—é—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **Server-side PII**: ZERO tolerance - –ª—é–±–æ–π PII leak = critical incident
- **UUID mapping access**: –¢–û–õ–¨–ö–û —á–µ—Ä–µ–∑ authenticated API, MFA required –¥–ª—è de-anonymization
- **Audit logs**: Cryptographic signatures –¥–ª—è tamper detection, append-only storage
- **Backup encryption**: AES-256, keys –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º KMS (–Ω–µ –≤ backups)
- **TLS enforcement**: TLS 1.3 minimum, certificate pinning –≤ client
- **Secrets management**: Vault/AWS Secrets Manager, NO secrets –≤ code/config
- **De-anonymization**: –¢–û–õ–¨–ö–û –¥–ª—è legal obligations (duty to warn, court orders), requires two-person authorization
- **Data retention**: GDPR-compliant retention periods, automated deletion
- **Incident response**: 24/7 on-call rotation, <1h response time –¥–ª—è critical breaches

## –ù–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å

### –õ–æ–≥–∏

- **Privacy events**: pii_scrubbing_applied, pii_detected_and_rejected, uuid_mapping_created
- **GDPR events**: data_export_requested, data_export_completed, right_to_erasure_executed, consent_withdrawn
- **Clinical legal events**: duty_to_warn_triggered, mandatory_reporting_filed, informed_consent_obtained
- **Security events**: encryption_failure, unauthorized_access_attempt, audit_log_tamper_detected
- **Compliance events**: breach_notification_sent, dpa_notified, user_notified
- **–í—Å–µ –ª–æ–≥–∏**: structured JSON, –≤–∫–ª—é—á–∞—é—Ç user_uuid (NOT telegram_id), timestamp, actor, details

### –ú–µ—Ç—Ä–∏–∫–∏

- **privacy_scrubbing_latency_ms**: histogram –≤—Ä–µ–º–µ–Ω–∏ PII scrubbing
- **pii_validation_rejections_total**: —Å—á–µ—Ç—á–∏–∫ rejected requests —Å PII
- **uuid_mappings_total**: —Å—á–µ—Ç—á–∏–∫ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö mappings
- **data_exports_total**: —Å—á–µ—Ç—á–∏–∫ GDPR data exports
- **data_deletions_total**: —Å—á–µ—Ç—á–∏–∫ right to erasure requests
- **consents_withdrawn_total**: —Å—á–µ—Ç—á–∏–∫ consent withdrawals
- **duty_to_warn_triggers_total**: —Å—á–µ—Ç—á–∏–∫ duty to warn events
- **mandatory_reports_filed_total**: —Å—á–µ—Ç—á–∏–∫ child abuse reports
- **security_incidents_total**: —Å—á–µ—Ç—á–∏–∫ security incidents –ø–æ severity
- **breach_notifications_sent_total**: —Å—á–µ—Ç—á–∏–∫ breach notifications
- **backup_success_rate**: –ø—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω—ã—Ö backups
- **audit_log_integrity_checks**: —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã tamper detection
- **encryption_operations_total**: —Å—á–µ—Ç—á–∏–∫ encrypt/decrypt operations
- **gdpr_deadline_compliance**: –ø—Ä–æ—Ü–µ–Ω—Ç notifications within SLA

### –¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞

- **Span start**: request entry (with user_uuid, NOT telegram_id)
- **Child spans**:
  - pii_validation
  - uuid_mapping_lookup
  - consent_check
  - data_access
  - encryption/decryption
- **Span end**: response sent
- **Trace ID**: propagate —á–µ—Ä–µ–∑ –≤—Å–µ microservices
- **Sensitive data**: NEVER include PII –≤ traces (use tokens)

## –†–µ–ª–∏–∑

### –í–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ feature flag

```yaml
PRIVACY_SCRUBBING_ENABLED: true
ZERO_PII_VALIDATION: true
UUID_MAPPING_ENABLED: true
GDPR_RIGHTS_ENABLED: true
RUSSIA_152FZ_ENABLED: true
DUTY_TO_WARN_ENABLED: true
MANDATORY_REPORTING_ENABLED: true
AUDIT_LOGGING_ENABLED: true
BREACH_NOTIFICATION_ENABLED: true
```

### –ü–ª–∞–Ω —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

1. **Legal Review (–¥–æ deployment)**:
   - ToS reviewed –∏ approved —é—Ä–∏—Å—Ç–æ–º
   - Privacy Policy reviewed (GDPR + 152-–§–ó expert)
   - DPA templates validated
   - Insurance obtained

2. **Security Audit (–¥–æ deployment)**:
   - Penetration testing encryption
   - PII leak testing (red team)
   - Audit log tamper testing
   - Backup restore drill

3. **Staging (2 –Ω–µ–¥–µ–ª–∏)**:
   - Deploy full privacy stack
   - Simulate GDPR requests (export, delete)
   - Simulate duty to warn scenarios
   - Test breach notification workflow

4. **Production Phased Rollout**:
   - **–§–∞–∑–∞ 1 (–Ω–µ–¥–µ–ª—è 1)**: Internal beta (–∫–æ–º–∞–Ω–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
     - PRIVACY_SCRUBBING_ENABLED=true
     - Test PII scrubbing –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö
   - **–§–∞–∑–∞ 2 (–Ω–µ–¥–µ–ª—è 2)**: Closed beta (50 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
     - –í—Å–µ compliance features enabled
     - Monitor –¥–ª—è PII leaks
     - Collect feedback –Ω–∞ consent flow
   - **–§–∞–∑–∞ 3 (–Ω–µ–¥–µ–ª—è 3)**: Open beta (500 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
     - Full compliance stack active
     - Licensed therapist on-call –¥–ª—è duty to warn
   - **–§–∞–∑–∞ 4 (–Ω–µ–¥–µ–ª—è 4)**: General availability
     - 100% users
     - 24/7 compliance monitoring
     - Legal team on standby

## –û—Ç–∫–∞—Ç

### –£—Å–ª–æ–≤–∏—è –æ—Ç–∫–∞—Ç–∞

- PII leak detected (ANY real PII –Ω–∞ server-side)
- Encryption failure (data stored unencrypted)
- Audit log corruption/loss
- Breach notification deadline missed
- Duty to warn protocol failure (missed critical case)
- GDPR rights execution failure (cannot delete data when requested)

### –®–∞–≥–∏ –≤–æ–∑–≤—Ä–∞—Ç–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è

1. **–ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π –æ—Ç–∫–∞—Ç**:
   - Set PRIVACY_SCRUBBING_ENABLED=false (block new requests)
   - Notify all users: service temporarily unavailable
   - Isolate affected systems

2. **Incident investigation**:
   - Determine scope of PII leak (if applicable)
   - Identify root cause
   - Document timeline

3. **Data remediation**:
   - IF PII leaked:
     - Delete leaked PII from logs/storage
     - Assess breach notification requirements
     - File notifications if needed
   - Restore from clean backup if necessary

4. **Fix –∏ validation**:
   - Fix root cause
   - Test extensively –≤ staging
   - Security audit —Ñ–∏–∫—Å–∞
   - Legal review –µ—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å policies

5. **Re-deployment**:
   - Gradual rollout (repeat –§–∞–∑–∞ 1-4)
   - Enhanced monitoring
   - Post-mortem –ø—É–±–ª–∏–∫–∞—Ü–∏—è

6. **User communication**:
   - Transparent incident report
   - Explanation —á—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ
   - Assurance –º–µ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## –†–∏—Å–∫–∏ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏–∏

### –†–∏—Å–∫ 1: PII Leak —á–µ—Ä–µ–∑ client-side bypass

**–û–ø–∏—Å–∞–Ω–∏–µ**: –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –∏–ª–∏ –±–∞–≥ bypass client-side scrubbing, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç PII –Ω–∞–ø—Ä—è–º—É—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
- Server-side PIIValidator –∫–∞–∫ –≤—Ç–æ—Ä–æ–π —É—Ä–æ–≤–µ–Ω—å –∑–∞—â–∏—Ç—ã
- Reject –ª—é–±—ã–µ requests —Å detected PII
- Critical alerts –ø—Ä–∏ PII detection
- Rate limiting –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è mass PII probing
- Regular penetration testing

### –†–∏—Å–∫ 2: Conflict –º–µ–∂–¥—É Privacy –∏ Legal Obligations

**–û–ø–∏—Å–∞–Ω–∏–µ**: Duty to warn —Ç—Ä–µ–±—É–µ—Ç –¥–µ-–∞–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏–∏, –Ω–æ —ç—Ç–æ –Ω–∞—Ä—É—à–∞–µ—Ç privacy promise

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
- Transparent disclosure –≤ Informed Consent (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∑–Ω–∞—é—Ç –æ duty to warn)
- De-anonymization –¢–û–õ–¨–ö–û –¥–ª—è legal obligations
- Human oversight (licensed therapist) –ø–µ—Ä–µ–¥ –¥–µ-–∞–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏–µ–π
- Audit trail –≤—Å–µ—Ö –¥–µ-–∞–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏–π
- Minimize data retention (–º–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö = –º–µ–Ω—å—à–µ —Ä–∏—Å–∫)

### –†–∏—Å–∫ 3: GDPR/152-–§–ó Non-Compliance Fines

**–û–ø–∏—Å–∞–Ω–∏–µ**: –®—Ç—Ä–∞—Ñ—ã –∑–∞ –Ω–∞—Ä—É—à–µ–Ω–∏–µ (–¥–æ 4% global revenue GDPR, –¥–æ 6% 152-–§–ó)

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
- Proactive compliance audit (quarterly)
- Legal counsel review –ø–µ—Ä–µ–¥ launch
- DPO (Data Protection Officer) –Ω–∞–∑–Ω–∞—á–µ–Ω
- Documentation –≤—Å–µ—Ö compliance measures
- Regular staff training –Ω–∞ GDPR/152-–§–ó
- Cyber insurance coverage

### –†–∏—Å–∫ 4: False Positive –≤ Duty to Warn

**–û–ø–∏—Å–∞–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –æ—à–∏–±–æ—á–Ω–æ —ç—Å–∫–∞–ª–∏—Ä—É–µ—Ç non-crisis –∫–∞–∫ crisis

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
- ALWAYS human oversight –ø–µ—Ä–µ–¥ authorities notification
- Licensed therapist reviews –∫–∞–∂–¥—ã–π duty to warn trigger
- False positive tracking –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è detection
- User notification + apology –µ—Å–ª–∏ false alarm
- Regular model retraining —Å feedback

### –†–∏—Å–∫ 5: Encryption Key Loss

**–û–ø–∏—Å–∞–Ω–∏–µ**: Loss of encryption keys = permanent data loss

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
- Key backup –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º secure KMS
- Multi-region key replication
- Key rotation protocol (–µ–∂–µ–≥–æ–¥–Ω–æ)
- Disaster recovery drills –¥–ª—è key restoration
- Documentation –ø—Ä–æ—Ü–µ–¥—É—Ä key recovery

### –†–∏—Å–∫ 6: Insider Threat (Admin Abuse)

**–û–ø–∏—Å–∞–Ω–∏–µ**: Admin/employee –Ω–µ–ø—Ä–∞–≤–æ–º–µ—Ä–Ω–æ –¥–µ-–∞–Ω–æ–Ω–∏–º–∏–∑–∏—Ä—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–ª–∏ exfiltrates data

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
- RBAC —Å principle of least privilege
- MFA –¥–ª—è –≤—Å–µ—Ö admin operations
- Two-person authorization –¥–ª—è –¥–µ-–∞–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏–∏
- Comprehensive audit logging (–∫—Ç–æ, —á—Ç–æ, –∫–æ–≥–¥–∞)
- Background checks –¥–ª—è employees —Å data access
- Regular access reviews (quarterly)
- Anomaly detection –Ω–∞ admin actions

### –†–∏—Å–∫ 7: Third-Party Vendor Compliance

**–û–ø–∏—Å–∞–Ω–∏–µ**: LLM provider (OpenAI) –∏–ª–∏ hosting provider –Ω–µ GDPR-compliant

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
- Data Processing Agreements —Å–æ –≤—Å–µ–º–∏ vendors
- Vendor compliance audit (request SOC2, ISO27001 certs)
- Contractual clauses –¥–ª—è GDPR compliance
- Data minimization (send —Ç–æ–ª—å–∫–æ tokenized data –∫ LLM)
- Regular vendor reviews (annual)
- Backup vendors (diversity –¥–ª—è critical services)

### –†–∏—Å–∫ 8: Cross-Border Data Transfer Issues

**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ EU/Russia –≤ non-adequate countries

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
- Primary storage –≤ jurisdiction –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (EU users -> EU servers)
- Standard Contractual Clauses –¥–ª—è transfers
- Encryption –≤ transit –¥–ª—è –≤—Å–µ—Ö transfers
- Pseudonymization (UUID) –º–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ—Ç risk
- Legal review transfer mechanisms —Ä–µ–≥—É–ª—è—Ä–Ω–æ

## –°–∞–º–æ–ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–ª–∞–Ω–∞

- [x] –ù–µ—Ç –∫–æ–¥–∞ –∏ –ø—Å–µ–≤–¥–æ–∫–æ–¥–∞ (—Ç–æ–ª—å–∫–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ)
- [x] –ó–∞–ø–æ–ª–Ω–µ–Ω—ã scope, acceptance criteria, risks, release plan
- [x] –§–∞–π–ª –∏–º–µ–Ω–æ–≤–∞–Ω —Å–æ–≥–ª–∞—Å–Ω–æ —Ñ–æ—Ä–º–∞—Ç—É IP-07-privacy-compliance-legal.md
- [x] –ù–µ—Ç —É–ø–æ–º–∏–Ω–∞–Ω–∏–π —Å–µ–∫—Ä–µ—Ç–æ–≤ –∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö URL
- [x] –ü–æ–∫—Ä—ã—Ç—ã –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–∑ Claude004.md (Privacy-First Architecture, GDPR, 152-–§–ó, Clinical Legal, Disaster Recovery)
- [x] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ IP (IP-05 SuicidalDetector –¥–ª—è Duty to Warn, IP-02 –¥–ª—è Content Guardian)
- [x] Mermaid –¥–∏–∞–≥—Ä–∞–º–º—ã –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
- [x] –î–µ—Ç–∞–ª—å–Ω—ã–π flow —Ä–∞–±–æ—Ç—ã –æ—Ç –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞ –¥–æ incident response
- [x] –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏ (PII leak, consent conflicts, deadline misses)
- [x] NFR, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, observability, release, –æ—Ç–∫–∞—Ç, —Ä–∏—Å–∫–∏ - –≤—Å–µ —Å–µ–∫—Ü–∏–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã
- [x] Specific –¥–ª—è mental health context (duty to warn, mandatory reporting, informed consent)
