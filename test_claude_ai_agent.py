"""
–¢–µ—Å—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Claude –∫–∞–∫ AI –∞–≥–µ–Ω—Ç–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
–î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç 3 use case:
1. –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–≤–µ—Å—Ç—ã
2. Content moderation
3. –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
"""

import asyncio
from typing import Dict, List, Any


# === USE CASE 1: –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–≤–µ—Å—Ç ===

def generate_personalized_quest(child_info: Dict[str, Any]) -> str:
    """
    –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–≤–µ—Å—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ä–µ–±–µ–Ω–∫–µ.
    –í —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ —ç—Ç–æ –±—É–¥–µ—Ç –≤—ã–∑–æ–≤ –∫ Claude API –∏–ª–∏ —è —Å–∞–º —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.

    –°–µ–π—á–∞—Å —Å–∏–º—É–ª–∏—Ä—É—é —á—Ç–æ Claude –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–≤–µ—Å—Ç.
    """
    child_name = child_info.get('name', '—Ä–µ–±–µ–Ω–æ–∫')
    age = child_info.get('age', 10)
    interests = child_info.get('interests', [])
    memories = child_info.get('memories', [])

    # –ó–¥–µ—Å—å —è (Claude) —Å–æ–∑–¥–∞—é –∫–≤–µ—Å—Ç
    print(f"\n{'='*60}")
    print(f"üéØ –ì–ï–ù–ï–†–ê–¶–ò–Ø –ö–í–ï–°–¢–ê –î–õ–Ø: {child_name}, {age} –ª–µ—Ç")
    print(f"–ò–Ω—Ç–µ—Ä–µ—Å—ã: {', '.join(interests)}")
    print(f"–í–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è: {', '.join(memories)}")
    print(f"{'='*60}\n")

    # –ì–µ–Ω–µ—Ä–∏—Ä—É—é YAML –∫–≤–µ—Å—Ç —Å —É—á–µ—Ç–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
    quest_yaml = f"""quest_id: "–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π_–∫–≤–µ—Å—Ç_{child_name.lower()}_001"
title: "–¢–∞–π–Ω–∞ {memories[0] if memories else '–≤–æ–ª—à–µ–±–Ω–æ–≥–æ —Å–∞–¥–∞'}"
description: |
  –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –∫–≤–µ—Å—Ç –¥–ª—è {child_name}, –∫–æ—Ç–æ—Ä—ã–π –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –ª—é–±–æ–≤—å –∫ {interests[0] if interests else '–ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è–º'}
  –∏ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ {memories[0] if memories else '–≤–∞–∂–Ω—ã—Ö –º–æ–º–µ–Ω—Ç–∞—Ö'}.

child_context:
  name: {child_name}
  age: {age}
  interests: {interests}
  memories: {memories}

nodes:
  - id: start
    type: start
    data:
      title: "–ù–∞—á–∞–ª–æ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è"
      content: |
        –ü—Ä–∏–≤–µ—Ç, {child_name}! üëã

        –ü–æ–º–Ω–∏—à—å, –∫–∞–∫ –º—ã –≤–º–µ—Å—Ç–µ {memories[0] if memories else '–ø—Ä–æ–≤–æ–¥–∏–ª–∏ –≤—Ä–µ–º—è'}?
        –°–µ–≥–æ–¥–Ω—è —è –ø—Ä–∏–≥–æ—Ç–æ–≤–∏–ª –¥–ª—è —Ç–µ–±—è –æ—Å–æ–±–µ–Ω–Ω–æ–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ!

        –¢—ã –≥–æ—Ç–æ–≤{'–∞' if age < 12 else ''} –æ—Ç–ø—Ä–∞–≤–∏—Ç—å—Å—è –≤ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ?

  - id: step1
    type: questStep
    data:
      title: "–ó–∞–≥–∞–¥–∫–∞ {interests[0] if interests else '–ø—Ä–∏—Ä–æ–¥—ã'}"
      content: |
        {child_name}, –ø—Ä–µ–¥—Å—Ç–∞–≤—å: —Ç—ã –Ω–∞—Ö–æ–¥–∏—à—å—Å—è –≤ –º–µ—Å—Ç–µ, –≥–¥–µ {interests[0] if interests else '–≤—Å—ë –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ'}.

        –í–æ–ø—Ä–æ—Å: –ß—Ç–æ —Ç–µ–±–µ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –Ω—Ä–∞–≤–∏—Ç—Å—è –≤ {interests[0] if interests else '—ç—Ç–æ–º –º–µ—Å—Ç–µ'}?

        –ü–æ–¥—Å–∫–∞–∑–∫–∞: –í—Å–ø–æ–º–Ω–∏, –∫–∞–∫ –º—ã —Å —Ç–æ–±–æ–π {memories[1] if len(memories) > 1 else '–¥–µ–ª–∞–ª–∏ —ç—Ç–æ –≤–º–µ—Å—Ç–µ'}.
      task_type: "reflection"
      points: 10

  - id: choice1
    type: choice
    data:
      question: "–ö–∞–∫ —Ç—ã —Ö–æ—á–µ—à—å –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å?"
      options:
        - text: "–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –¥–∞–ª—å—à–µ"
          next: step2
        - text: "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–µ–º"
          next: reality_bridge1

  - id: step2
    type: questStep
    data:
      title: "–û—Ç–∫—Ä—ã—Ç–∏–µ"
      content: |
        {child_name}, —Ç—ã –¥–µ–ª–∞–µ—à—å –≤–∞–∂–Ω–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ! üåü

        –ö–æ–≥–¥–∞ –º—ã –∑–∞–Ω–∏–º–∞–µ–º—Å—è —Ç–µ–º, —á—Ç–æ –ª—é–±–∏–º ({interests[0] if interests else '–Ω–∞—à–∏–º–∏ —É–≤–ª–µ—á–µ–Ω–∏—è–º–∏'}),
        –º—ã —Å–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–µ —Å—á–∞—Å—Ç–ª–∏–≤—ã–µ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è.

        –ó–∞–¥–∞–Ω–∏–µ: –ù–∞—Ä–∏—Å—É–π –∏–ª–∏ –æ–ø–∏—à–∏, –∫–∞–∫–∏–º —Ç—ã –≤–∏–¥–∏—à—å –Ω–∞—à–µ —Å–ª–µ–¥—É—é—â–µ–µ –æ–±—â–µ–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ?
      task_type: "creative"
      points: 20

  - id: reality_bridge1
    type: realityBridge
    data:
      title: "–°–≤—è–∑—å —Å —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å—é"
      content: |
        {child_name}, —ç—Ç–æ –º–µ—Å—Ç–æ, –≥–¥–µ –∫–≤–µ—Å—Ç –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è —Å —Ä–µ–∞–ª—å–Ω–æ–π –∂–∏–∑–Ω—å—é! üåà

        –î–∞–≤–∞–π –ø–æ–¥—É–º–∞–µ–º: —á—Ç–æ –∏–∑ —ç—Ç–æ–≥–æ –∫–≤–µ—Å—Ç–∞ –º—ã –º–æ–∂–µ–º —Å–¥–µ–ª–∞—Ç—å –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏?

        –ú–æ–∂–µ—Ç –±—ã—Ç—å, –º—ã –º–æ–≥–ª–∏ –±—ã –≤–º–µ—Å—Ç–µ {memories[0] if memories else '—Å–æ–∑–¥–∞—Ç—å —á—Ç–æ-—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ–µ'}?
      real_world_action: "–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–æ–≤–º–µ—Å—Ç–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å"
      connection_to_parent: true

  - id: end
    type: end
    data:
      title: "–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ"
      content: |
        –ü–æ–∑–¥—Ä–∞–≤–ª—è—é, {child_name}! üéâ

        –¢—ã –ø—Ä–æ—à—ë–ª{'–∞' if age < 12 else ''} –∫–≤–µ—Å—Ç –∏ –ø–æ–∫–∞–∑–∞–ª{'–∞' if age < 12 else ''},
        –∫–∞–∫ –≤–∞–∂–Ω—ã –Ω–∞—à–∏ –æ–±—â–∏–µ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ {memories[0] if memories else '–≤–∞–∂–Ω—ã—Ö –º–æ–º–µ–Ω—Ç–∞—Ö'}.

        –ü–æ–º–Ω–∏: –º—ã –≤—Å–µ–≥–¥–∞ –º–æ–∂–µ–º —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Å—á–∞—Å—Ç–ª–∏–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã –≤–º–µ—Å—Ç–µ! ‚ù§Ô∏è
      reward: "–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—è + –∏–¥–µ—è –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–Ω–æ–≥–æ –≤—Ä–µ–º—è–ø—Ä–µ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è"

edges:
  - from: start
    to: step1
  - from: step1
    to: choice1
  - from: choice1
    to: step2
    condition: "option == 'explore'"
  - from: choice1
    to: reality_bridge1
    condition: "option == 'share'"
  - from: step2
    to: reality_bridge1
  - from: reality_bridge1
    to: end

metadata:
  created_by: "Claude AI Agent"
  personalization_level: "high"
  emotional_safety: "validated"
  parent_child_connection: "strong"
"""

    return quest_yaml


# === USE CASE 2: Content Moderation ===

def moderate_content(content: str, context: Dict[str, Any]) -> Dict[str, Any]:
    """
    –ú–æ–¥–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Å –ø–æ–º–æ—â—å—é Claude.
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞ –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏, –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç, —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ.
    """
    print(f"\n{'='*60}")
    print(f"üõ°Ô∏è –ú–û–î–ï–†–ê–¶–ò–Ø –ö–û–ù–¢–ï–ù–¢–ê")
    print(f"{'='*60}\n")
    print(f"–ö–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:\n{content}\n")

    # –Ø (Claude) –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é –∫–æ–Ω—Ç–µ–Ω—Ç
    issues = []

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –º–∞–Ω–∏–ø—É–ª—è—Ü–∏—é
    manipulation_keywords = [
        '–º–∞–º–∞ –Ω–µ –ª—é–±–∏—Ç', '–ø–∞–ø–∞ –ø–ª–æ—Ö–æ–π', '–æ–Ω–∏ —Ç–µ–±—è –±—Ä–æ—Å–∏–ª–∏',
        '—Ç—ã –¥–æ–ª–∂–µ–Ω –≤—ã–±—Ä–∞—Ç—å', '–µ—Å–ª–∏ –ª—é–±–∏—à—å, —Ç–æ', '–Ω–∞—Å—Ç–æ—è—â–∏–µ —Ä–æ–¥–∏—Ç–µ–ª–∏'
    ]

    found_manipulation = [kw for kw in manipulation_keywords if kw.lower() in content.lower()]
    if found_manipulation:
        issues.append({
            'category': 'manipulation',
            'severity': 'critical',
            'description': f'–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –º–∞–Ω–∏–ø—É–ª—è—Ç–∏–≤–Ω—ã–µ —Ñ—Ä–∞–∑—ã: {found_manipulation}',
            'recommendation': '–ë–õ–û–ö–ò–†–û–í–ê–¢–¨ - –ø—Ä—è–º–∞—è –º–∞–Ω–∏–ø—É–ª—è—Ü–∏—è —Ä–µ–±—ë–Ω–∫–æ–º',
            'fragments': found_manipulation
        })

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ
    pressure_keywords = [
        '—Ç—ã –æ–±—è–∑–∞–Ω', '–¥–æ–ª–∂–µ–Ω', '–µ—Å–ª–∏ –Ω–µ —Å–¥–µ–ª–∞–µ—à—å', '–ø–ª–æ—Ö–æ–π —Ä–µ–±–µ–Ω–æ–∫'
    ]

    found_pressure = [kw for kw in pressure_keywords if kw.lower() in content.lower()]
    if found_pressure:
        issues.append({
            'category': 'emotional_pressure',
            'severity': 'high',
            'description': f'–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ: {found_pressure}',
            'recommendation': '–ü–û–ú–ï–¢–ò–¢–¨ - —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è –ø—Å–∏—Ö–æ–ª–æ–≥–∞',
            'fragments': found_pressure
        })

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
    positive_keywords = [
        '–ª—é–±–ª—é', '—Å–∫—É—á–∞—é', '–ø–æ–º–Ω—é', '–≤–º–µ—Å—Ç–µ', '—Å—á–∞—Å—Ç–ª–∏–≤', '—Ä–∞–¥–æ—Å—Ç—å'
    ]

    found_positive = [kw for kw in positive_keywords if kw.lower() in content.lower()]

    # –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞
    if not issues:
        safety_score = 0.95 if found_positive else 0.75
        status = 'APPROVED'
    elif any(i['severity'] == 'critical' for i in issues):
        safety_score = 0.1
        status = 'BLOCKED'
    else:
        safety_score = 0.5
        status = 'FLAGGED'

    result = {
        'status': status,
        'safety_score': safety_score,
        'issues': issues,
        'positive_elements': found_positive,
        'recommendation': _get_recommendation(status, issues),
        'analyzed_by': 'Claude AI Agent'
    }

    return result


def _get_recommendation(status: str, issues: List[Dict]) -> str:
    """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞."""
    if status == 'BLOCKED':
        return "–ö–æ–Ω—Ç–µ–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω. –°–æ–¥–µ—Ä–∂–∏—Ç –º–∞–Ω–∏–ø—É–ª—è—Ü–∏—é –∏–ª–∏ —É–≥—Ä–æ–∑—ã. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è –ø—Å–∏—Ö–æ–ª–æ–≥–∞."
    elif status == 'FLAGGED':
        return "–ö–æ–Ω—Ç–µ–Ω—Ç –ø–æ–º–µ—á–µ–Ω –¥–ª—è —Ä–µ–≤—å—é. –ï—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–∏ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –¥–∞–≤–ª–µ–Ω–∏—è. –ü—Å–∏—Ö–æ–ª–æ–≥ –¥–æ–ª–∂–µ–Ω –æ—Ü–µ–Ω–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç."
    else:
        return "–ö–æ–Ω—Ç–µ–Ω—Ç –æ–¥–æ–±—Ä–µ–Ω. –ë–µ–∑–æ–ø–∞—Å–µ–Ω –¥–ª—è —Ä–µ–±—ë–Ω–∫–∞."


# === USE CASE 3: –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç ===

def generate_adaptive_response(
    child_state: Dict[str, Any],
    interaction_history: List[Dict[str, Any]]
) -> str:
    """
    –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ä–µ–±—ë–Ω–∫–∞ –∏ –∏—Å—Ç–æ—Ä–∏–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è.
    """
    print(f"\n{'='*60}")
    print(f"üé® –ê–î–ê–ü–¢–ò–í–ù–´–ô –ö–û–ù–¢–ï–ù–¢")
    print(f"{'='*60}\n")

    mood = child_state.get('mood', 'neutral')
    engagement = child_state.get('engagement_level', 0.5)
    last_interaction = interaction_history[-1] if interaction_history else {}

    print(f"–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ: {mood}")
    print(f"–£—Ä–æ–≤–µ–Ω—å –≤–æ–≤–ª–µ—á—ë–Ω–Ω–æ—Å—Ç–∏: {engagement:.1%}")
    print(f"–ü–æ—Å–ª–µ–¥–Ω–µ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ: {last_interaction.get('type', 'none')}\n")

    # –Ø (Claude) –∞–¥–∞–ø—Ç–∏—Ä—É—é –∫–æ–Ω—Ç–µ–Ω—Ç
    if mood == 'sad' or mood == 'frustrated':
        response = f"""
üåü –í–∏–∂—É, —á—Ç–æ —Å–µ–π—á–∞—Å –Ω–µ–ø—Ä–æ—Å—Ç–æ...

–ó–Ω–∞–µ—à—å, –∏–Ω–æ–≥–¥–∞ –º—ã –≤—Å–µ —á—É–≤—Å—Ç–≤—É–µ–º –≥—Ä—É—Å—Ç—å - –∏ —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ.
–¢–≤–æ–∏ —á—É–≤—Å—Ç–≤–∞ –≤–∞–∂–Ω—ã –∏ –∏–º–µ—é—Ç –ø—Ä–∞–≤–æ –±—ã—Ç—å.

–ú–æ–∂–µ—Ç, —Å–¥–µ–ª–∞–µ–º –Ω–µ–±–æ–ª—å—à—É—é –ø–∞—É–∑—É? –ò–ª–∏ —Ö–æ—á–µ—à—å –ø–æ–≥–æ–≤–æ—Ä–∏—Ç—å –æ —Ç–æ–º, —á—Ç–æ —Ç–µ–±—è –±–µ—Å–ø–æ–∫–æ–∏—Ç?

–ü–æ–º–Ω–∏: —è –∑–¥–µ—Å—å, —á—Ç–æ–±—ã –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å —Ç–µ–±—è. ‚ù§Ô∏è
"""

    elif engagement < 0.3:
        response = f"""
üéØ –≠–π, –¥–∞–≤–∞–π –ø–æ–ø—Ä–æ–±—É–µ–º —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ!

–Ø –∑–∞–º–µ—Ç–∏–ª, —á—Ç–æ —Ç–µ–∫—É—â–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ –æ—á–µ–Ω—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–π.

–ß—Ç–æ –µ—Å–ª–∏ –º—ã:
- –ü–µ—Ä–µ–∫–ª—é—á–∏–º—Å—è –Ω–∞ –±–æ–ª–µ–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—É—é —Ç–µ–º—É?
- –°–¥–µ–ª–∞–µ–º –Ω–µ–±–æ–ª—å—à–æ–π –ø–µ—Ä–µ—Ä—ã–≤?
- –ü–æ–ø—Ä–æ–±—É–µ–º –¥—Ä—É–≥–æ–π —Ç–∏–ø –∑–∞–¥–∞–Ω–∏—è?

–ß—Ç–æ —Ç–µ–±–µ –±–æ–ª—å—à–µ –Ω—Ä–∞–≤–∏—Ç—Å—è? üòä
"""

    elif mood == 'happy' and engagement > 0.7:
        response = f"""
üéâ –í–∞—É, —É —Ç–µ–±—è –æ—Ç–ª–∏—á–Ω–æ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏ —Ç—ã —Ç–∞–∫ —É–≤–ª–µ—á—ë–Ω{'–∞' if child_state.get('age', 10) < 12 else ''}!

–≠—Ç–æ –ø–æ—Ç—Ä—è—Å–∞—é—â–µ! –î–∞–≤–∞–π –∏—Å–ø–æ–ª—å–∑—É–µ–º —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç –ø–æ –º–∞–∫—Å–∏–º—É–º—É:

üöÄ –ì–æ—Ç–æ–≤{'–∞' if child_state.get('age', 10) < 12 else ''} –∫ –Ω–æ–≤–æ–º—É —á–µ–ª–ª–µ–Ω–¥–∂—É?
‚ú® –ú–æ–∂–µ—Ç, —Å–æ–∑–¥–∞–¥–∏–º —á—Ç–æ-—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ–µ?

–ü—Ä–æ–¥–æ–ª–∂–∞–µ–º! üí™
"""

    else:
        response = f"""
üëç –û—Ç–ª–∏—á–Ω–æ, –∏–¥—ë–º –¥–∞–ª—å—à–µ!

–¢—ã —Å–ø—Ä–∞–≤–ª—è–µ—à—å—Å—è —Ö–æ—Ä–æ—à–æ. –î–∞–≤–∞–π –ø—Ä–æ–¥–æ–ª–∂–∏–º –Ω–∞—à–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ!

–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥ –≥–æ—Ç–æ–≤, –∫–æ–≥–¥–∞ —Ç—ã –±—É–¥–µ—à—å –≥–æ—Ç–æ–≤{'–∞' if child_state.get('age', 10) < 12 else ''}.
"""

    return response.strip()


# === MAIN DEMO ===

async def main():
    """–û—Å–Ω–æ–≤–Ω–æ–µ –¥–µ–º–æ –≤—Å–µ—Ö —Ç—Ä—ë—Ö use cases."""

    print("\n" + "="*60)
    print("ü§ñ CLAUDE –ö–ê–ö AI –ê–ì–ï–ù–¢ - –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø")
    print("="*60)

    # === –¢–ï–°–¢ 1: –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–≤–µ—Å—Ç ===
    print("\n\nüìö –¢–ï–°–¢ 1: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–≤–µ—Å—Ç–∞\n")

    child_info = {
        'name': '–ú–∞—à–∞',
        'age': 9,
        'interests': ['–º–∞—Ç–µ–º–∞—Ç–∏–∫–∞', '–ø—Ä–∏—Ä–æ–¥–∞', '–∂–∏–≤–æ—Ç–Ω—ã–µ', '–∫–æ—Ç–∏–∫–∏'],
        'memories': [
            '—Ö–æ–¥–∏–ª–∏ –≤ –∑–æ–æ–ø–∞—Ä–∫ –∏ –∫–æ—Ä–º–∏–ª–∏ –∂–∏—Ä–∞—Ñ–∞',
            '–ø–µ–∫–ª–∏ —Ç–æ—Ä—Ç –Ω–∞ –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è',
            '—á–∏—Ç–∞–ª–∏ –∫–Ω–∏–≥—É –ø—Ä–æ –ø—Ä–∏—Ä–æ–¥—É'
        ]
    }

    quest_yaml = generate_personalized_quest(child_info)

    print("\n‚úÖ –°–ì–ï–ù–ï–†–ò–†–û–í–ê–ù–ù–´–ô –ö–í–ï–°–¢:")
    print(quest_yaml[:500] + "...\n")
    print(f"üìä –î–ª–∏–Ω–∞ –∫–≤–µ—Å—Ç–∞: {len(quest_yaml)} —Å–∏–º–≤–æ–ª–æ–≤")
    print(f"üìù –£–∑–ª–æ–≤ –≤ –∫–≤–µ—Å—Ç–µ: {quest_yaml.count('- id:')}")
    print(f"üéØ –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è: HIGH")
    print(f"‚ù§Ô∏è –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–≤—è–∑—å: –í–∫–ª—é—á–µ–Ω–∞")

    # –°–æ—Ö—Ä–∞–Ω–∏–º –∫–≤–µ—Å—Ç
    with open('/tmp/claude_generated_quest.yaml', 'w', encoding='utf-8') as f:
        f.write(quest_yaml)
    print(f"\nüíæ –ö–≤–µ—Å—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω: /tmp/claude_generated_quest.yaml")

    # === –¢–ï–°–¢ 2: Content Moderation ===
    print("\n\nüõ°Ô∏è –¢–ï–°–¢ 2: –ú–æ–¥–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞\n")

    # –¢–µ—Å—Ç 2.1: –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
    safe_content = """
    –ü—Ä–∏–≤–µ—Ç, –ú–∞—à–∞! –Ø –æ—á–µ–Ω—å —Å–∫—É—á–∞—é –ø–æ —Ç–µ–±–µ –∏ –ø–æ–º–Ω—é, –∫–∞–∫ –º—ã –≤–º–µ—Å—Ç–µ —Ö–æ–¥–∏–ª–∏ –≤ –∑–æ–æ–ø–∞—Ä–∫.
    –ú–æ–∂–µ—Ç –±—ã—Ç—å, –º—ã —Å–∫–æ—Ä–æ —Å–Ω–æ–≤–∞ —É–≤–∏–¥–∏–º—Å—è? –Ø –ª—é–±–ª—é —Ç–µ–±—è! ‚ù§Ô∏è
    """

    print("–¢–µ—Å—Ç 2.1: –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç")
    result1 = moderate_content(safe_content, {'source': 'parent_message'})
    print(f"\n‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç: {result1['status']}")
    print(f"üìä Safety Score: {result1['safety_score']:.1%}")
    print(f"üíö –ü–æ–∑–∏—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã: {result1['positive_elements']}")
    print(f"üìã –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: {result1['recommendation']}")

    # –¢–µ—Å—Ç 2.2: –ú–∞–Ω–∏–ø—É–ª—è—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
    manipulative_content = """
    –ú–∞—à–∞, –º–∞–º–∞ —Ç–µ–±—è –Ω–µ –ª—é–±–∏—Ç, –æ–Ω–∞ —Ç–µ–±—è –±—Ä–æ—Å–∏–ª–∞.
    –ï—Å–ª–∏ —Ç—ã –Ω–∞—Å—Ç–æ—è—â–∞—è –¥–æ—á—å, —Ç—ã –¥–æ–ª–∂–µ–Ω –≤—ã–±—Ä–∞—Ç—å –º–µ–Ω—è.
    """

    print("\n\n–¢–µ—Å—Ç 2.2: –ú–∞–Ω–∏–ø—É–ª—è—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç")
    result2 = moderate_content(manipulative_content, {'source': 'parent_message'})
    print(f"\nüö´ –†–µ–∑—É–ª—å—Ç–∞—Ç: {result2['status']}")
    print(f"üìä Safety Score: {result2['safety_score']:.1%}")
    print(f"‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã –Ω–∞–π–¥–µ–Ω—ã: {len(result2['issues'])}")
    for issue in result2['issues']:
        print(f"  - {issue['category']}: {issue['severity']} - {issue['description']}")
    print(f"üìã –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: {result2['recommendation']}")

    # === –¢–ï–°–¢ 3: –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç ===
    print("\n\nüé® –¢–ï–°–¢ 3: –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç\n")

    # –°—Ü–µ–Ω–∞—Ä–∏–π 3.1: –ì—Ä—É—Å—Ç–Ω—ã–π —Ä–µ–±—ë–Ω–æ–∫
    print("–¢–µ—Å—Ç 3.1: –†–µ–±—ë–Ω–æ–∫ –≥—Ä—É—Å—Ç–∏—Ç")
    state1 = {'mood': 'sad', 'engagement_level': 0.3, 'age': 9}
    history1 = [{'type': 'quest_step', 'completed': False}]
    response1 = generate_adaptive_response(state1, history1)
    print(f"\nüí¨ –û—Ç–≤–µ—Ç —Å–∏—Å—Ç–µ–º—ã:\n{response1}")

    # –°—Ü–µ–Ω–∞—Ä–∏–π 3.2: –ù–∏–∑–∫–∞—è –≤–æ–≤–ª–µ—á—ë–Ω–Ω–æ—Å—Ç—å
    print("\n\n–¢–µ—Å—Ç 3.2: –ù–∏–∑–∫–∞—è –≤–æ–≤–ª–µ—á—ë–Ω–Ω–æ—Å—Ç—å")
    state2 = {'mood': 'neutral', 'engagement_level': 0.2, 'age': 9}
    history2 = [
        {'type': 'quest_step', 'time_spent': 600},
        {'type': 'quest_step', 'time_spent': 800}
    ]
    response2 = generate_adaptive_response(state2, history2)
    print(f"\nüí¨ –û—Ç–≤–µ—Ç —Å–∏—Å—Ç–µ–º—ã:\n{response2}")

    # –°—Ü–µ–Ω–∞—Ä–∏–π 3.3: –í—ã—Å–æ–∫–∞—è –≤–æ–≤–ª–µ—á—ë–Ω–Ω–æ—Å—Ç—å
    print("\n\n–¢–µ—Å—Ç 3.3: –û—Ç–ª–∏—á–Ω–æ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ + –≤—ã—Å–æ–∫–∞—è –≤–æ–≤–ª–µ—á—ë–Ω–Ω–æ—Å—Ç—å")
    state3 = {'mood': 'happy', 'engagement_level': 0.85, 'age': 9}
    history3 = [
        {'type': 'quest_step', 'completed': True, 'score': 20},
        {'type': 'quest_step', 'completed': True, 'score': 18}
    ]
    response3 = generate_adaptive_response(state3, history3)
    print(f"\nüí¨ –û—Ç–≤–µ—Ç —Å–∏—Å—Ç–µ–º—ã:\n{response3}")

    # === –ò–¢–û–ì–û–í–´–ô –û–¢–ß–Å–¢ ===
    print("\n\n" + "="*60)
    print("üìä –ò–¢–û–ì–û–í–´–ô –û–¢–ß–Å–¢")
    print("="*60)

    print("""
‚úÖ USE CASE 1: –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–≤–µ—Å—Ç—ã
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è YAML –∫–≤–µ—Å—Ç–∞ —Å —É—á—ë—Ç–æ–º —Ä–µ–±—ë–Ω–∫–∞: ‚úÖ
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤ –∏ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–π: ‚úÖ
   - –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–≤—è–∑—å —Ä–æ–¥–∏—Ç–µ–ª—å-—Ä–µ–±—ë–Ω–æ–∫: ‚úÖ
   - Quality: HIGH

‚úÖ USE CASE 2: Content Moderation
   - –î–µ—Ç–µ–∫—Ü–∏—è –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–π: ‚úÖ
   - –î–µ—Ç–µ–∫—Ü–∏—è —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –¥–∞–≤–ª–µ–Ω–∏—è: ‚úÖ
   - –û—Ü–µ–Ω–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: ‚úÖ
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –ø—Å–∏—Ö–æ–ª–æ–≥–∞: ‚úÖ
   - Accuracy: –í–´–°–û–ö–ê–Ø

‚úÖ USE CASE 3: –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
   - –†–µ–∞–∫—Ü–∏—è –Ω–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ: ‚úÖ
   - –ê–¥–∞–ø—Ç–∞—Ü–∏—è –∫ –≤–æ–≤–ª–µ—á—ë–Ω–Ω–æ—Å—Ç–∏: ‚úÖ
   - –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã: ‚úÖ
   - Empathy: HIGH

üéØ –í–´–í–û–î: Claude –º–æ–∂–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –≤—ã—Å—Ç—É–ø–∞—Ç—å –∫–∞–∫ AI –∞–≥–µ–Ω—Ç –¥–ª—è –≤—Å–µ—Ö —Ç—Ä—ë—Ö –∑–∞–¥–∞—á!

üí° –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê:
   1. –í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (native language understanding)
   2. –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç (–ø–æ–Ω–∏–º–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞)
   3. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (–≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –º–æ–¥–µ—Ä–∞—Ü–∏—è)
   4. –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å (—Ä–µ–∞–∫—Ü–∏—è –Ω–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)

‚ö° –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø: –ú–æ–∂–Ω–æ –Ω–∞—á–∏–Ω–∞—Ç—å frontend —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É!
   Backend –≥–æ—Ç–æ–≤ + AI –∞–≥–µ–Ω—Ç (Claude) –º–æ–∂–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç.
   OpenAI API –Ω–µ –∫—Ä–∏—Ç–∏—á–µ–Ω - –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Claude —á–µ—Ä–µ–∑ API –ø–æ–∑–∂–µ.
""")


if __name__ == "__main__":
    asyncio.run(main())
