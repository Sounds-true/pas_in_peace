"""Knowledge base documents for PA bot."""

from typing import List
from src.rag.retriever import Document


class PAKnowledgeBase:
    """
    Parental Alienation Knowledge Base.

    Contains curated information about PA, therapeutic techniques,
    resources, and legal boundaries.
    """

    @staticmethod
    def get_all_documents() -> List[Document]:
        """Get all knowledge base documents."""
        documents = []

        # PA Overview & Facts
        documents.extend(PAKnowledgeBase._get_pa_overview())

        # Therapeutic Techniques
        documents.extend(PAKnowledgeBase._get_therapeutic_techniques())

        # Coping Strategies
        documents.extend(PAKnowledgeBase._get_coping_strategies())

        # Legal & Boundaries
        documents.extend(PAKnowledgeBase._get_legal_info())

        # Resources & Support
        documents.extend(PAKnowledgeBase._get_resources())

        # Child Development
        documents.extend(PAKnowledgeBase._get_child_development())

        return documents

    @staticmethod
    def _get_pa_overview() -> List[Document]:
        """PA overview and facts."""
        return [
            Document(
                content="""
                Родительское отчуждение (Parental Alienation) - это процесс, при котором один родитель
                (отчуждающий) систематически подрывает отношения ребёнка с другим родителем (отчуждаемым).

                Признаки отчуждения:
                - Ребёнок необоснованно отвергает одного из родителей
                - Критика направлена только на одного родителя, другой идеализируется
                - Ребёнок использует взрослые формулировки для объяснения отказа
                - Отсутствие амбивалентности (все хорошо/все плохо)
                - Ребёнок утверждает, что решение отказаться от контакта - его собственное
                - Отказ распространяется на расширенную семью отчуждаемого родителя

                Это не: обычные конфликты, временная злость после развода, обоснованное отдаление
                при реальном насилии или пренебрежении.
                """,
                metadata={
                    "category": "pa_overview",
                    "topic": "definition_and_signs",
                    "lang": "ru"
                }
            ),
            Document(
                content="""
                Влияние отчуждения на детей:

                Краткосрочные эффекты:
                - Тревожность и стресс
                - Конфликт лояльности
                - Искажённое восприятие реальности
                - Трудности с доверием

                Долгосрочные последствия:
                - Проблемы в построении здоровых отношений во взрослом возрасте
                - Сложности с эмоциональной регуляцией
                - Риск повторения паттерна отчуждения
                - Чувство вины и потери при осознании манипуляции

                Исследования показывают, что воссоединение возможно, особенно если отчуждаемый родитель:
                - Сохраняет попытки контакта (без навязчивости)
                - Остаётся эмоционально стабильным
                - Не участвует в конфликте родителей
                - Готов к воссоединению когда ребёнок будет готов
                """,
                metadata={
                    "category": "pa_overview",
                    "topic": "effects_on_children",
                    "lang": "ru"
                }
            ),
            Document(
                content="""
                Стадии родительского отчуждения:

                1. Начальная стадия (Mild):
                   - Ребёнок колеблется, но поддерживает контакт
                   - Критика есть, но не постоянная
                   - Можно скорректировать коммуникацией

                2. Умеренная стадия (Moderate):
                   - Ребёнок отказывается от некоторых контактов
                   - Явная негативная кампания
                   - Требуется профессиональная помощь

                3. Тяжёлая стадия (Severe):
                   - Полный отказ от контакта
                   - Крайняя враждебность
                   - Может требоваться судебное вмешательство

                Чем раньше начать работу, тем лучше прогноз.
                """,
                metadata={
                    "category": "pa_overview",
                    "topic": "stages",
                    "lang": "ru"
                }
            ),
        ]

    @staticmethod
    def _get_therapeutic_techniques() -> List[Document]:
        """Therapeutic techniques documentation."""
        return [
            Document(
                content="""
                Когнитивно-поведенческая терапия (CBT) для отчужденных родителей:

                CBT помогает:
                - Идентифицировать и оспорить негативные автоматические мысли
                - Изменить катастрофическое мышление
                - Разработать более адаптивные копинг-стратегии

                Техники:
                1. Когнитивное переосмысление (cognitive reframing)
                   - Заменить "никогда не увижу" на "сейчас контакт ограничен, но я работаю над воссоединением"

                2. Децентрализация
                   - Понять, что отчуждение - не результат плохого родительства
                   - Признать роль других факторов

                3. Поведенческая активация
                   - Продолжать попытки контакта (в разумных пределах)
                   - Заниматься самопомощью
                   - Поддерживать социальные связи
                """,
                metadata={
                    "category": "techniques",
                    "topic": "cbt",
                    "lang": "ru"
                }
            ),
            Document(
                content="""
                Техники заземления (Grounding) для острого дистресса:

                Когда использовать: при панических атаках, overwhelming эмоциях, диссоциации.

                Техника 5-4-3-2-1:
                - 5 вещей, которые вы ВИДИТЕ
                - 4 вещи, которые можете ПОТРОГАТЬ
                - 3 вещи, которые СЛЫШИТЕ
                - 2 вещи, которые можете ПОНЮХАТЬ
                - 1 вещь, которую можете ПОПРОБОВАТЬ

                Дыхательные упражнения:
                - Диафрагмальное дыхание (4-7-8)
                - Box breathing (4-4-4-4)

                Физические техники:
                - Progressive muscle relaxation
                - Cold water на лицо
                - Физическая активность

                Эти техники возвращают вас в настоящий момент и снижают физиологическое возбуждение.
                """,
                metadata={
                    "category": "techniques",
                    "topic": "grounding",
                    "lang": "ru"
                }
            ),
            Document(
                content="""
                Эмоциональная валидация - ключевой элемент поддержки:

                Что такое валидация:
                - Признание и принятие эмоций человека
                - Сообщение: "Ваши чувства понятны и обоснованы"
                - Не путать с согласием или одобрением действий

                Компоненты валидации:
                1. Присутствие - быть полностью вовлечённым
                2. Точное отражение - понять эмоцию правильно
                3. Нормализация - "это нормальная реакция"
                4. Эмпатия - показать понимание

                Фразы валидации:
                - "Это должно быть невероятно тяжело"
                - "Ваши чувства совершенно понятны"
                - "Любой в вашей ситуации чувствовал бы то же самое"
                - "Вы имеете право на эти эмоции"

                Валидация особенно важна для отчуждённых родителей, чьи переживания часто минимизируются.
                """,
                metadata={
                    "category": "techniques",
                    "topic": "validation",
                    "lang": "ru"
                }
            ),
        ]

    @staticmethod
    def _get_coping_strategies() -> List[Document]:
        """Coping strategies for alienated parents."""
        return [
            Document(
                content="""
                Стратегии самопомощи для отчуждённых родителей:

                1. Поддерживайте регулярные попытки контакта:
                   - Регулярные, но не навязчивые сообщения
                   - Открытки на праздники и дни рождения
                   - Документируйте все попытки (для суда если нужно)

                2. Берегите себя:
                   - Физическое здоровье (сон, питание, упражнения)
                   - Эмоциональная поддержка (терапия, группы поддержки)
                   - Социальные связи
                   - Хобби и интересы

                3. Не участвуйте в конфликте:
                   - Не говорите плохо о другом родителе
                   - Не используйте ребёнка как посредника
                   - Не просите ребёнка выбирать

                4. Готовьтесь к воссоединению:
                   - Работайте над собой
                   - Учитесь навыкам коммуникации
                   - Планируйте как будете восстанавливать отношения

                5. Сохраняйте надежду, но живите настоящим:
                   - Воссоединение возможно
                   - Но ваша жизнь важна сейчас
                """,
                metadata={
                    "category": "coping",
                    "topic": "self_care",
                    "lang": "ru"
                }
            ),
            Document(
                content="""
                Работа с конфликтом лояльности у ребёнка:

                Что такое конфликт лояльности:
                - Ребёнок чувствует, что должен выбрать между родителями
                - Любовь к одному = предательство другого
                - Это травмирует ребёнка

                Как помочь:
                1. Дайте разрешение любить обоих родителей:
                   "Ты можешь любить и маму, и папу. Это нормально и правильно."

                2. Не ставьте ребёнка в позицию выбора:
                   Не спрашивайте "кого ты любишь больше"
                   Не соревнуйтесь за внимание

                3. Не используйте ребёнка для получения информации о другом родителе

                4. Показывайте безусловную любовь:
                   "Я люблю тебя независимо ни от чего"

                5. Если ребёнок отвергает вас:
                   "Я понимаю, что тебе сейчас сложно. Я буду здесь, когда ты будешь готов."
                """,
                metadata={
                    "category": "coping",
                    "topic": "loyalty_conflict",
                    "lang": "ru"
                }
            ),
        ]

    @staticmethod
    def _get_legal_info() -> List[Document]:
        """Legal information and boundaries."""
        return [
            Document(
                content="""
                Юридические границы для бота и пользователей:

                ЧТО БОТ НЕ ДЕЛАЕТ:
                - НЕ даёт юридических советов
                - НЕ рекомендует конкретных адвокатов
                - НЕ интерпретирует законы или судебные решения
                - НЕ советует нарушать судебные предписания

                ЧТО БОТ МОЖЕТ:
                - Рекомендовать обратиться к адвокату по семейному праву
                - Предложить общую информацию о процессах
                - Поддержать эмоционально во время юридических процедур

                Важно:
                - Всегда соблюдайте судебные предписания
                - Документируйте все взаимодействия
                - Обращайтесь к квалифицированному семейному адвокату
                - Не используйте ребёнка как свидетеля против другого родителя

                Если вы получили юридический вопрос, ответ:
                "Я не могу давать юридические советы. Пожалуйста, обратитесь к семейному адвокату
                в вашей юрисдикции. Я могу поддержать вас эмоционально в этом процессе."
                """,
                metadata={
                    "category": "legal",
                    "topic": "boundaries",
                    "lang": "ru"
                }
            ),
            Document(
                content="""
                Документирование для юридических целей:

                Что документировать:
                1. Все попытки контакта с ребёнком:
                   - Дата и время
                   - Способ (звонок, SMS, письмо)
                   - Результат (ответил/не ответил/что сказал)

                2. Все взаимодействия с другим родителем:
                   - Сохраняйте переписку
                   - Записывайте телефонные разговоры (где законно)
                   - Нейтральный, фактический тон

                3. Финансовые записи:
                   - Алименты
                   - Расходы на ребёнка
                   - Подарки

                4. Свидетели:
                   - Кто присутствовал при взаимодействиях
                   - Контактная информация

                Как документировать:
                - Хронологический порядок
                - Факты, не эмоции
                - Конкретные примеры, не обобщения
                - Храните в безопасном месте (backup!)

                Документация может быть критична в суде.
                """,
                metadata={
                    "category": "legal",
                    "topic": "documentation",
                    "lang": "ru"
                }
            ),
        ]

    @staticmethod
    def _get_resources() -> List[Document]:
        """Support resources and hotlines."""
        return [
            Document(
                content="""
                Ресурсы поддержки для отчуждённых родителей:

                ЭКСТРЕННАЯ ПОМОЩЬ:
                - Телефон доверия: 8-800-2000-122 (круглосуточно, бесплатно)
                - Психологическая помощь: 051 (с мобильного)
                - Скорая помощь: 103
                - Единая служба экстренной помощи: 112

                ОНЛАЙН-РЕСУРСЫ:
                - Фонд "Семья и детство" - поддержка семей
                - Ассоциация родительских комитетов - юридическая помощь
                - Форумы и группы поддержки родителей

                ПРОФЕССИОНАЛЬНАЯ ПОМОЩЬ:
                - Семейный психолог/психотерапевт
                - Медиатор по семейным конфликтам
                - Адвокат по семейному праву
                - Группы поддержки для разведённых родителей

                КНИГИ И МАТЕРИАЛЫ:
                - "Развод и дети" - Юлия Гиппенрейтер
                - "Эмоциональный интеллект ребёнка" - Джон Готтман
                - Материалы о parental alienation (на английском)

                Помните: обращение за помощью - признак силы, не слабости.
                """,
                metadata={
                    "category": "resources",
                    "topic": "support_services",
                    "lang": "ru"
                }
            ),
        ]

    @staticmethod
    def _get_child_development() -> List[Document]:
        """Child development and PA context."""
        return [
            Document(
                content="""
                Понимание поведения ребёнка в контексте отчуждения:

                Возрастные особенности:

                Дошкольники (3-6 лет):
                - Легко поддаются влиянию
                - Конкретное мышление
                - Могут повторять слова взрослых
                - Короткая память о событиях

                Младшие школьники (7-10 лет):
                - Развивается чёрно-белое мышление
                - Сильное желание угодить значимым взрослым
                - Начинают формироваться собственные мнения
                - Могут чувствовать вину за конфликт родителей

                Подростки (11-17 лет):
                - Стремление к автономии
                - Могут активно отстаивать "свою" позицию
                - Влияние сверстников возрастает
                - Способны к критическому мышлению (но могут не использовать)

                Важно понимать:
                - Поведение ребёнка не всегда отражает его истинные чувства
                - Дети могут "играть роль" чтобы избежать конфликта
                - Отвержение может быть защитным механизмом
                - Привязанность к родителю остаётся, даже если подавлена
                """,
                metadata={
                    "category": "child_development",
                    "topic": "age_specific_behavior",
                    "lang": "ru"
                }
            ),
        ]
